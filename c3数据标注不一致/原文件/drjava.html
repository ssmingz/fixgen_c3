<!DOCTYPE html>
<style type='text/css'>
prompt {font-size:18px;font-weight: bold;color:purple;background-color:yellow}
desc {font-size:24px;font-weight: bold;color:white;background-color:red}diff_header {color:blue;}
diff_remove {color:red;}
diff_add {color:green;}
same {color:black;}
</style>
<html><body style='background-color:white;font-family: monospace'>
<desc>============================加日志或输出============================</desc></br><prompt>drjava-ID-6  加日志或输出 (1/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -11,4 +11,5 @@</xmp></diff_header><same><xmp>         fail("Open was unexpectedly canceled!");</xmp></same><same><xmp>     }</xmp></same><same><xmp>     assertEquals("non-existant file", doc, null);</xmp></same><diff_add><xmp>+    _log.log("testOpenNonexistentFile completed");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -37,4 +37,5 @@</xmp></diff_header><same><xmp>     assertTrue("one file was opened", (docs != null) && (docs.length == 1));</xmp></same><same><xmp>     listener.assertOpenCount(1);</xmp></same><same><xmp>     listener.assertFileNotFoundCount(1);</xmp></same><diff_add><xmp>+    _log.log("testOpenMultipleNonexistentFiles completed");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -43,4 +43,5 @@</xmp></diff_header><same><xmp>     assertEquals("size of document array", 2, docs.size());</xmp></same><same><xmp>     assertContents(FOO_TEXT, docs.get(0));</xmp></same><same><xmp>     assertContents(BAR_TEXT, docs.get(1));</xmp></same><diff_add><xmp>+    _log.log("testOpenMultipleFiles completed");</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-122  加日志或输出 (2/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,6 +3,7 @@</xmp></diff_header><same><xmp>     Iterator<OpenDefinitionsDocument> odds = _documentsRepos.valuesIterator();</xmp></same><same><xmp>     while (odds.hasNext() && keepClosing) {</xmp></same><same><xmp>         OpenDefinitionsDocument next = odds.next();</xmp></same><diff_add><xmp>+        System.out.println("closing " + next);</xmp></diff_add><same><xmp>         keepClosing = closeFile(next);</xmp></same><same><xmp>         odds = _documentsRepos.valuesIterator();</xmp></same><same><xmp>     } </xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,5 @@</xmp></diff_header><same><xmp> public void handleEvent(Event e) {</xmp></same><diff_add><xmp>+    System.out.println("handleEvent: " + e);</xmp></diff_add><same><xmp>     if (e instanceof BreakpointEvent) {</xmp></same><same><xmp>         _handleBreakpointEvent(((BreakpointEvent) (e)));</xmp></same><same><xmp>     } else if (e instanceof VMDeathEvent) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -68,6 +68,7 @@</xmp></diff_header><same><xmp>                     }</xmp></same><same><xmp>                 }</xmp></same><same><xmp>             } else {</xmp></same><diff_add><xmp>+                System.out.println("hi");</xmp></diff_add><same><xmp>                 setErrorStrings(node, ts.typePrinter().print(classType), memberName.image());</xmp></same><same><xmp>                 throw new ExecutionError("no.such.member", node);</xmp></same><same><xmp>             }</xmp></same><prompt>drjava-ID-182  加日志或输出 (3/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -37,4 +37,5 @@</xmp></diff_header><same><xmp>     listener.assertShouldRevertFileCount(1);</xmp></same><same><xmp>     listener.assertFileRevertedCount(1);</xmp></same><same><xmp>     assertContents(s, doc);</xmp></same><diff_add><xmp>+    _log.log("testModifiedByOther completed");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -28,4 +28,5 @@</xmp></diff_header><same><xmp>     assertModified(false, doc);</xmp></same><same><xmp>     assertContents(BAR_TEXT, doc);</xmp></same><same><xmp>     assertEquals("contents of saved file", BAR_TEXT, FileOps.readFileAsString(file));</xmp></same><diff_add><xmp>+    _log.log("testCancelSaveAlreadySaved completed");</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-194  加日志或输出 (4/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,5 @@</xmp></diff_header><same><xmp> public INavigatorItem removeDocument(INavigatorItem doc) throws IllegalArgumentException {</xmp></same><diff_add><xmp>+    System.err.println("removing from old list " + doc);</xmp></diff_add><same><xmp>     int i = _docs.indexOf(doc);</xmp></same><same><xmp>     if (i == (-1)) {</xmp></same><same><xmp>         throw new IllegalArgumentException(("Document " + doc) + " not found in Document Navigator");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,6 @@</xmp></diff_header><same><xmp> public SymbolData getNextAnonymousInnerClass() {</xmp></same><same><xmp>     String name = (getSymbolData().getName() + "$") + getSymbolData().preincrementAnonymousInnerClassNum();</xmp></same><diff_add><xmp>+    System.err.println("**** Looking up anonymous inner class " + name);</xmp></diff_add><same><xmp>     LinkedList<SymbolData> myDatas = getInnerClasses();</xmp></same><same><xmp>     SymbolData myData = null;</xmp></same><same><xmp>     for (int i = 0; i < myDatas.size(); i++) {</xmp></same><prompt>drjava-ID-230  加日志或输出 (5/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,7 @@</xmp></diff_header><same><xmp> public void testThrowNPE() throws Throwable {</xmp></same><diff_add><xmp>+    if (printMessages) {</xmp></diff_add><diff_add><xmp>+        System.out.println("----testThrowNPE-----");</xmp></diff_add><diff_add><xmp>+    }</xmp></diff_add><same><xmp>     synchronized(_jvm) {</xmp></same><same><xmp>         _jvm.interpret("throw new NullPointerException();");</xmp></same><same><xmp>         while (NewJVMTest._jvm.exceptionClassBuf == null) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,7 @@</xmp></diff_header><same><xmp> public void testNoClassFile() throws Exception {</xmp></same><diff_add><xmp>+    if (printMessages) {</xmp></diff_add><diff_add><xmp>+        System.out.println("----testNoClassFile-----");</xmp></diff_add><diff_add><xmp>+    }</xmp></diff_add><same><xmp>     final OpenDefinitionsDocument doc = setupDocument(MONKEYTEST_PASS_TEXT);</xmp></same><same><xmp>     final File file = new File(_tempDir, "MonkeyTestPass.java");</xmp></same><same><xmp>     doc.saveFile(new FileSelector(file));</xmp></same><desc>============================具体内容变变量============================</desc></br><prompt>drjava-ID-9  具体内容变变量 (1/3) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,5 +8,5 @@</xmp></diff_header><same><xmp>     errors = new LinkedList<Pair<String, JExpressionIF>>();</xmp></same><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     _cbbtc = new VoidMethodsNotAllowedClassBodyTypeChecker(_sd1, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>(), "Intermediate");</xmp></same><diff_remove><xmp>-    _cbbtc._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _cbbtc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     errors = new LinkedList<Pair<String, JExpressionIF>>();</xmp></same><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     _b = new Bob(null, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _b._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _b._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _b._importedPackages.addFirst("java.lang");</xmp></same><same><xmp>     _sd1 = new SymbolData("i.like.monkey");</xmp></same><same><xmp>     _sd2 = new SymbolData("i.like.giraffe");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -22,7 +22,7 @@</xmp></diff_header><same><xmp>     vd.setEnclosingData(md0);</xmp></same><same><xmp>     md0.addVar(vd);</xmp></same><same><xmp>     _cbbtc = new ClassBodyTypeChecker(_sd1, _cbbtc._file, _cbbtc._package, _cbbtc._importedFiles, _cbbtc._importedPackages, new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _cbbtc._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _cbbtc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     cmd0.visit(_cbbtc);</xmp></same><same><xmp>     assertEquals("There should be 1 error", 1, errors.size());</xmp></same><same><xmp>     assertEquals("The error message should be correct", "You cannot use i because it may not have been given a value", errors.get(0).getFirst());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     errors = new LinkedList<Pair<String, JExpressionIF>>();</xmp></same><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     _etc = new ExpressionTypeChecker(null, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _etc._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _etc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _etc._importedPackages.addFirst("java.lang");</xmp></same><same><xmp>     _sd1 = new SymbolData("i.like.monkey");</xmp></same><same><xmp>     _sd2 = new SymbolData("i.like.giraffe");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     errors = new LinkedList<Pair<String, JExpressionIF>>();</xmp></same><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     _cbbtc = new ClassBodyTypeChecker(_sd1, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _cbbtc._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _cbbtc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _cbbtc._importedPackages.addFirst("java.lang");</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -16,6 +16,6 @@</xmp></diff_header><same><xmp>     _bd1.addVars(((MethodData) (_bd1)).getParams());</xmp></same><same><xmp>     _bd2.addVars(((MethodData) (_bd2)).getParams());</xmp></same><same><xmp>     _bbtc = new BodyTypeChecker(_bd1, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _bbtc._targetVersion = "1.5";</xmp></diff_remove><diff_add><xmp>+    _bbtc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _bbtc._importedPackages.addFirst("java.lang");</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-267  具体内容变变量 (2/3) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     LanguageLevelVisitor.symbolTable = symbolTable;</xmp></same><same><xmp>     _btc = new TypeChecker(new File(""), "", new LinkedList<String>(), new LinkedList<String>());</xmp></same><diff_remove><xmp>-    _btc._targetVersion = "version 1.5";</xmp></diff_remove><diff_add><xmp>+    _btc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _btc._importedPackages.addFirst("java.lang");</xmp></same><same><xmp>     _errorAdded = false;</xmp></same><same><xmp>     _sd1 = new SymbolData("i.like.monkey");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     errors = new LinkedList<Pair<String, JExpressionIF>>();</xmp></same><same><xmp>     symbolTable = new Symboltable();</xmp></same><same><xmp>     _ibbtc = new InterfaceBodyTypeChecker(_sd1, new File(""), "", new LinkedList<String>(), new LinkedList<String>(), new LinkedList<VariableData>(), new LinkedList<Pair<SymbolData, JExpression>>());</xmp></same><diff_remove><xmp>-    _ibbtc._targetVersion = "version 1.5";</xmp></diff_remove><diff_add><xmp>+    _ibbtc._targetVersion = JavaVersion.JAVA_5;</xmp></diff_add><same><xmp>     _ibbtc._importedPackages.addFirst("java.lang");</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-223  具体内容变变量 (3/3) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><diff_remove><xmp>-private int _updateInsideLineComment(ModelList<ReducedToken>.Iterator copyCursor) {</xmp></diff_remove><diff_add><xmp>+private ReducedModelState _updateInsideLineComment(ModelList<ReducedToken>.Iterator copyCursor) {</xmp></diff_add><same><xmp>     if (copyCursor.atEnd()) {</xmp></same><diff_remove><xmp>-        return -1;</xmp></diff_remove><diff_add><xmp>+        return STUTTER;</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><diff_remove><xmp>-private int _updateInsideDoubleQuote(ModelList<ReducedToken>.Iterator copyCursor) {</xmp></diff_remove><diff_add><xmp>+private ReducedModelState _updateInsideDoubleQuote(ModelList<ReducedToken>.Iterator copyCursor) {</xmp></diff_add><same><xmp>     if (copyCursor.atEnd()) {</xmp></same><diff_remove><xmp>-        return -1;</xmp></diff_remove><diff_add><xmp>+        return STUTTER;</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><desc>============================参数个数变化============================</desc></br><prompt>drjava-ID-10  参数个数变化 (1/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public CharacterLiteral(String rep) {</xmp></same><diff_remove><xmp>-    this(rep, null, 0, 0, 0, 0);</xmp></diff_remove><diff_add><xmp>+    this(rep, NONE);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public ForEachStatement(FormalParameter para, Expression collection, Node body) {</xmp></same><diff_remove><xmp>-    this(para, collection, body, null, 0, 0, 0, 0);</xmp></diff_remove><diff_add><xmp>+    this(para, collection, body, NONE);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public ImportDeclaration(List<IdentifierToken> ident, boolean pkg, boolean sttc) {</xmp></same><diff_remove><xmp>-    this(ident, pkg, sttc, null, 0, 0, 0, 0);</xmp></diff_remove><diff_add><xmp>+    this(ident, pkg, sttc, NONE);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-12  参数个数变化 (2/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public Iterable<File> getSearchFiles() {</xmp></same><diff_remove><xmp>-    Iterable<File> files = IterUtil.asIterable(new File[]{ new File("/home/mgricken/JavaMint2/langtools/dist/lib/classes.jar"), new File("/home/mgricken/research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar"), new File("/Users/mgricken/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar"), new File("/D:/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar") });</xmp></diff_remove><diff_add><xmp>+    Iterable<File> files = IterUtil.asIterable(new File[]{ new File("/home/mgricken/JavaMint2/langtools/dist/lib/classes.jar"), new File("/C:/Program Files/JavaMint2/langtools/dist/lib/classes.jar"), new File("/home/mgricken/research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar"), new File("/Users/mgricken/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar"), new File("/D:/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar") });</xmp></diff_add><same><xmp>     return files;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public Iterable<File> getSearchFiles() {</xmp></same><diff_remove><xmp>-    Iterable<File> files = IterUtil.asIterable(new File[]{ new File("/Users/mgricken/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar") });</xmp></diff_remove><diff_add><xmp>+    Iterable<File> files = IterUtil.asIterable(new File[]{ new File("/Users/mgricken/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar"), new File("/D:/Documents/Research/Mint/java-mint/trunk/langtools/dist/lib/classes.jar") });</xmp></diff_add><same><xmp>     return files;</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-36  参数个数变化 (3/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public GenericClassDeclaration(int flags, String name, ReferenceTypeName ext, List<? extends ReferenceTypeName> impl, List<Node> body, TypeParameter[] typeParams) {</xmp></same><diff_remove><xmp>-    this(flags, name, ext, impl, body, null, 0, 0, 0, 0, typeParams);</xmp></diff_remove><diff_add><xmp>+    this(flags, name, ext, impl, body, typeParams, NONE);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public GenericInterfaceDeclaration(int flags, String name, List<? extends ReferenceTypeName> impl, List<Node> body, TypeParameter[] typeParams) {</xmp></same><diff_remove><xmp>-    this(flags, name, impl, body, null, 0, 0, 0, 0, typeParams);</xmp></diff_remove><diff_add><xmp>+    this(flags, name, impl, body, typeParams, NONE);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-177  参数个数变化 (4/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -22,14 +22,17 @@</xmp></diff_header><same><xmp>     assertEquals("6.0_11", vApple.versionString());</xmp></same><same><xmp>     FullVersion vSun = parseFullVersion("1.6.0_11", "Java(TM) 2 Runtime Environment, Standard Edition", "Sun Microsystems Inc.");</xmp></same><same><xmp>     assertEquals("6.0_11", vSun.versionString());</xmp></same><diff_add><xmp>+    FullVersion vOracle = parseFullVersion("1.7.0", "Java(TM) SE Runtime Environment", "Oracle Corporation");</xmp></diff_add><diff_add><xmp>+    assertEquals("7.0", vOracle.versionString());</xmp></diff_add><same><xmp>     Set<FullVersion> sorter = new TreeSet<FullVersion>();</xmp></same><same><xmp>     sorter.add(vSun);</xmp></same><diff_add><xmp>+    sorter.add(vOracle);</xmp></diff_add><same><xmp>     sorter.add(vApple);</xmp></same><same><xmp>     sorter.add(vOpenJDK);</xmp></same><same><xmp>     sorter.add(vUnrecognized);</xmp></same><same><xmp>     sorter.add(vMint);</xmp></same><same><xmp>     sorter.add(vHJ);</xmp></same><same><xmp>     sorter.add(vNextGen);</xmp></same><diff_remove><xmp>-    Iterable<FullVersion> expected = IterUtil.make(vUnrecognized, vHJ, vMint, vNextGen, vOpenJDK, vApple, vSun);</xmp></diff_remove><diff_add><xmp>+    Iterable<FullVersion> expected = IterUtil.make(vUnrecognized, vHJ, vMint, vNextGen, vOpenJDK, vApple, vSun, vOracle);</xmp></diff_add><same><xmp>     assertTrue(IterUtil.isEqual(sorter, expected));</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -10,12 +10,15 @@</xmp></diff_header><same><xmp>     assertEquals("6.0_11", vApple.versionString());</xmp></same><same><xmp>     FullVersion vSun = parseFullVersion("1.6.0_11", "Java(TM) 2 Runtime Environment, Standard Edition", "Sun Microsystems Inc.");</xmp></same><same><xmp>     assertEquals("6.0_11", vSun.versionString());</xmp></same><diff_add><xmp>+    FullVersion vOracle = parseFullVersion("1.7.0", "Java(TM) SE Runtime Environment", "Oracle Corporation");</xmp></diff_add><diff_add><xmp>+    assertEquals("7.0", vOracle.versionString());</xmp></diff_add><same><xmp>     Set<FullVersion> sorter = new TreeSet<FullVersion>();</xmp></same><same><xmp>     sorter.add(vSun);</xmp></same><diff_add><xmp>+    sorter.add(vOracle);</xmp></diff_add><same><xmp>     sorter.add(vApple);</xmp></same><same><xmp>     sorter.add(vOpenJDK);</xmp></same><same><xmp>     sorter.add(vUnrecognized);</xmp></same><same><xmp>     sorter.add(vMint);</xmp></same><diff_remove><xmp>-    Iterable<FullVersion> expected = IterUtil.make(vUnrecognized, vOpenJDK, vApple, vSun, vMint);</xmp></diff_remove><diff_add><xmp>+    Iterable<FullVersion> expected = IterUtil.make(vUnrecognized, vOpenJDK, vApple, vSun, vOracle, vMint);</xmp></diff_add><same><xmp>     assertTrue(IterUtil.isEqual(sorter, expected));</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-261  参数个数变化 (5/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -27,7 +27,7 @@</xmp></diff_header><same><xmp>     } else {</xmp></same><same><xmp>         interpreter.registerConstructorArguments(sig, new LinkedList<FormalParameter>(), new LinkedList<Expression>(), importationManager);</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    MethodDeclaration md = new MethodDeclaration(cd.getAccessFlags(), new VoidType(), "<init>", cd.getParameters(), new LinkedList<ReferenceType>(), new BlockStatement(cd.getStatements()));</xmp></diff_remove><diff_add><xmp>+    MethodDeclaration md = new MethodDeclaration(cd.getAccessFlags(), new VoidType(), "<init>", cd.getParameters(), new LinkedList<ReferenceType>(), new BlockStatement(cd.getStatements()), false);</xmp></diff_add><same><xmp>     interpreter.registerMethod(sig, md, importationManager);</xmp></same><same><xmp>     if (!cv.superConstructor.equals(classInfo.getName())) {</xmp></same><same><xmp>         ListIterator<Node> lit = cd.getStatements().listIterator();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -38,7 +38,7 @@</xmp></diff_header><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (classInitializer.size() > 0) {</xmp></same><diff_remove><xmp>-        interpreter.registerMethod(classFactory.createClassInitializer(), new MethodDeclaration(Modifier.PUBLIC, new VoidType(), "<clinit>", new LinkedList<FormalParameter>(), new LinkedList<ReferenceType>(), new BlockStatement(classInitializer)), importationManager);</xmp></diff_remove><diff_add><xmp>+        interpreter.registerMethod(classFactory.createClassInitializer(), new MethodDeclaration(Modifier.PUBLIC, new VoidType(), "<clinit>", new LinkedList<FormalParameter>(), new LinkedList<ReferenceType>(), new BlockStatement(classInitializer), false), importationManager);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     TreeClassLoader classLoader = ((TreeClassLoader) (interpreter.getClassLoader()));</xmp></same><same><xmp>     return classLoader.defineClass(name, classFactory.getByteCode());</xmp></same><desc>============================改变量名============================</desc></br><prompt>drjava-ID-21  改变量名 (1/4) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,6 +2,6 @@</xmp></diff_header><same><xmp>     BraceReduction _reduced = doc.getReduced();</xmp></same><same><xmp>     doc.insertString(0, "(\n /*\n*\n", null);</xmp></same><same><xmp>     _reduced.move(-1);</xmp></same><diff_remove><xmp>-    IndentInfo ii = _reduced.getIndentInformation();</xmp></diff_remove><diff_remove><xmp>-    _assertIndentInfo(ii, openParen, -1, 7, 1);</xmp></diff_remove><diff_add><xmp>+    IndentInfo info = _reduced.getIndentInformation();</xmp></diff_add><diff_add><xmp>+    _assertIndentInfo(info, OPEN_PAREN, -1, 7, 1);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,6 +2,6 @@</xmp></diff_header><same><xmp>     BraceReduction _reduced = doc.getReduced();</xmp></same><same><xmp>     doc.insertString(0, "\n(\n /*\n*\n", null);</xmp></same><same><xmp>     _reduced.move(-1);</xmp></same><diff_remove><xmp>-    IndentInfo ii = _reduced.getIndentInformation();</xmp></diff_remove><diff_remove><xmp>-    _assertIndentInfo(ii, openParen, 7, 7, 1);</xmp></diff_remove><diff_add><xmp>+    IndentInfo info = _reduced.getIndentInformation();</xmp></diff_add><diff_add><xmp>+    _assertIndentInfo(info, OPEN_PAREN, 7, 7, 1);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-210  改变量名 (2/4) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public FileSelector(File f1, File f2) {</xmp></same><diff_remove><xmp>-    _file = f1;</xmp></diff_remove><diff_add><xmp>+    _file1 = f1;</xmp></diff_add><same><xmp>     _file2 = f2;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public FileSelector(File f) {</xmp></same><diff_remove><xmp>-    _file = f;</xmp></diff_remove><diff_add><xmp>+    _file1 = f;</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-213  改变量名 (3/4) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,5 +3,5 @@</xmp></diff_header><same><xmp>     doc.insertString(0, "\n{\n  /*\n*\n", null);</xmp></same><same><xmp>     _reduced.move(-1);</xmp></same><same><xmp>     IndentInfo ii = _reduced.getIndentInformation();</xmp></same><diff_remove><xmp>-    _assertIndentInfo(ii, OPEN_SQUIGGLY, 8, 8, 1);</xmp></diff_remove><diff_add><xmp>+    _assertIndentInfo(ii, OPEN_CURLY, 8, 8, 1);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,5 +3,5 @@</xmp></diff_header><same><xmp>     doc.insertString(0, "{\n  /*\n*\n", null);</xmp></same><same><xmp>     _reduced.move(-1);</xmp></same><same><xmp>     IndentInfo ii = _reduced.getIndentInformation();</xmp></same><diff_remove><xmp>-    _assertIndentInfo(ii, OPEN_SQUIGGLY, -1, 8, 1);</xmp></diff_remove><diff_add><xmp>+    _assertIndentInfo(ii, OPEN_CURLY, -1, 8, 1);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-288  改变量名 (4/4) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public void systemErrPrint(String s) throws RemoteException {</xmp></same><diff_remove><xmp>-    _model.replSystemErrPrint(s);</xmp></diff_remove><diff_add><xmp>+    _interactionsModel.replSystemErrPrint(s);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public Object forVoidResult(VoidResult that) {</xmp></same><diff_remove><xmp>-    _model.replReturnedVoid();</xmp></diff_remove><diff_add><xmp>+    _interactionsModel.replReturnedVoid();</xmp></diff_add><same><xmp>     return null;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public void systemOutPrint(String s) throws RemoteException {</xmp></same><diff_remove><xmp>-    _model.replSystemOutPrint(s);</xmp></diff_remove><diff_add><xmp>+    _interactionsModel.replSystemOutPrint(s);</xmp></diff_add><same><xmp> }</xmp></same><desc>============================改方法名============================</desc></br><prompt>drjava-ID-46  改方法名 (1/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testInterpretJavaEscapedArgs() {</xmp></same><same><xmp>     _log.log("testInterpretJavaEscapedArgs started");</xmp></same><diff_remove><xmp>-    _assertJavaTransformation("java Foo \\j", "Foo.main(new String[]{\"j\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo \\\"", "Foo.main(new String[]{\"\\\"\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo \\\\", "Foo.main(new String[]{\"\\\\\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo a\\ b", "Foo.main(new String[]{\"a b\"});");</xmp></diff_remove><diff_add><xmp>+    _assertJavaTransformationTail("java Foo \\j", "Foo.main(new String[]{\"j\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo \\\"", "Foo.main(new String[]{\"\\\"\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo \\\\", "Foo.main(new String[]{\"\\\\\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo a\\ b", "Foo.main(new String[]{\"a b\"});");</xmp></diff_add><same><xmp>     _log.log("testInterpretJavaEscapedArgs ended");</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testInterpretJavaEscapedArgs() {</xmp></same><same><xmp>     _log.log("testInterpretJavaEscapedArgs started");</xmp></same><diff_remove><xmp>-    _assertMainTransformation("java Foo \\j", "Foo.main(new String[]{\"j\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo \\\"", "Foo.main(new String[]{\"\\\"\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo \\\\", "Foo.main(new String[]{\"\\\\\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo a\\ b", "Foo.main(new String[]{\"a b\"});");</xmp></diff_remove><diff_add><xmp>+    _assertJavaTransformation("java Foo \\j", "Foo.main(new String[]{\"j\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo \\\"", "Foo.main(new String[]{\"\\\"\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo \\\\", "Foo.main(new String[]{\"\\\\\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo a\\ b", "Foo.main(new String[]{\"a b\"});");</xmp></diff_add><same><xmp>     _log.log("testInterpretJavaEscapedArgs ended");</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-121  改方法名 (2/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void testInterpretJavaArguments() {</xmp></same><same><xmp>     _log.log("testInterpretJavaArguments started");</xmp></same><diff_remove><xmp>-    _assertJavaTransformation("java Foo a b c", "Foo.main(new String[]{\"a\",\"b\",\"c\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo \"a b c\"", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo \"a b\"c d", "Foo.main(new String[]{\"a bc\",\"d\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo c:\\\\file.txt", "Foo.main(new String[]{\"c:\\\\file.txt\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertJavaTransformation("java Foo /home/user/file", "Foo.main(new String[]{\"/home/user/file\"});");</xmp></diff_remove><diff_add><xmp>+    _assertJavaTransformationTail("java Foo a b c", "Foo.main(new String[]{\"a\",\"b\",\"c\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo \"a b c\"", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo \"a b\"c d", "Foo.main(new String[]{\"a bc\",\"d\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo c:\\\\file.txt", "Foo.main(new String[]{\"c:\\\\file.txt\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformationTail("java Foo /home/user/file", "Foo.main(new String[]{\"/home/user/file\"});");</xmp></diff_add><same><xmp>     _log.log("testInterpretJavaArguments ended");</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void testInterpretJavaArguments() {</xmp></same><same><xmp>     _log.log("testInterpretJavaArguments started");</xmp></same><diff_remove><xmp>-    _assertMainTransformation("java Foo a b c", "Foo.main(new String[]{\"a\",\"b\",\"c\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo \"a b c\"", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo \"a b\"c d", "Foo.main(new String[]{\"a bc\",\"d\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo c:\\\\file.txt", "Foo.main(new String[]{\"c:\\\\file.txt\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertMainTransformation("java Foo /home/user/file", "Foo.main(new String[]{\"/home/user/file\"});");</xmp></diff_remove><diff_add><xmp>+    _assertJavaTransformation("java Foo a b c", "Foo.main(new String[]{\"a\",\"b\",\"c\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo \"a b c\"", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo \"a b\"c d", "Foo.main(new String[]{\"a bc\",\"d\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo c:\\\\file.txt", "Foo.main(new String[]{\"c:\\\\file.txt\"});");</xmp></diff_add><diff_add><xmp>+    _assertJavaTransformation("java Foo /home/user/file", "Foo.main(new String[]{\"/home/user/file\"});");</xmp></diff_add><same><xmp>     _log.log("testInterpretJavaArguments ended");</xmp></same><same><xmp> }</xmp></same><prompt>drjava-ID-126  改方法名 (3/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><diff_remove><xmp>-public ReducedModelState _getStateAtCurrent() {</xmp></diff_remove><diff_remove><xmp>-    return _cursor._getStateAtCurrent();</xmp></diff_remove><diff_add><xmp>+public ReducedModelState getStateAtCurrent() {</xmp></diff_add><diff_add><xmp>+    return _cursor.getStateAtCurrent();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><diff_remove><xmp>-public ReducedModelState getStateAtCurrent() {</xmp></diff_remove><diff_remove><xmp>-    return _cursor.getStateAtCurrent();</xmp></diff_remove><diff_add><xmp>+public ReducedModelState _getStateAtCurrent() {</xmp></diff_add><diff_add><xmp>+    return _cursor._getStateAtCurrent();</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-93  改方法名 (4/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public final ExpressionSuffix primarySuffix() throws ParseException {</xmp></same><same><xmp>     ExpressionSuffix es;</xmp></same><diff_remove><xmp>-    if (jj_2_26(2)) {</xmp></diff_remove><diff_add><xmp>+    if (jj_2_27(2)) {</xmp></diff_add><same><xmp>         es = dotThis();</xmp></same><diff_remove><xmp>-    } else if (jj_2_27(2)) {</xmp></diff_remove><diff_add><xmp>+    } else if (jj_2_28(2)) {</xmp></diff_add><same><xmp>         es = dotAllocationExpression();</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         switch (jj_ntk == (-1) ? jj_ntk() : jj_ntk) {</xmp></same><diff_header><xmp>@@ -16,7 +16,7 @@</xmp></diff_header><same><xmp>                 es = arguments();</xmp></same><same><xmp>                 break;</xmp></same><same><xmp>             default :</xmp></same><diff_remove><xmp>-                jj_la1[98] = jj_gen;</xmp></diff_remove><diff_add><xmp>+                jj_la1[99] = jj_gen;</xmp></diff_add><same><xmp>                 jj_consume_token(-1);</xmp></same><same><xmp>                 throw new ParseException();</xmp></same><same><xmp>         }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public final ExpressionSuffix primarySuffix() throws ParseException {</xmp></same><same><xmp>     ExpressionSuffix es;</xmp></same><diff_remove><xmp>-    if (jj_2_29(2)) {</xmp></diff_remove><diff_add><xmp>+    if (jj_2_30(2)) {</xmp></diff_add><same><xmp>         es = dotThis();</xmp></same><diff_remove><xmp>-    } else if (jj_2_30(2)) {</xmp></diff_remove><diff_add><xmp>+    } else if (jj_2_31(2)) {</xmp></diff_add><same><xmp>         es = dotAllocationExpression();</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         switch (jj_ntk == (-1) ? jj_ntk() : jj_ntk) {</xmp></same><diff_header><xmp>@@ -16,7 +16,7 @@</xmp></diff_header><same><xmp>                 es = arguments();</xmp></same><same><xmp>                 break;</xmp></same><same><xmp>             default :</xmp></same><diff_remove><xmp>-                jj_la1[98] = jj_gen;</xmp></diff_remove><diff_add><xmp>+                jj_la1[99] = jj_gen;</xmp></diff_add><same><xmp>                 jj_consume_token(-1);</xmp></same><same><xmp>                 throw new ParseException();</xmp></same><same><xmp>         }</xmp></same><prompt>drjava-ID-163  改方法名 (5/5) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void testCannotEditBeforePrompt() throws EditDocumentException {</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     int origLength = 0;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         origLength = _doc.getLength();</xmp></same><same><xmp>         _doc.insertText(1, "typed text", DEFAULT_STYLE);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals("Document should not have changed.", origLength, _doc.getLength());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testGetColumn2() throws BadLocationException {</xmp></same><same><xmp>     final String s = "1234567890\n1234\n12345";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, s, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 5, defModel.getCurrentCol());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, s, null);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 5, _defModel.getCurrentCol());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testUncommentSingleLine() throws BadLocationException {</xmp></same><same><xmp>     String text = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "//         System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></same><diff_remove><xmp>-    String uncommented = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></diff_remove><diff_add><xmp>+    String uncommented = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "         System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></diff_add><same><xmp>     doc.insertString(0, text, null);</xmp></same><same><xmp>     _assertContents("Sample text is inserted improperly.", text, doc);</xmp></same><same><xmp>     doc.uncommentLines(doc.getLength() - 1, doc.getLength());</xmp></same><diff_remove><xmp>-    _assertContents("The last line should be indented and have no commenting!", uncommented, doc);</xmp></diff_remove><diff_add><xmp>+    _assertContents("The last line should have no commenting!", uncommented, doc);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,9 +5,11 @@</xmp></diff_header><same><xmp>         }</xmp></same><same><xmp>     });</xmp></same><same><xmp>     DrJava.getConfig().setSetting(ALLOW_PRIVATE_ACCESS, Boolean.valueOf(false));</xmp></same><diff_add><xmp>+    Utilities.clearEventQueue();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _interpreter.interpret("class A { private int i = 0; }");</xmp></same><same><xmp>         _interpreter.interpret("new A().i");</xmp></same><diff_add><xmp>+        System.err.println("Private access erroneously succeeded");</xmp></diff_add><same><xmp>         fail("Should not have access to the private field i inside class A.");</xmp></same><same><xmp>     } catch (ExceptionReturnedException ere) {</xmp></same><same><xmp>         assertTrue(ere.getContainedException() instanceof IllegalAccessException);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offs = _document.getLength();</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.insertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,12 +6,12 @@</xmp></diff_header><same><xmp>     File tempDir = new File(tempPath);</xmp></same><same><xmp>     tempDir.renameTo(new File(tempPath + "a"));</xmp></same><same><xmp>     String result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></same><diff_remove><xmp>-    assertTrue("interactions should have an error, not the correct answer", !"DrJavaTestFoo".equals(result));</xmp></diff_remove><diff_add><xmp>+    assertTrue("interactions should have an error, not the correct answer", !"\"DrJavaTestFoo\"".equals(result));</xmp></diff_add><same><xmp>     Vector<File> cp = new Vector<File>();</xmp></same><same><xmp>     cp.addElement(new File(tempPath + "a"));</xmp></same><same><xmp>     DrJava.getConfig().setSetting(EXTRA_CLASSPATH, cp);</xmp></same><same><xmp>     result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></same><diff_remove><xmp>-    assertEquals("interactions result", "DrJavaTestFoo", result);</xmp></diff_remove><diff_add><xmp>+    assertEquals("interactions result", "\"DrJavaTestFoo\"", result);</xmp></diff_add><same><xmp>     tempDir = new File(tempPath + "a");</xmp></same><same><xmp>     tempDir.renameTo(new File(tempPath));</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     String[] inputs = new String[]{ "\ttoken = nextToken(); // read trailing parenthesis\n", "\tif (token != \')\')\n", "\t  throw new ParseException(\"wrong number of arguments to |\");\n" };</xmp></same><same><xmp>     String expected = (" token = nextToken(); // read trailing parenthesis\n" + " if (token != \')\')\n") + "   throw new ParseException(\"wrong number of arguments to |\");\n";</xmp></same><same><xmp>     for (int i = 0; i < inputs.length; i++) {</xmp></same><diff_remove><xmp>-        defModel.insertString(defModel.getLength(), inputs[i], null);</xmp></diff_remove><diff_add><xmp>+        _defModel.insertString(_defModel.getLength(), inputs[i], null);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals(expected, _getAllText());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, AttributeSet set) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         insertString(getLength(), str, set);</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void remove(final int offset, final int len) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             clearCache();</xmp></same><same><xmp>             super.remove(offset, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testMultiplyingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) * new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_189() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_197() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RPAREN)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_133() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_135() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_277() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_328() {</xmp></diff_add><same><xmp>     if (jj_scan_token(STAR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void clearHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.clear();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_279() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_330() {</xmp></diff_add><same><xmp>     if (jj_scan_token(REMAINDER_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_270() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_278() {</xmp></diff_add><same><xmp>     if (jj_scan_token(PLUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testWillLoadClassFromGivenURLs() throws Throwable {</xmp></same><diff_remove><xmp>-    String logResource = "com/sun/tools/javac/util/Log.class";</xmp></diff_remove><diff_remove><xmp>-    String compilerClass = "com.sun.tools.javac.util.Context";</xmp></diff_remove><diff_add><xmp>+    String logResource = "com/sun/tools/javac/Main.class";</xmp></diff_add><diff_add><xmp>+    String compilerClass = "com.sun.tools.javac.Main";</xmp></diff_add><same><xmp>     URL[] urls = ToolsJarClassLoader.getToolsJarURLs();</xmp></same><same><xmp>     if (urls.length > 0) {</xmp></same><same><xmp>         StrictURLClassLoader loader = new StrictURLClassLoader(urls);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, DEFAULT_STYLE);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public int uncommentLines(int selStart, int selEnd) {</xmp></same><same><xmp>     int toReturn = selEnd;</xmp></same><same><xmp>     if (selStart == selEnd) {</xmp></same><diff_remove><xmp>-        modifyLock();</xmp></diff_remove><diff_add><xmp>+        acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             synchronized(_reduced) {</xmp></same><same><xmp>                 setCurrentLocation(selStart);</xmp></same><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>         } catch (BadLocationException e) {</xmp></same><same><xmp>             throw new UnexpectedException(e);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         toReturn = _uncommentBlock(selStart, selEnd);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void remove(int offs, int len) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canRemoveText(offs)) {</xmp></same><same><xmp>             super.remove(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     javacLoc.setFileFilter(ONLY);</xmp></same><same><xmp>     addOptionComponent(panel, javacLoc);</xmp></same><same><xmp>     addOptionComponent(panel, new VectorFileOptionComponent(OptionConstants.EXTRA_CLASSPATH, "Extra Classpath", this, "<html>Any directories or jar files to add to the classpath<br>" + "of the Compiler and Interactions Pane.</html>"));</xmp></same><diff_remove><xmp>-    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.STICKY_INTERACTIONS_DIRECTORY, "Restore last working directory of the Interactions pane on startUp", this, ((("<html>Whether to restore the last working directory of the Interaction pane on startUp,<br>" + "or to always use the value of the \"user.home\" Java property<br>") + "(currently ") + System.getProperty("user.home")) + ")."));</xmp></diff_remove><diff_add><xmp>+    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.STICKY_INTERACTIONS_DIRECTORY, "Restore last working directory of the Interactions pane on start up", this, ((("<html>Whether to restore the last working directory of the Interaction pane on start up,<br>" + "or to always use the value of the \"user.home\" Java property<br>") + "(currently ") + System.getProperty("user.home")) + ")."));</xmp></diff_add><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _styleChanged() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int length = getLength() - _currentLocation;</xmp></same><same><xmp>         DocumentEvent evt = new DefaultDocumentEvent(_currentLocation, length, DocumentEvent.EventType.CHANGE);</xmp></same><same><xmp>         fireChangedUpdate(evt);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_266() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_274() {</xmp></diff_add><same><xmp>     if (jj_scan_token(ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,12 +3,12 @@</xmp></diff_header><same><xmp>     TypeData sd = bb1.visit(_bbtc);</xmp></same><same><xmp>     assertEquals("There should be one error", 1, errors.size());</xmp></same><same><xmp>     assertEquals("Should return boolean type", BOOLEAN_TYPE.getInstanceData(), sd);</xmp></same><diff_remove><xmp>-    assertEquals("Error message should be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\".", errors.get(0).getFirst());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Error message should be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\"", errors.get(0).getFirst());</xmp></diff_add><same><xmp>     BracedBody bb2 = new BracedBody(SourceInfo.NO_INFO, new BodyItemI[]{ new ValueReturnStatement(SourceInfo.NO_INFO, new CharLiteral(SourceInfo.NO_INFO, 'c')) });</xmp></same><same><xmp>     sd = bb2.visit(_bbtc);</xmp></same><same><xmp>     assertEquals("There should be still be one error", 1, errors.size());</xmp></same><same><xmp>     assertEquals("Should return char type", CHAR_TYPE.getInstanceData(), sd);</xmp></same><diff_remove><xmp>-    assertEquals("Error message should still be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\".", errors.get(0).getFirst());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Error message should still be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\"", errors.get(0).getFirst());</xmp></diff_add><same><xmp>     _bbtc._bodyData = _bd2;</xmp></same><same><xmp>     BracedBody bb3 = new BracedBody(SourceInfo.NO_INFO, new BodyItemI[]{ new ValueReturnStatement(SourceInfo.NO_INFO, new IntegerLiteral(SourceInfo.NO_INFO, 1)) });</xmp></same><same><xmp>     sd = bb3.visit(_bbtc);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testGreaterThanEqual() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Float(1) >= new Float(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Float) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Float) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Float) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Float) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testGreaterThan() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Double(1) > new Double(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Double) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Double) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Double) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Double) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_114() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_501() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_499()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseAnd() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) & new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_419() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_429() {</xmp></diff_add><same><xmp>     if (jj_scan_token(EXTENDS)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_432()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         append(((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -45,6 +45,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> private static boolean _userWantsToPickAgain() {</xmp></same><diff_remove><xmp>-    final String[] text = new String[]{ "The file you chose did not appear to be a valid 'tools.jar'. ", "Would you like to pick again? The 'tools.jar' file is ", "generally located in the 'lib' subdirectory under your ", "JDK installation directory.", "(If you say 'No', DrJava might be unable to compile or ", "debug programs.)" };</xmp></diff_remove><diff_add><xmp>+    final String[] text = new String[]{ "The file you chose did not appear to be a valid 'tools.jar'. ", "(Your choice might be an incompatible version of the file.) ", "Would you like to pick again?  The 'tools.jar' file is ", "generally located in the 'lib' subdirectory under your ", "JDK installation directory.", "(If you say 'No', DrJava might be unable to compile or ", "debug programs.)" };</xmp></diff_add><same><xmp>     int result = JOptionPane.showConfirmDialog(null, text, "Locate 'tools.jar'?", JOptionPane.YES_NO_OPTION);</xmp></same><same><xmp>     return result == JOptionPane.YES_OPTION;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         append(((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -45,6 +45,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testGetPackageNameWithPackageStatementAfterImport() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String text = "import java.util.*;\npackage junk;\nclass Foo {}";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, text, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Package name for text with package statement after import", "", defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, text, null);</xmp></diff_add><diff_add><xmp>+    assertEquals("Package name for text with package statement after import", "", _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> protected void _setPendingNotifies(int n) throws InterruptedException {</xmp></same><same><xmp>     synchronized(_notifierLock) {</xmp></same><diff_remove><xmp>-        _log.log(("waiting for " + n) + " notifications...");</xmp></diff_remove><diff_add><xmp>+        _log.log(("Waiting for " + n) + " notifications ...");</xmp></diff_add><same><xmp>         _pendingNotifies = n;</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reverseSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             reverseHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,7 +4,7 @@</xmp></diff_header><same><xmp>     panel.addComponent(new FontOptionComponent(OptionConstants.FONT_DOCLIST, "Document List Font", this, "The font used in the list of open documents."));</xmp></same><same><xmp>     panel.addComponent(new FontOptionComponent(OptionConstants.FONT_TOOLBAR, "Toolbar Font", this, "The font used in the toolbar buttons."));</xmp></same><same><xmp>     if (CodeStatus.DEVELOPMENT) {</xmp></same><diff_remove><xmp>-        panel.addComponent(new BooleanOptionComponent(OptionConstants.TEXT_ANTIALIAS, "Use anti-aliased text in Definitions", this, "Whether to graphically smooth the text in the Definitions Pane."));</xmp></diff_remove><diff_add><xmp>+        panel.addComponent(new BooleanOptionComponent(OptionConstants.TEXT_ANTIALIAS, "Use anti-aliased text", this, "Whether to graphically smooth the text."));</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private static void _showErrorMessage(String cause, Throwable t) {</xmp></same><diff_remove><xmp>-    String msg = (("An error occurred while starting the slave JVM:\n  " + cause) + "\n\nOriginal error:\n") + StringOps.getStackTrace(t);</xmp></diff_remove><diff_remove><xmp>-    _log.log((("ERROR in Slave JVM Runner: " + cause) + "; threw ") + t);</xmp></diff_remove><diff_add><xmp>+    String msg = (("An error occurred in SlaveJVMRunner while starting the slave JVM:\n  " + cause) + "\n\nOriginal error:\n") + StringOps.getStackTrace(t);</xmp></diff_add><diff_add><xmp>+    _log.log((("ERROR in SlaveJVMRunner: " + cause) + "; threw ") + t);</xmp></diff_add><same><xmp>     if (SHOW_DEBUG_DIALOGS) {</xmp></same><same><xmp>         new ScrollableDialog(null, "Error", "Error details:", msg).show();</xmp></same><same><xmp>     } else if (!Utilities.TEST_MODE) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_177() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_185() {</xmp></diff_add><same><xmp>     if (jj_scan_token(THROW)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(SEMICOLON)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_571() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_574() {</xmp></diff_add><same><xmp>     if (jj_scan_token(CASE)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testLessThanEqual() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(12) <= new Integer(32);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertNewLine(int pos) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int len = _document.getLength();</xmp></same><same><xmp>         if (pos > len) {</xmp></same><diff_header><xmp>@@ -12,6 +12,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>             _document.insertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private int _commentBlock(final int start, final int end) {</xmp></same><same><xmp>     int afterCommentEnd = end;</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         final Position endPos = this.createPosition(end);</xmp></same><same><xmp>         int walker = start;</xmp></same><diff_header><xmp>@@ -18,7 +18,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     return afterCommentEnd;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testInteractionsCanSeeChangedClass() throws BadLocationException, IOException {</xmp></same><diff_remove><xmp>-    final String text_before = "class Foo { public int m() { return ";</xmp></diff_remove><diff_add><xmp>+    final String text_before = "class DrJavaTestFoo { public int m() { return ";</xmp></diff_add><same><xmp>     final String text_after = "; } }";</xmp></same><same><xmp>     final int num_iterations = 5;</xmp></same><same><xmp>     File file;</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         doc = setupDocument((text_before + i) + text_after);</xmp></same><same><xmp>         file = tempFile(i);</xmp></same><same><xmp>         _doCompile(doc, file);</xmp></same><diff_remove><xmp>-        assertEquals("interactions result, i=" + i, String.valueOf(i), interpret("new Foo().m()"));</xmp></diff_remove><diff_add><xmp>+        assertEquals("interactions result, i=" + i, String.valueOf(i), interpret("new DrJavaTestFoo().m()"));</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,8 +2,8 @@</xmp></diff_header><same><xmp>     _setDocText("foo\nbar\nblah");</xmp></same><same><xmp>     assertEquals("Returns position after the previous newline", 4, _doc.getLineStartPos(6));</xmp></same><same><xmp>     assertEquals("Returns position after previous newline when cursor " + "is at the position after the previous newline", 4, _doc.getLineStartPos(4));</xmp></same><diff_remove><xmp>-    assertEquals("Returns DOCSTART when there's no previous newline", 0, _doc.getLineStartPos(2));</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Returns DOCSTART when the cursor is at DOCSTART", 0, _doc.getLineStartPos(0));</xmp></diff_remove><diff_add><xmp>+    assertEquals("Returns 0 when there's no previous newline", 0, _doc.getLineStartPos(2));</xmp></diff_add><diff_add><xmp>+    assertEquals("Returns 0 when the cursor is at 0", 0, _doc.getLineStartPos(0));</xmp></diff_add><same><xmp>     _setDocText("abcdefghijk");</xmp></same><same><xmp>     _doc.setCurrentLocation(3);</xmp></same><same><xmp>     int reducedModelPos = _doc.getReduced().absOffset();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,5 +8,5 @@</xmp></diff_header><same><xmp>     String text = "try { throw new FileNotFoundException(\"file not found\"); } catch (FileNotFoundException e) { } finally { System.out.println(\"Finished\"); }";</xmp></same><same><xmp>     Node stmt = _parseCode(text).get(0);</xmp></same><same><xmp>     stmt.acceptVisitor(disp);</xmp></same><diff_remove><xmp>-    compareFileToString(_tempFile, (((((((((((((((((((((((((((((((((((((((((((((((((("l.1 TryStatement {\n" + "tryBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ThrowStatement {\n") + "    expression:\n") + "      l.1 SimpleAllocation {\n") + "      creationType:\n") + "        l.1 ReferenceType {\n") + "        representation:\n") + "          FileNotFoundException\n") + "        }\n") + "      arguments:\n") + "        l.1 Literal (class java.lang.String) <file not found> {\n") + "        }\n") + "      }\n") + "    }\n") + "  }\n") + "catchStatements:\n") + "  l.1 CatchStatement {\n") + "  exception:\n") + "    l.1 FormalParameter {\n") + "    type:\n") + "      l.1 ReferenceType {\n") + "      representation:\n") + "        FileNotFoundException\n") + "      }\n") + "    name:\n") + "      e\n") + "    }\n") + "  block:\n") + "    l.1 BlockStatement {\n") + "    statements:\n") + "    }\n") + "  }\n") + "finallyBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ObjectMethodCall {\n") + "    expression:\n") + "      l.1 QualifiedName {\n") + "      representation:\n") + "        System.out\n") + "      }\n") + "    methodName:\n") + "      println\n") + "    arguments:\n") + "      l.1 Literal (class java.lang.String) <Finished> {\n") + "      }\n") + "    }\n") + "  }\n") + "}");</xmp></diff_remove><diff_add><xmp>+    compareFileToString(_tempFile, (((((((((((((((((((((((((((((((((((((((((((((((((("l.1 TryStatement {\n" + "tryBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ThrowStatement {\n") + "    expression:\n") + "      l.1 SimpleAllocation {\n") + "      creationType:\n") + "        l.1 ReferenceTypeName {\n") + "        representation:\n") + "          FileNotFoundException\n") + "        }\n") + "      arguments:\n") + "        l.1 Literal (class java.lang.String) <file not found> {\n") + "        }\n") + "      }\n") + "    }\n") + "  }\n") + "catchStatements:\n") + "  l.1 CatchStatement {\n") + "  exception:\n") + "    l.1 FormalParameter {\n") + "    type:\n") + "      l.1 ReferenceTypeName {\n") + "      representation:\n") + "        FileNotFoundException\n") + "      }\n") + "    name:\n") + "      e\n") + "    }\n") + "  block:\n") + "    l.1 BlockStatement {\n") + "    statements:\n") + "    }\n") + "  }\n") + "finallyBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ObjectMethodCall {\n") + "    expression:\n") + "      l.1 QualifiedName {\n") + "      representation:\n") + "        System.out\n") + "      }\n") + "    methodName:\n") + "      println\n") + "    arguments:\n") + "      l.1 Literal (class java.lang.String) <Finished> {\n") + "      }\n") + "    }\n") + "  }\n") + "}");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallNextInteractionInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             moveHistoryNext(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_278() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_329() {</xmp></diff_add><same><xmp>     if (jj_scan_token(SLASH_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_277() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_285() {</xmp></diff_add><same><xmp>     if (jj_scan_token(OR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void updateModifiedSinceSave() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _isModifiedSinceSave = _undoManager.isModified();</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if ((!_isModifiedSinceSave) && (_odd != null)) {</xmp></same><same><xmp>             _odd.documentReset();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_241() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_242() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_37()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     Token xsp;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forceInsertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.forceInsertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, OBJECT_RETURN_STYLE);</xmp></same><diff_header><xmp>@@ -9,6 +9,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offs = _document.getLength();</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.insertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testRemoveTabs1() {</xmp></same><diff_remove><xmp>-    defModel.setIndent(1);</xmp></diff_remove><diff_add><xmp>+    _defModel.setIndent(1);</xmp></diff_add><same><xmp>     String test = "\t this \t\tis a \t\t\t\t\ttest\t\t";</xmp></same><diff_remove><xmp>-    String result = defModel._removeTabs(test);</xmp></diff_remove><diff_add><xmp>+    String result = _defModel._removeTabs(test);</xmp></diff_add><same><xmp>     assertEquals("  this   is a      test  ", result);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = ("package edu . rice\n./*comment!*/cs.drjava; \n" + " interface thisInterface { \n") + " class MyClass {";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_181() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_189() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RPAREN)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testParenthesizedAnonymousInnerClass() throws BadLocationException {</xmp></same><diff_remove><xmp>-    String text = ((("addActionListener(new ActionListener() {\n" + "public void actionPerformed(ActionEvent e) {\n") + "config.setSetting(LANGUAGE_LEVEL, DrJavaRoot.FULL_JAVA);\n") + "}});\n") + "group.add(rbMenuItem);\n";</xmp></diff_remove><diff_remove><xmp>-    String indented = ((("addActionListener(new ActionListener() {\n" + "  public void actionPerformed(ActionEvent e) {\n") + "    config.setSetting(LANGUAGE_LEVEL, DrJavaRoot.FULL_JAVA);\n") + "  }});\n") + "group.add(rbMenuItem);\n";</xmp></diff_remove><diff_add><xmp>+    String text = ((("addActionListener(new ActionListener() {\n" + "public void actionPerformed(ActionEvent e) {\n") + "config.setSetting(LANGUAGE_LEVEL, edu.rice.cs.drjava.config.OptionConstants.FULL_JAVA);\n") + "}});\n") + "group.add(rbMenuItem);\n";</xmp></diff_add><diff_add><xmp>+    String indented = ((("addActionListener(new ActionListener() {\n" + "  public void actionPerformed(ActionEvent e) {\n") + "    config.setSetting(LANGUAGE_LEVEL, edu.rice.cs.drjava.config.OptionConstants.FULL_JAVA);\n") + "  }});\n") + "group.add(rbMenuItem);\n";</xmp></diff_add><same><xmp>     _doc.insertString(0, text, null);</xmp></same><same><xmp>     _assertContents(text, _doc);</xmp></same><same><xmp>     safeIndentLines(0, _doc.getLength());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,7 +8,7 @@</xmp></diff_header><same><xmp>     if (jvmArgs.equals("") || (!called)) {</xmp></same><same><xmp>         _model.setOptionArgs(jvmArgs);</xmp></same><same><xmp>     } else {</xmp></same><diff_remove><xmp>-        String confirmMessage = (("Specifying the command-line arguments to the Interactions JVM is an\n" + "advanced option, and incorrect arguments may cause the Interactions\n") + "Pane to stop responding. Are you sure you want to set this option?\n") + "(You must reset the Interactions Pane before changes will take effect.)";</xmp></diff_remove><diff_add><xmp>+        String confirmMessage = (("Specifying the command-line arguments to the Interactions JVM is an\n" + "advanced option, and incorrect arguments may cause the Interactions\n") + "View to stop responding. Are you sure you want to set this option?\n") + "(You must reset the Interactions View before changes will take effect.)";</xmp></diff_add><same><xmp>         if (_view.showConfirmDialog("Setting JVM Arguments", confirmMessage)) {</xmp></same><same><xmp>             _model.setOptionArgs(jvmArgs);</xmp></same><same><xmp>         } else {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -26,7 +26,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     PredictiveInputModel<GoToFileListEntry> pim = new PredictiveInputModel<GoToFileListEntry>(true, new PredictiveInputModel.PrefixStrategy<GoToFileListEntry>(), list);</xmp></same><same><xmp>     OpenDefinitionsDocument odd = getCurrentDefPane().getOpenDefDocument();</xmp></same><diff_remove><xmp>-    odd.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    odd.modifyLock();</xmp></diff_add><same><xmp>     boolean uniqueMatch = true;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         String mask = "";</xmp></same><diff_header><xmp>@@ -82,7 +82,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException ble) {</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if (uniqueMatch) {</xmp></same><diff_remove><xmp>-            odd.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            odd.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,11 +8,11 @@</xmp></diff_header><same><xmp>     getErrorListPane().setFont(f);</xmp></same><same><xmp>     SwingDocument doc = ((SwingDocument) (getErrorListPane().getDocument()));</xmp></same><same><xmp>     if (doc instanceof SwingDocument) {</xmp></same><diff_remove><xmp>-        doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+        doc.modifyLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             ((SwingDocument) (doc)).setCharacterAttributes(0, doc.getLength() + 1, set, false);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            doc.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (_doc.getUndoableEditListeners().length == 0) {</xmp></same><same><xmp>         _resetUndo();</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     int len = _doc.getLength();</xmp></same><same><xmp>     if ((len < _position) || (len < _selEnd)) {</xmp></same><same><xmp>         _position = len;</xmp></same><diff_header><xmp>@@ -21,7 +21,7 @@</xmp></diff_header><same><xmp>             _doc.setCurrentLocation(_selEnd);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);</xmp></same><same><xmp>     _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forwardHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.forwardSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseXOr() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) ^ new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_267() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_275() {</xmp></diff_add><same><xmp>     if (jj_scan_token(STAR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testInteractionsCanSeeCompile() throws BadLocationException, IOException {</xmp></same><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     _doCompile(doc, tempFile());</xmp></same><diff_remove><xmp>-    String result = interpret("new Foo().getClass().getName()");</xmp></diff_remove><diff_remove><xmp>-    assertEquals("interactions result", "Foo", result);</xmp></diff_remove><diff_add><xmp>+    String result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></diff_add><diff_add><xmp>+    assertEquals("interactions result", "DrJavaTestFoo", result);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_287() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_338() {</xmp></diff_add><same><xmp>     if (jj_scan_token(OR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testPackageNameWeird2() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String weird = "package edu . rice //comment!\n.cs.drjava;";</xmp></same><same><xmp>     String normal = "edu.rice.cs.drjava";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("Package name for weird: '" + weird) + "'", normal, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("Package name for weird: '" + weird) + "'", normal, _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_187() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_195() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_173() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_177() {</xmp></diff_add><same><xmp>     if (jj_scan_token(THROW)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(SEMICOLON)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void reverseHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.reverseSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameWithClassloaderImport() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = "import classloader.class; class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for weird: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for weird: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,11 +8,11 @@</xmp></diff_header><same><xmp>     getErrorListPane().setFont(f);</xmp></same><same><xmp>     SwingDocument doc = ((SwingDocument) (getErrorListPane().getDocument()));</xmp></same><same><xmp>     if (doc instanceof SwingDocument) {</xmp></same><diff_remove><xmp>-        doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+        doc.acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             ((SwingDocument) (doc)).setCharacterAttributes(0, doc.getLength() + 1, set, false);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            doc.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,6 +2,6 @@</xmp></diff_header><same><xmp>     Object property = request.getProperty("debugAction");</xmp></same><same><xmp>     if ((property != null) && (property instanceof Breakpoint)) {</xmp></same><same><xmp>         Breakpoint breakpoint = ((Breakpoint) (property));</xmp></same><diff_remove><xmp>-        _model.printDebugMessage(((("Breakpoint hit in class " + breakpoint.getClassName()) + ", line ") + breakpoint.getLineNumber()) + ".");</xmp></diff_remove><diff_add><xmp>+        _model.printDebugMessage(((("Breakpoint hit in class " + breakpoint.getClassName()) + "  [line ") + breakpoint.getLineNumber()) + "]");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_273() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_281() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_SIGNED_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -10,7 +10,7 @@</xmp></diff_header><same><xmp>     if (makeBackup) {</xmp></same><same><xmp>         backup = fileSaver.getBackupFile();</xmp></same><same><xmp>         if (!renameFile(file, backup)) {</xmp></same><diff_remove><xmp>-            throw new IOException(("Save failed: Could not create backup file " + backup.getAbsolutePath()) + "\nIt may be possible to save by disabling file backups\n");</xmp></diff_remove><diff_add><xmp>+            throw new IOException(("Save failed. Could not create backup file " + backup.getAbsolutePath()) + "\nIt may be possible to save by disabling file backups\n");</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         fileSaver.backupDone();</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>@@ -33,7 +33,7 @@</xmp></diff_header><same><xmp>         bos.close();</xmp></same><same><xmp>         fos.close();</xmp></same><same><xmp>         if (tempFileUsed && (!renameFile(tempFile, file))) {</xmp></same><diff_remove><xmp>-            throw new IOException(("Save failed: Another process may be using " + file) + ".");</xmp></diff_remove><diff_add><xmp>+            throw new IOException(("Save failed. Another process may be using " + file) + ".");</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         success = true;</xmp></same><same><xmp>     } finally {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertNewLine(int pos) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int len = _document.getLength();</xmp></same><same><xmp>         if (pos > len) {</xmp></same><diff_header><xmp>@@ -12,6 +12,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -13,9 +13,9 @@</xmp></diff_header><same><xmp>                 }</xmp></same><same><xmp>                 return chosen;</xmp></same><same><xmp>             } else {</xmp></same><diff_remove><xmp>-                throw new RuntimeException("filechooser returned null file");</xmp></diff_remove><diff_add><xmp>+                throw new RuntimeException("Filechooser returned null file");</xmp></diff_add><same><xmp>             }</xmp></same><same><xmp>         default :</xmp></same><diff_remove><xmp>-            throw new RuntimeException("filechooser returned bad rc " + choice);</xmp></diff_remove><diff_add><xmp>+            throw new RuntimeException("Filechooser returned bad rc " + choice);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,8 +6,8 @@</xmp></diff_header><same><xmp>         for (int j = 0; j < comments.length; j++) {</xmp></same><same><xmp>             String curComment = comments[j];</xmp></same><same><xmp>             setUp();</xmp></same><diff_remove><xmp>-            defModel.insertString(0, (((curComment + "\n\n") + "package ") + curPack) + ";\nclass Foo { int x; }\n", null);</xmp></diff_remove><diff_remove><xmp>-            assertEquals("Package name for document with comment " + curComment, curPack, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+            _defModel.insertString(0, (((curComment + "\n\n") + "package ") + curPack) + ";\nclass Foo { int x; }\n", null);</xmp></diff_add><diff_add><xmp>+            assertEquals("Package name for document with comment " + curComment, curPack, _defModel.getPackageName());</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_561() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_568() {</xmp></diff_add><same><xmp>     if (jj_scan_token(CASE)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_281() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_332() {</xmp></diff_add><same><xmp>     if (jj_scan_token(MINUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testCommentsAfterBrace() throws BadLocationException {</xmp></same><same><xmp>     _text = ((((("class Foo {   \n" + "              \n") + "  /*          \n") + "   *          \n") + "   */         \n") + "  int field;  \n") + "}";</xmp></same><same><xmp>     _setDocText(_text);</xmp></same><diff_remove><xmp>-    assertTrue("START = DOCSTART.", !_rule.applyRule(_doc, 0, OTHER));</xmp></diff_remove><diff_remove><xmp>-    assertTrue("START = DOCSTART.", !_rule.applyRule(_doc, 14, OTHER));</xmp></diff_remove><diff_add><xmp>+    assertTrue("START = 0.", !_rule.applyRule(_doc, 0, OTHER));</xmp></diff_add><diff_add><xmp>+    assertTrue("START = 0.", !_rule.applyRule(_doc, 14, OTHER));</xmp></diff_add><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 15, OTHER));</xmp></same><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 30, OTHER));</xmp></same><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 44, OTHER));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testToString() {</xmp></same><diff_remove><xmp>-    assertEquals("Brace([40])", lparen.toString());</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Brace([41])", rparen.toString());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Brace<(>", lparen.toString());</xmp></diff_add><diff_add><xmp>+    assertEquals("Brace<)>", rparen.toString());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testStringOps() throws ExceptionReturnedException {</xmp></same><diff_remove><xmp>-    Pair[] cases = new Pair[]{ Pair.make("\"yeah\" + \"and\"", new String("yeah" + "and")), Pair.make("\"yeah\".equals(\"yeah\")", new Boolean("yeah".equals("yeah"))) };</xmp></diff_remove><diff_add><xmp>+    Pair[] cases = new Pair[]{ Pair.make("\"yeah\" + \"and\"", new String("\"yeah" + "and\"")), Pair.make("\"yeah\".equals(\"yeah\")", new Boolean("yeah".equals("yeah"))) };</xmp></diff_add><same><xmp>     tester(cases);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,73 +1,69 @@</xmp></diff_header><same><xmp> protected void doStart() {</xmp></same><diff_remove><xmp>-    if (_t != null) {</xmp></diff_remove><diff_remove><xmp>-        writeCommand(Command.RUN);</xmp></diff_remove><diff_remove><xmp>-    } else {</xmp></diff_remove><diff_remove><xmp>-        _executor.execute(new Runnable() {</xmp></diff_remove><diff_remove><xmp>-            public void run() {</xmp></diff_remove><diff_remove><xmp>-                _t = Thread.currentThread();</xmp></diff_remove><diff_add><xmp>+    _executor.execute(new Runnable() {</xmp></diff_add><diff_add><xmp>+        public void run() {</xmp></diff_add><diff_add><xmp>+            _t = Thread.currentThread();</xmp></diff_add><diff_add><xmp>+            try {</xmp></diff_add><diff_add><xmp>+                if (Thread.interrupted()) {</xmp></diff_add><diff_add><xmp>+                    throw new InterruptedException();</xmp></diff_add><diff_add><xmp>+                }</xmp></diff_add><diff_add><xmp>+                Process p = _jvmBuilder.start(ProcessIncrementalTaskController.Runner.class.getName(), IterUtil.<String>empty());</xmp></diff_add><same><xmp>                 try {</xmp></same><diff_remove><xmp>-                    if (Thread.interrupted()) {</xmp></diff_remove><diff_remove><xmp>-                        throw new InterruptedException();</xmp></diff_remove><diff_remove><xmp>-                    }</xmp></diff_remove><diff_remove><xmp>-                    Process p = _jvmBuilder.start(ProcessIncrementalTaskController.Runner.class.getName(), IterUtil.<String>empty());</xmp></diff_remove><diff_add><xmp>+                    InputStream in = p.getInputStream();</xmp></diff_add><diff_add><xmp>+                    int matching = 0;</xmp></diff_add><diff_add><xmp>+                    while (matching < Runner.PREFIX.length) {</xmp></diff_add><diff_add><xmp>+                        int read = in.read();</xmp></diff_add><diff_add><xmp>+                        if (read == (-1)) {</xmp></diff_add><diff_add><xmp>+                            throw new EOFException("Data prefix not found");</xmp></diff_add><diff_add><xmp>+                        } else if (((byte) (read)) == Runner.PREFIX[matching]) {</xmp></diff_add><diff_add><xmp>+                            matching++;</xmp></diff_add><diff_add><xmp>+                        } else if (((byte) (read)) == Runner.PREFIX[0]) {</xmp></diff_add><diff_add><xmp>+                            matching = 1;</xmp></diff_add><diff_add><xmp>+                        } else {</xmp></diff_add><diff_add><xmp>+                            matching = 0;</xmp></diff_add><diff_add><xmp>+                        }</xmp></diff_add><diff_add><xmp>+                    } </xmp></diff_add><diff_add><xmp>+                    ObjectInputStream objIn = new ObjectInputStream(in);</xmp></diff_add><same><xmp>                     try {</xmp></same><diff_remove><xmp>-                        InputStream in = p.getInputStream();</xmp></diff_remove><diff_remove><xmp>-                        int matching = 0;</xmp></diff_remove><diff_remove><xmp>-                        while (matching < Runner.PREFIX.length) {</xmp></diff_remove><diff_remove><xmp>-                            int read = in.read();</xmp></diff_remove><diff_remove><xmp>-                            if (read == (-1)) {</xmp></diff_remove><diff_remove><xmp>-                                throw new EOFException("Data prefix not found");</xmp></diff_remove><diff_remove><xmp>-                            } else if (((byte) (read)) == Runner.PREFIX[matching]) {</xmp></diff_remove><diff_remove><xmp>-                                matching++;</xmp></diff_remove><diff_remove><xmp>-                            } else if (((byte) (read)) == Runner.PREFIX[0]) {</xmp></diff_remove><diff_remove><xmp>-                                matching = 1;</xmp></diff_remove><diff_add><xmp>+                        ObjectOutputStream objOut = new ObjectOutputStream(p.getOutputStream());</xmp></diff_add><diff_add><xmp>+                        try {</xmp></diff_add><diff_add><xmp>+                            objOut.writeObject(_task);</xmp></diff_add><diff_add><xmp>+                            objOut.writeObject(Command.RUN);</xmp></diff_add><diff_add><xmp>+                            objOut.flush();</xmp></diff_add><diff_add><xmp>+                            _commandSink = objOut;</xmp></diff_add><diff_add><xmp>+                            Result r;</xmp></diff_add><diff_add><xmp>+                            do {</xmp></diff_add><diff_add><xmp>+                                r = ((Result) (objIn.readObject()));</xmp></diff_add><diff_add><xmp>+                                r.handle(ProcessIncrementalTaskController.this);</xmp></diff_add><diff_add><xmp>+                            } while (!(r instanceof ProcessIncrementalTaskController.FinishResult) );</xmp></diff_add><diff_add><xmp>+                            if (r instanceof ProcessIncrementalTaskController.CleanFinishResult) {</xmp></diff_add><diff_add><xmp>+                                Runnable1<? super Process> onExit = _onExit;</xmp></diff_add><diff_add><xmp>+                                if (onExit != null) {</xmp></diff_add><diff_add><xmp>+                                    p.waitFor();</xmp></diff_add><diff_add><xmp>+                                    onExit.run(p);</xmp></diff_add><diff_add><xmp>+                                }</xmp></diff_add><same><xmp>                             } else {</xmp></same><diff_remove><xmp>-                                matching = 0;</xmp></diff_remove><diff_remove><xmp>-                            }</xmp></diff_remove><diff_remove><xmp>-                        } </xmp></diff_remove><diff_remove><xmp>-                        ObjectInputStream objIn = new ObjectInputStream(in);</xmp></diff_remove><diff_remove><xmp>-                        try {</xmp></diff_remove><diff_remove><xmp>-                            ObjectOutputStream objOut = new ObjectOutputStream(p.getOutputStream());</xmp></diff_remove><diff_remove><xmp>-                            try {</xmp></diff_remove><diff_remove><xmp>-                                objOut.writeObject(_task);</xmp></diff_remove><diff_remove><xmp>-                                objOut.writeObject(Command.RUN);</xmp></diff_remove><diff_remove><xmp>-                                objOut.flush();</xmp></diff_remove><diff_remove><xmp>-                                _commandSink = objOut;</xmp></diff_remove><diff_remove><xmp>-                                Result r;</xmp></diff_remove><diff_remove><xmp>-                                do {</xmp></diff_remove><diff_remove><xmp>-                                    r = ((Result) (objIn.readObject()));</xmp></diff_remove><diff_remove><xmp>-                                    r.handle(ProcessIncrementalTaskController.this);</xmp></diff_remove><diff_remove><xmp>-                                } while (!(r instanceof ProcessIncrementalTaskController.FinishResult) );</xmp></diff_remove><diff_remove><xmp>-                                if (r instanceof ProcessIncrementalTaskController.CleanFinishResult) {</xmp></diff_remove><diff_remove><xmp>-                                    Runnable1<? super Process> onExit = _onExit;</xmp></diff_remove><diff_remove><xmp>-                                    if (onExit != null) {</xmp></diff_remove><diff_remove><xmp>-                                        p.waitFor();</xmp></diff_remove><diff_remove><xmp>-                                        onExit.run(p);</xmp></diff_remove><diff_remove><xmp>-                                    }</xmp></diff_remove><diff_remove><xmp>-                                } else {</xmp></diff_remove><diff_remove><xmp>-                                    p.destroy();</xmp></diff_remove><diff_remove><xmp>-                                }</xmp></diff_remove><diff_remove><xmp>-                            } finally {</xmp></diff_remove><diff_remove><xmp>-                                objOut.close();</xmp></diff_remove><diff_add><xmp>+                                p.destroy();</xmp></diff_add><same><xmp>                             }</xmp></same><same><xmp>                         } finally {</xmp></same><diff_remove><xmp>-                            objIn.close();</xmp></diff_remove><diff_add><xmp>+                            objOut.close();</xmp></diff_add><same><xmp>                         }</xmp></same><diff_remove><xmp>-                    } catch (EOFException e) {</xmp></diff_remove><diff_remove><xmp>-                        p.destroy();</xmp></diff_remove><diff_remove><xmp>-                        throw new IOException("Unable to run process; class path may need to be adjusted");</xmp></diff_remove><diff_remove><xmp>-                    } catch (Throwable e) {</xmp></diff_remove><diff_remove><xmp>-                        p.destroy();</xmp></diff_remove><diff_remove><xmp>-                        throw e;</xmp></diff_remove><diff_add><xmp>+                    } finally {</xmp></diff_add><diff_add><xmp>+                        objIn.close();</xmp></diff_add><same><xmp>                     }</xmp></same><diff_remove><xmp>-                } catch (InterruptedException e) {</xmp></diff_remove><diff_remove><xmp>-                } catch (InterruptedIOException e) {</xmp></diff_remove><diff_remove><xmp>-                } catch (RuntimeException e) {</xmp></diff_remove><diff_remove><xmp>-                    finishedWithImplementationException(e);</xmp></diff_remove><diff_remove><xmp>-                } catch (Throwable t) {</xmp></diff_remove><diff_remove><xmp>-                    finishedWithImplementationException(new WrappedException(t));</xmp></diff_remove><diff_add><xmp>+                } catch (EOFException e) {</xmp></diff_add><diff_add><xmp>+                    p.destroy();</xmp></diff_add><diff_add><xmp>+                    throw new IOException("Unable to run process; class path may need to be adjusted");</xmp></diff_add><diff_add><xmp>+                } catch (Throwable e) {</xmp></diff_add><diff_add><xmp>+                    p.destroy();</xmp></diff_add><diff_add><xmp>+                    throw e;</xmp></diff_add><same><xmp>                 }</xmp></same><diff_add><xmp>+            } catch (InterruptedException e) {</xmp></diff_add><diff_add><xmp>+            } catch (InterruptedIOException e) {</xmp></diff_add><diff_add><xmp>+            } catch (RuntimeException e) {</xmp></diff_add><diff_add><xmp>+                finishedWithImplementationException(e);</xmp></diff_add><diff_add><xmp>+            } catch (Throwable t) {</xmp></diff_add><diff_add><xmp>+                finishedWithImplementationException(new WrappedException(t));</xmp></diff_add><same><xmp>             }</xmp></same><diff_remove><xmp>-        });</xmp></diff_remove><diff_remove><xmp>-    }</xmp></diff_remove><diff_add><xmp>+        }</xmp></diff_add><diff_add><xmp>+    });</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Short(\"2\") | new Byte(\"2\");";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: byteValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Byte) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: byteValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Byte) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_284() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_335() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_UNSIGNED_SHIFTASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallPreviousInteractionInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             moveHistoryPrevious(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertBeforeLastPrompt(String text, String style) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int pos = getPositionBeforePrompt();</xmp></same><same><xmp>         _promptPos += text.length();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_268() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_276() {</xmp></diff_add><same><xmp>     if (jj_scan_token(SLASH_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGotoLine5() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(1);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 0, defModel.getCurrentLocation());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(1);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 0, _defModel.getCurrentLocation());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGotoLine6() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(4);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 0, defModel.getCurrentLocation());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(4);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 0, _defModel.getCurrentLocation());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> private int _replaceAllInCurrentDoc() {</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_isForward) {</xmp></same><same><xmp>             setPosition(0);</xmp></same><diff_header><xmp>@@ -15,6 +15,6 @@</xmp></diff_header><same><xmp>         } </xmp></same><same><xmp>         return count;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testInterpretInnerClassConstructorVarArgs() {</xmp></same><diff_remove><xmp>-    testString = ((((((((((((("public class B {\n" + "  public class C {\n") + "    String str = \"\";\n") + "    public C(String ... s){\n") + "      for(int i=0;i<s.length;i++) {\n") + "        str = str+s[i];\n") + "      }\n") + "    }\n") + "    public String getStr(){\n") + "      return str;\n") + "    }\n") + "  }\n") + "}\n") + "B b = new B();\n") + "b.new C(\"Str1\",\"Str2\",\"Str3\").getStr();\n";</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Str1Str2Str3", interpret(testString));</xmp></diff_remove><diff_add><xmp>+    testString = ((((((((((((("public class B {\n" + "  public class C {\n") + "    String str = \"\";\n") + "    public C(String ... s){\n") + "      for(int i=0;i<s.length;i++) {\n") + "        str = str+s[i];\n") + "      }\n") + "    }\n") + "    public String getStr(){\n") + "      return str;\n") + "    }\n") + "  }\n") + "}\n") + "B b = new B();\n") + "b.new C(\"Str1\",\"Str2\",\"Str3\",\"Str4\").getStr();\n";</xmp></diff_add><diff_add><xmp>+    assertEquals("Str1Str2Str3Str4", interpret(testString));</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void insertString(int offs, String str, AttributeSet set) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canInsertText(offs)) {</xmp></same><same><xmp>             super.insertString(offs, str, set);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testDividingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) / new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertString(int offset, String str, AttributeSet a) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_tabsRemoved) {</xmp></same><same><xmp>             str = _removeTabs(str);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>         setModifiedSinceSave();</xmp></same><same><xmp>         super.insertString(offset, str, a);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_276() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_284() {</xmp></diff_add><same><xmp>     if (jj_scan_token(XOR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void reverseHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.reverseSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testShiftLeft() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Short(\"-10\") << new Short(\"2\");";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"-10\" -10 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"-10\" -10 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setInProgress(boolean inProgress) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     _hasPrompt = !inProgress;</xmp></same><diff_remove><xmp>-    releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyUnlock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -9,7 +9,7 @@</xmp></diff_header><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_JAVADOC, "Automatically Save Before Generating Javadoc", this, "<html>Whether DrJava should automatically save before<br>" + "generating Javadoc or ask the user each time.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_BREAKPOINT_OUT_OF_SYNC, "Warn on Breakpoint if Out of Sync", this, "<html>Whether DrJava should warn the user if the class file<br>" + "is out of sync before setting a breakpoint in that file.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_DEBUG_MODIFIED_FILE, "Warn if Debugging Modified File", this, "<html>Whether DrJava should warn the user if the file being<br>" + "debugged has been modified since its last save.</html>"));</xmp></same><diff_remove><xmp>-    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_CHANGE_LAF, "Warn to Restart to Change Look and Feel", this, "<html>Whether DrJava should warn the user that look and feel<br>" + "changes will not be applied until DrJava is restarted.</html>."));</xmp></diff_remove><diff_add><xmp>+    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_CHANGE_LAF, "Warn to Restart to Change Look and Feel", this, "<html>Whether DrJava should warn the user that look and feel.<br>" + "(Changes will not be applied until DrJava is restarted.)</html>."));</xmp></diff_add><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_PATH_CONTAINS_POUND, "Warn if File's Path Contains a '#' Symbol", this, (("<html>Whether DrJava should warn the user if the file being<br>" + "saved has a path that contains a '#' symbol.<br>") + "Users cannot use such files in the Interactions Pane<br>") + "because of a bug in Java.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.DIALOG_DRJAVA_ERROR_POPUP_ENABLED, "Show a notification window when the first DrJava error occurs", this, "<html>Whether to show a notification window when the first DrJava error occurs.<br>" + "If this is disabled, only the \"DrJava Error\" button will appear.</html>"));</xmp></same><same><xmp>     panel.displayComponents();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,7 +6,7 @@</xmp></diff_header><same><xmp>         } catch (Exception e) {</xmp></same><same><xmp>             buildDirTxt = _model.getBuildDirectory().getPath();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        ConfirmCheckBoxDialog dialog = new ConfirmCheckBoxDialog(this, "Clean Built Directory?", ((("Cleaning your built directory will delete all\n" + "class files and empty folders within that directory.\n") + "Are you sure you want to clean\n") + buildDirTxt) + "?", "Do not show this message again");</xmp></diff_remove><diff_add><xmp>+        ConfirmCheckBoxDialog dialog = new ConfirmCheckBoxDialog(this, "Clean Build Directory?", ((("Cleaning your build directory will delete all\n" + "class files and empty folders within that directory.\n") + "Are you sure you want to clean\n") + buildDirTxt) + "?", "Do not show this message again");</xmp></diff_add><same><xmp>         int rc = dialog.show();</xmp></same><same><xmp>         switch (rc) {</xmp></same><same><xmp>             case JOptionPane.YES_OPTION :</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_280() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_331() {</xmp></diff_add><same><xmp>     if (jj_scan_token(PLUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_185() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_557() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_564()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private int _uncommentBlock(final int start, final int end) {</xmp></same><same><xmp>     int afterUncommentEnd = end;</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         final Position endPos = this.createPosition(end);</xmp></same><same><xmp>         int walker = start;</xmp></same><diff_header><xmp>@@ -17,7 +17,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     return afterUncommentEnd;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setInProgress(boolean inProgress) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     _hasPrompt = !inProgress;</xmp></same><diff_remove><xmp>-    modifyUnlock();</xmp></diff_remove><diff_add><xmp>+    releaseWriteLock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (_doc.getUndoableEditListeners().length == 0) {</xmp></same><same><xmp>         _resetUndo();</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    _doc.modifyLock();</xmp></diff_add><same><xmp>     int len = _doc.getLength();</xmp></same><same><xmp>     if ((len < _position) || (len < _selEnd)) {</xmp></same><same><xmp>         _position = len;</xmp></same><diff_header><xmp>@@ -21,7 +21,7 @@</xmp></diff_header><same><xmp>             _doc.setCurrentLocation(_selEnd);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        _doc.modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);</xmp></same><same><xmp>     _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testOringTwoBooleans() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) || new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public int commentLines(int selStart, int selEnd) {</xmp></same><same><xmp>     int toReturn = selEnd;</xmp></same><same><xmp>     if (selStart == selEnd) {</xmp></same><diff_remove><xmp>-        modifyLock();</xmp></diff_remove><diff_add><xmp>+        acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             synchronized(_reduced) {</xmp></same><same><xmp>                 setCurrentLocation(selStart);</xmp></same><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>         } catch (BadLocationException e) {</xmp></same><same><xmp>             throw new UnexpectedException(e);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         toReturn = _commentBlock(selStart, selEnd);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         insertText(getLength(), ((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -36,6 +36,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canInsertText(offs)) {</xmp></same><same><xmp>             forceInsertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void resetModification() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _isModifiedSinceSave = false;</xmp></same><same><xmp>         _undoManager.documentSaved();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>         if (_odd != null) {</xmp></same><same><xmp>             _odd.documentReset();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setPrompt(String prompt) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     _prompt = prompt;</xmp></same><diff_remove><xmp>-    releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyUnlock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -26,7 +26,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     PredictiveInputModel<GoToFileListEntry> pim = new PredictiveInputModel<GoToFileListEntry>(true, new PredictiveInputModel.PrefixStrategy<GoToFileListEntry>(), list);</xmp></same><same><xmp>     OpenDefinitionsDocument odd = getCurrentDefPane().getOpenDefDocument();</xmp></same><diff_remove><xmp>-    odd.modifyLock();</xmp></diff_remove><diff_add><xmp>+    odd.acquireWriteLock();</xmp></diff_add><same><xmp>     boolean uniqueMatch = true;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         String mask = "";</xmp></same><diff_header><xmp>@@ -83,7 +83,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException ble) {</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if (uniqueMatch) {</xmp></same><diff_remove><xmp>-            odd.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            odd.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_269() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_277() {</xmp></diff_add><same><xmp>     if (jj_scan_token(REMAINDER_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void interpreterResetting() {</xmp></same><same><xmp>     if (!_waitingForFirstInterpreter) {</xmp></same><diff_remove><xmp>-        _document.modifyLock();</xmp></diff_remove><diff_add><xmp>+        _document.acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             _document.insertBeforeLastPrompt("Resetting Interactions..." + _newLine, ERROR_STYLE);</xmp></same><same><xmp>             _document.setInProgress(true);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            _document.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            _document.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         try {</xmp></same><same><xmp>             _createNewDebugPort();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -38,6 +38,6 @@</xmp></diff_header><same><xmp>             _currentDefPane.requestFocus();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     }, null, "Find Next");</xmp></same><diff_remove><xmp>-    Singleton.put(KEY_PREVIOUS_PANE, _switchToPreviousPaneAction, null, "Switch Focus To Definitions Pane");</xmp></diff_remove><diff_remove><xmp>-    Singleton.put(KEY_NEXT_PANE, _switchToNextPaneAction, null, "Switch Focus To Interactions Pane");</xmp></diff_remove><diff_add><xmp>+    Singleton.put(KEY_PREVIOUS_PANE, _switchToPreviousPaneAction, null, "Switch Focus To Previous Pane");</xmp></diff_add><diff_add><xmp>+    Singleton.put(KEY_NEXT_PANE, _switchToNextPaneAction, null, "Switch Focus To Next Pane");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void addToHistory(String text) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.add(text);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -60,8 +60,8 @@</xmp></diff_header><same><xmp>     try {</xmp></same><same><xmp>         String mint_home = System.getenv("MINT_HOME");</xmp></same><same><xmp>         if (mint_home != null) {</xmp></same><diff_remove><xmp>-            addIfFile(new File(new File(mint_home), "dist/lib/classes.jar"), jars);</xmp></diff_remove><diff_remove><xmp>-            addIfFile(new File(new File(mint_home), "dist/lib/tools.jar"), jars);</xmp></diff_remove><diff_add><xmp>+            addIfFile(new File(new File(mint_home), "langtools/dist/lib/classes.jar"), jars);</xmp></diff_add><diff_add><xmp>+            addIfFile(new File(new File(mint_home), "langtools/dist/lib/tools.jar"), jars);</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } catch (Exception e) {</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_286() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_337() {</xmp></diff_add><same><xmp>     if (jj_scan_token(XOR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         remove(0, getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_556() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_563() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void clearHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.clear();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallNextInteractionInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             moveHistoryNext(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,12 +5,12 @@</xmp></diff_header><same><xmp>     dirChooser.setApproveButtonText("Select");</xmp></same><same><xmp>     dirChooser.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);</xmp></same><same><xmp>     dirChooser.setMultiSelectionEnabled(false);</xmp></same><diff_remove><xmp>-    FileOptionComponent workDir = new FileOptionComponent(OptionConstants.WORKING_DIRECTORY, "Working Directory", this, "The directory that DrJava should consider the current working directory.", dirChooser);</xmp></diff_remove><diff_add><xmp>+    FileOptionComponent workDir = new FileOptionComponent(OptionConstants.WORKING_DIRECTORY, "Working Directory", this, "The directory that DrJava should consider the default working directory.", dirChooser);</xmp></diff_add><same><xmp>     workDir.setFileFilter(new DirectoryFilter());</xmp></same><same><xmp>     panel.addComponent(workDir);</xmp></same><same><xmp>     panel.addComponent(new IntegerOptionComponent(OptionConstants.HISTORY_MAX_SIZE, "Size of Interactions History", this, "The number of interactions to remember in the history."));</xmp></same><same><xmp>     panel.addComponent(new IntegerOptionComponent(OptionConstants.RECENT_FILES_MAX_SIZE, "Recent Files List Size", this, "<html>The number of files to remember in<br>" + "the recently used files list in the File menu.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.JAVAC_ALLOW_ASSERT, "Allow Assert Keyword in Java 1.4", this, "<html>Whether to allow the <code>assert</code> keyword when compiling in Java 1.4.</html>"));</xmp></same><diff_remove><xmp>-    panel.addComponent(new BooleanOptionComponent(OptionConstants.BACKUP_FILES, "Keep emacs style backup files", this, "<html>Whether DrJava should keep a backup copy of each file that<br>" + "the user modifies, saved with a '~' at the end of the filename.</html>"));</xmp></diff_remove><diff_add><xmp>+    panel.addComponent(new BooleanOptionComponent(OptionConstants.BACKUP_FILES, "Keep Emacs-style Backup Files", this, "<html>Whether DrJava should keep a backup copy of each file that<br>" + "the user modifies, saved with a '~' at the end of the filename.</html>"));</xmp></diff_add><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseXOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) ^ new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reverseSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             reverseHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameMisleading() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*comment!*/cs.drjava; \n" + " {interface X} ") + " \"class Foo\"") + " class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for user interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for user interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forceInsertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.forceInsertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>             _document.insertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void forwardSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             forwardHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_355() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_358() {</xmp></diff_add><same><xmp>     if (jj_scan_token(INCREMENT)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertBeforeLastPrompt(String text, String style) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int pos = getPositionBeforePrompt();</xmp></same><same><xmp>         _promptPos += text.length();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void saveBeforeProceeding(GlobalModelListener.SaveReason reason) {</xmp></same><same><xmp>     String message;</xmp></same><same><xmp>     if (reason == COMPILE_REASON) {</xmp></same><diff_remove><xmp>-        message = "To compile, you must first save the current file. " + "Would you like to save and then compile?";</xmp></diff_remove><diff_add><xmp>+        message = "To compile, you must first save the current file.\n" + "Would you like to save and then compile?";</xmp></diff_add><same><xmp>     } else if (reason == JUNIT_REASON) {</xmp></same><diff_remove><xmp>-        message = "To run JUnit, you must first save and compile the current " + "file. Would like to save and then compile?";</xmp></diff_remove><diff_add><xmp>+        message = "To run JUnit, you must first save and compile the current\n" + "file. Would like to save and then compile?";</xmp></diff_add><same><xmp>     } else {</xmp></same><same><xmp>         throw new RuntimeException("Invalid reason for forcing a save.");</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, DEFAULT_STYLE);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_271() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_279() {</xmp></diff_add><same><xmp>     if (jj_scan_token(MINUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testShiftRight() throws InterpreterException {</xmp></same><same><xmp>     String text = "(new Short(\"1\") >> new Short(\"2\"));";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"1\" 1 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"1\" 1 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testLessThan() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Long(12) < new Long(32);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forwardHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.forwardSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameMisleading() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*comment!*/cs.drjava; \n" + " {class X} \n") + " interface thisInterface { \n") + " class MyInnerClass {";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testAddTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) + new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public void testInteractionAbort() throws BadLocationException, InterruptedException, IOException {</xmp></same><same><xmp>     _doCompile(setupDocument(FOO_TEXT), tempFile());</xmp></same><same><xmp>     final String beforeAbort = interpret("DrJavaTestFoo.class.getName()");</xmp></same><diff_remove><xmp>-    assertEquals("DrJavaTestFoo", beforeAbort);</xmp></diff_remove><diff_add><xmp>+    assertEquals("\"DrJavaTestFoo\"", beforeAbort);</xmp></diff_add><same><xmp>     TestListener listener = new TestListener() {</xmp></same><same><xmp>         public void interactionStarted() {</xmp></same><same><xmp>             interactionStartCount++;</xmp></same><diff_header><xmp>@@ -51,5 +51,5 @@</xmp></diff_header><same><xmp>     _model.removeListener(listener);</xmp></same><same><xmp>     assertEquals("5", interpret("5"));</xmp></same><same><xmp>     final String afterAbort = interpret("DrJavaTestFoo.class.getName()");</xmp></same><diff_remove><xmp>-    assertEquals("DrJavaTestFoo", afterAbort);</xmp></diff_remove><diff_add><xmp>+    assertEquals("\"DrJavaTestFoo\"", afterAbort);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameMisleading2() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*interface comment!*/cs.drjava; \n" + " {interface X<T>} ") + " \"class interface Foo\"") + " class MyClass extends Foo<T> {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for user interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for user interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallPreviousInteractionInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             moveHistoryPrevious(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void indentLines(int selStart, int selEnd, int reason, ProgressMonitor pm) throws OperationCanceledException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             if (selStart == selEnd) {</xmp></same><diff_header><xmp>@@ -18,7 +18,7 @@</xmp></diff_header><same><xmp>     } catch (Throwable t) {</xmp></same><same><xmp>         throw new UnexpectedException(t);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     endLastCompoundEdit();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_276() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_363() {</xmp></diff_add><same><xmp>     if (jj_scan_token(ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_111()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_274() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_282() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_UNSIGNED_SHIFTASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testAndingTwoBooleans() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) && new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_275() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_283() {</xmp></diff_add><same><xmp>     if (jj_scan_token(AND_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void clearCurrentInteraction() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         super.clearCurrentInput();</xmp></same><same><xmp>         _history.moveEnd();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_283() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_334() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_SIGNED_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_135() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_136() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testCompileWithPackageStatementInsideClass() throws BadLocationException, IOException {</xmp></same><same><xmp>     File baseTempDir = tempDirectory();</xmp></same><same><xmp>     File subdir = new File(baseTempDir, "a");</xmp></same><diff_remove><xmp>-    File fooFile = new File(subdir, "Foo.java");</xmp></diff_remove><diff_remove><xmp>-    File compiled = classForJava(fooFile, "Foo");</xmp></diff_remove><diff_add><xmp>+    File fooFile = new File(subdir, "DrJavaTestFoo.java");</xmp></diff_add><diff_add><xmp>+    File compiled = classForJava(fooFile, "DrJavaTestFoo");</xmp></diff_add><same><xmp>     subdir.mkdir();</xmp></same><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_PACKAGE_INSIDE_CLASS);</xmp></same><same><xmp>     doc.saveFileAs(new FileSelector(fooFile));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void clearCurrentInteraction() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         super.clearCurrentInput();</xmp></same><same><xmp>         _history.moveEnd();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryNext(String entry) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.moveNext(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.INTERACTIONS_RESET_PROMPT, "Prompt Before Resetting Interactions Pane", this, "<html>Whether DrJava should prompt the user before<br>" + "manually resetting the interactions pane.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.INTERACTIONS_EXIT_PROMPT, "Prompt if Interactions Pane Exits Unexpectedly", this, "<html>Whether DrJava should show a dialog box if a program<br>" + "in the Interactions Pane exits without the user clicking Reset.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.JAVADOC_PROMPT_FOR_DESTINATION, "Prompt for Javadoc Destination", this, "<html>Whether Javadoc should always prompt the user<br>" + "to select a destination directory.</html>"));</xmp></same><diff_remove><xmp>-    panel.addComponent(new BooleanOptionComponent(OptionConstants.PROMPT_BEFORE_CLEAN, "Prompt before Cleaning Built Directory", this, "<html>Whether DrJava should prompt before cleaning the<br>" + "built directory of a project</html>"));</xmp></diff_remove><diff_add><xmp>+    panel.addComponent(new BooleanOptionComponent(OptionConstants.PROMPT_BEFORE_CLEAN, "Prompt before Cleaning Build Directory", this, "<html>Whether DrJava should prompt before cleaning the<br>" + "build directory of a project</html>"));</xmp></diff_add><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_COMPILE, "Automatically Save Before Compiling", this, "<html>Whether DrJava should automatically save before<br>" + "recompiling or ask the user each time.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_JAVADOC, "Automatically Save Before Generating Javadoc", this, "<html>Whether DrJava should automatically save before<br>" + "generating Javadoc or ask the user each time.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.WARN_BREAKPOINT_OUT_OF_SYNC, "Warn on Breakpoint if Out of Sync", this, "<html>Whether DrJava should warn the user if the class file<br>" + "is out of sync before setting a breakpoint in that file.</html>"));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_285() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_336() {</xmp></diff_add><same><xmp>     if (jj_scan_token(AND_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><same><xmp>     DefinitionsDocument doc = getDocument();</xmp></same><diff_remove><xmp>-    doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         doc.remove(0, doc.getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canRemoveText(offs)) {</xmp></same><same><xmp>             forceRemoveText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,11 +2,11 @@</xmp></diff_header><same><xmp>     if (len == 0) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         setModifiedSinceSave();</xmp></same><same><xmp>         super.remove(offset, len);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_356() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_359() {</xmp></diff_add><same><xmp>     if (jj_scan_token(DECREMENT)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void interpreterResetting() {</xmp></same><same><xmp>     if (!_waitingForFirstInterpreter) {</xmp></same><diff_remove><xmp>-        _document.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+        _document.modifyLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             _document.insertBeforeLastPrompt("Resetting Interactions..." + _newLine, ERROR_STYLE);</xmp></same><same><xmp>             _document.setInProgress(true);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            _document.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            _document.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         try {</xmp></same><same><xmp>             _createNewDebugPort();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void classFileError(ClassFileError e) {</xmp></same><diff_remove><xmp>-    final String message = ((((("The class file for class " + e.getClassName()) + "in source file ") + e.getCanonicalPath()) + " cannot be loaded.\n ") + "When DrJava tries to load it, the following error is generated:\n") + e.getError();</xmp></diff_remove><diff_add><xmp>+    final String message = ((((("The class file for class " + e.getClassName()) + " in source file ") + e.getCanonicalPath()) + " cannot be loaded.\n ") + "When DrJava tries to load it, the following error is generated:\n") + e.getError();</xmp></diff_add><same><xmp>     Utilities.invokeLater(new Runnable() {</xmp></same><same><xmp>         public void run() {</xmp></same><diff_remove><xmp>-            JOptionPane.showMessageDialog(MainFrame.this, message, "Testing works only on well-formed, verifiable class files", JOptionPane.ERROR_MESSAGE);</xmp></diff_remove><diff_add><xmp>+            JOptionPane.showMessageDialog(MainFrame.this, message, "Testing works only on valid class files", JOptionPane.ERROR_MESSAGE);</xmp></diff_add><same><xmp>             showTab(_junitErrorPanel);</xmp></same><same><xmp>             _junitAction.setEnabled(true);</xmp></same><same><xmp>             _junitAllAction.setEnabled(true);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_245() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_244() {</xmp></diff_add><same><xmp>     if (jj_scan_token(COMMA)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_95()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><same><xmp>     DefinitionsDocument doc = getDocument();</xmp></same><diff_remove><xmp>-    doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    doc.modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         doc.remove(0, doc.getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _clearCurrentInputText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         removeText(_promptPos, _document.getLength() - _promptPos);</xmp></same><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseOr() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) | new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testModingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) % new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void disablePrompt() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _hasPrompt = false;</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testToString() {</xmp></same><diff_remove><xmp>-    assertEquals(" (", lparen.toString());</xmp></diff_remove><diff_remove><xmp>-    assertEquals(" )", rparen.toString());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Brace([40])", lparen.toString());</xmp></diff_add><diff_add><xmp>+    assertEquals("Brace([41])", rparen.toString());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -11,13 +11,13 @@</xmp></diff_header><same><xmp>     };</xmp></same><same><xmp>     Object _lock = new Object();</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><diff_remove><xmp>-        tree.addDocument(item, "folder3/");</xmp></diff_remove><diff_add><xmp>+        tree.addDocument(item, "folder3");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     InnerNode folder3 = ((InnerNode) (source.getChildAt(2)));</xmp></same><same><xmp>     assertEquals("folder3 should have 1 children", 1, folder3.getChildCount());</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><same><xmp>         _name = "MyTest.expected";</xmp></same><diff_remove><xmp>-        tree.refreshDocument(item, "folder3/");</xmp></diff_remove><diff_add><xmp>+        tree.refreshDocument(item, "folder3");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><same><xmp>         assertEquals("folder3 should have 1 children", 1, folder3.getChildCount());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameWComments() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (((((("package edu . rice\n./*comment!*/cs.drjava; \n" + "/* class Y */ \n") + " /* class Foo \n") + " * class Bar \n") + " interface Baz \n") + " */ \n") + "//class Blah\n") + "class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for class: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for class: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void insertString(int offset, String str, AttributeSet a) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             clearCache();</xmp></same><same><xmp>             super.insertString(offset, str, a);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_113() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_114() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testSubtractingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) - new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_417() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_419() {</xmp></diff_add><same><xmp>     if (jj_scan_token(EXTENDS)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -31,5 +31,5 @@</xmp></diff_header><same><xmp>     _redoAction.putValue(Action.NAME, "Redo Last Undo");</xmp></same><same><xmp>     _setUpAction(_resetInteractionsAction, "Reset", "Reset interactions");</xmp></same><same><xmp>     _setUpAction(_junitAction, "Test", "Run JUnit over the current document");</xmp></same><diff_remove><xmp>-    _setUpAction(_javadocAction, "JavaDoc", "Test", "Create javadoc");</xmp></diff_remove><diff_add><xmp>+    _setUpAction(_javadocAction, "Javadoc", "Test", "Create Javadoc for open documents");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setPrompt(String prompt) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     _prompt = prompt;</xmp></same><diff_remove><xmp>-    modifyUnlock();</xmp></diff_remove><diff_add><xmp>+    releaseWriteLock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void addToHistory(String text) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.add(text);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_282() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_333() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LEFT_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _document.removeText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -14,7 +14,7 @@</xmp></diff_header><same><xmp>                 _junitInterrupted("Unit testing cancelled by user.");</xmp></same><same><xmp>             }</xmp></same><same><xmp>         });</xmp></same><diff_remove><xmp>-        ScrollableListDialog<OpenDefinitionsDocument> dialog = new ScrollableListDialog.Builder<OpenDefinitionsDocument>().setOwner(this).setTitle("Must Compile All Source Files to Run Unit Tests").setText(("Before you can run unit tests, you must first compile all out of sync source files.\n" + "The files below are out of sync. Would you like to compile all files and\n") + "run the specified test(s)?").setItems(outOfSync).setMessageType(JOptionPane.QUESTION_MESSAGE).setFitToScreen(true).clearButtons().addButton(yesButton).addButton(noButton).build();</xmp></diff_remove><diff_add><xmp>+        ScrollableListDialog<OpenDefinitionsDocument> dialog = new ScrollableListDialog.Builder<OpenDefinitionsDocument>().setOwner(this).setTitle("Must Compile All Source Files to Run Unit Tests").setText(("<html>Before you can run unit tests, you must first compile all out of sync source files.<br>" + "The files below are out of sync. Would you like to compile all files and<br>") + "run the specified test(s)?").setItems(outOfSync).setMessageType(JOptionPane.QUESTION_MESSAGE).setFitToScreen(true).clearButtons().addButton(yesButton).addButton(noButton).build();</xmp></diff_add><same><xmp>         dialog.showDialog();</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseAnd() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Character('a') & new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: charValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Character) [(koala.dynamicjava.tree.CharacterLiteral: 'a' a char)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: charValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Character) [(koala.dynamicjava.tree.CharacterLiteral: 'a' a char)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryNext(String entry) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.moveNext(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_134() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_143() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_90()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_133() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_135() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -38,8 +38,8 @@</xmp></diff_header><same><xmp>     _setUpAction(_quitAction, "Quit", "Quit", "Quit DrJava");</xmp></same><same><xmp>     _setUpAction(_undoAction, "Undo", "Undo previous command");</xmp></same><same><xmp>     _setUpAction(_redoAction, "Redo", "Redo last undo");</xmp></same><diff_remove><xmp>-    _undoAction.putValue(Action.NAME, "Undo Previous Command");</xmp></diff_remove><diff_remove><xmp>-    _redoAction.putValue(Action.NAME, "Redo Last Undo");</xmp></diff_remove><diff_add><xmp>+    _undoAction.putValue(Action.NAME, "Undo previous command");</xmp></diff_add><diff_add><xmp>+    _redoAction.putValue(Action.NAME, "Redo last undo");</xmp></diff_add><same><xmp>     _setUpAction(cutAction, "Cut", "Cut selected text to the clipboard");</xmp></same><same><xmp>     _setUpAction(copyAction, "Copy", "Copy selected text to the clipboard");</xmp></same><same><xmp>     _setUpAction(pasteAction, "Paste", "Paste text from the clipboard");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameBeforeClassName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = ((("package edu . rice\n./*comment!*/cs.drjava; \n" + " interface thisInterface { \n") + "  } \n") + " class thatClass {\n") + "  }";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("interface should have been chosen, rather than the class: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("interface should have been chosen, rather than the class: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) | new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void disablePrompt() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _hasPrompt = false;</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, OBJECT_RETURN_STYLE);</xmp></same><diff_header><xmp>@@ -9,6 +9,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testInterpretJavaSingleQuotedArgs() throws DocumentAdapterException {</xmp></same><diff_remove><xmp>-    _assertProcessedContents("java Foo 'asdf'", "Foo.main(new String[]{\"\'asdf\'\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertProcessedContents("java Foo 'a b c'", "Foo.main(new String[]{\"\'a\",\"b\",\"c\'\"});");</xmp></diff_remove><diff_add><xmp>+    _assertProcessedContents("java Foo 'asdf'", "Foo.main(new String[]{\"asdf\"});");</xmp></diff_add><diff_add><xmp>+    _assertProcessedContents("java Foo 'a b c'", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseXOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Long(0) ^ new Integer(1);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 0 0 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 0 0 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    acquireReadLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        releaseReadLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseAnd() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) & new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void testCannotEditBeforePrompt() throws EditDocumentException {</xmp></same><diff_remove><xmp>-    _doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    _doc.modifyLock();</xmp></diff_add><same><xmp>     int origLength = 0;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         origLength = _doc.getLength();</xmp></same><same><xmp>         _doc.insertText(1, "typed text", DEFAULT_STYLE);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        _doc.modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals("Document should not have changed.", origLength, _doc.getLength());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,10 +5,10 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     MethodData md = createMethodData(that, _symbolData);</xmp></same><same><xmp>     if (md.hasModifier("private")) {</xmp></same><diff_remove><xmp>-        _addAndIgnoreError("Interface methods cannot be made private.  They must be public.", that.getMav());</xmp></diff_remove><diff_add><xmp>+        _addAndIgnoreError("Interface methods cannot be private.  They must be public.", that.getMav());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     if (md.hasModifier("protected")) {</xmp></same><diff_remove><xmp>-        _addAndIgnoreError("Interface methods cannot be made protected.  They must be public.", that.getMav());</xmp></diff_remove><diff_add><xmp>+        _addAndIgnoreError("Interface methods cannot be protected.  They must be public.", that.getMav());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     md.addModifier("public");</xmp></same><same><xmp>     md.addModifier("abstract");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _document.removeText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_272() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_280() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LEFT_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryPrevious(String entry) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.movePrevious(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> private String _getAllText() throws BadLocationException {</xmp></same><diff_remove><xmp>-    return defModel.getText(0, defModel.getLength());</xmp></diff_remove><diff_add><xmp>+    return _defModel.getText(0, _defModel.getLength());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGetLine5() {</xmp></same><diff_remove><xmp>-    defModel.setCurrentLocation(0);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 1, defModel.getCurrentLine());</xmp></diff_remove><diff_add><xmp>+    _defModel.setCurrentLocation(0);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 1, _defModel.getCurrentLine());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testGetIndentOfCurrStmtDelimiters() throws BadLocationException {</xmp></same><same><xmp>     _setDocText("foo();\n");</xmp></same><diff_remove><xmp>-    assertEquals("prev delimiter DOCSTART, no indent", "", _doc.getIndentOfCurrStmt(3));</xmp></diff_remove><diff_add><xmp>+    assertEquals("prev delimiter 0, no indent", "", _doc.getIndentOfCurrStmt(3));</xmp></diff_add><same><xmp>     _setDocText("  foo();\n");</xmp></same><diff_remove><xmp>-    assertEquals("prev delimiter DOCSTART, indent two spaces", "  ", _doc.getIndentOfCurrStmt(7));</xmp></diff_remove><diff_add><xmp>+    assertEquals("prev delimiter 0, indent two spaces", "  ", _doc.getIndentOfCurrStmt(7));</xmp></diff_add><same><xmp>     _setDocText("bar();\nfoo();\n");</xmp></same><same><xmp>     assertEquals("prev delimiter ';', no indent", "", _doc.getIndentOfCurrStmt(7));</xmp></same><same><xmp>     _setDocText("  bar();\n  foo();\n");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_135() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_139() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryPrevious(String entry) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.movePrevious(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public String getDescription() {</xmp></same><same><xmp>     switch (DrJava.getConfig().getSetting(LANGUAGE_LEVEL)) {</xmp></same><same><xmp>         case DrJava.FULL_JAVA :</xmp></same><diff_remove><xmp>-            return "Java and GJ source files";</xmp></diff_remove><diff_add><xmp>+            return "Java source files";</xmp></diff_add><same><xmp>         case DrJava.ELEMENTARY_LEVEL :</xmp></same><same><xmp>             return "Elementary source files (.dj0)";</xmp></same><same><xmp>         case DrJava.INTERMEDIATE_LEVEL :</xmp></same><diff_header><xmp>@@ -9,5 +9,5 @@</xmp></diff_header><same><xmp>         case DrJava.ADVANCED_LEVEL :</xmp></same><same><xmp>             return "Advanced source files (.dj2)";</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    return "Java and GJ source files";</xmp></diff_remove><diff_add><xmp>+    return "Java source files";</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertPrompt() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceInsertText(_document.getLength(), _prompt, DEFAULT_STYLE);</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public String toString() {</xmp></same><same><xmp>     String ret = new String();</xmp></same><diff_remove><xmp>-    ret = (("forward = \n" + forward.values()) + "\n backward = \n") + backward.values();</xmp></diff_remove><diff_add><xmp>+    ret = (("forward = " + forward.values()) + "\nbackward = ") + backward.values();</xmp></diff_add><same><xmp>     return ret;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGetLine6() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(4);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 1, defModel.getCurrentLine());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(4);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 1, _defModel.getCurrentLine());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _clearCurrentInputText() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         removeText(_promptPos, _document.getLength() - _promptPos);</xmp></same><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = "package edu . rice\n./*comment!*/cs.drjava; class MyClass<T> implements O{";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for weird: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for weird: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testPackageNameWeird1() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String weird = "package edu . rice\n./*comment!*/cs.drjava;";</xmp></same><same><xmp>     String normal = "edu.rice.cs.drjava";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("Package name for weird: '" + weird) + "'", normal, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("Package name for weird: '" + weird) + "'", normal, _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     if (!onMatch()) {</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offset = getCurrentOffset();</xmp></same><same><xmp>         if (_isForward) {</xmp></same><diff_header><xmp>@@ -19,6 +19,6 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertPrompt() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceInsertText(_document.getLength(), _prompt, DEFAULT_STYLE);</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void forwardSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             forwardHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public void testDefineConstantExternally() throws ExceptionReturnedException {</xmp></same><diff_remove><xmp>-    _interpreter.defineConstant("x", 3);</xmp></diff_remove><diff_add><xmp>+    _interpreter.defineConstant("y", 3);</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreter.interpret("x = 4");</xmp></diff_remove><diff_add><xmp>+        _interpreter.interpret("y = 4");</xmp></diff_add><same><xmp>         fail("should not be able to assign to a constant");</xmp></same><same><xmp>     } catch (ExceptionReturnedException e) {</xmp></same><same><xmp>     }</xmp></same><desc>============================序列index============================</desc></br><prompt>drjava-ID-59  序列index (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,7 +4,7 @@</xmp></diff_header><same><xmp>             jj_consume_token(STATIC);</xmp></same><same><xmp>             break;</xmp></same><same><xmp>         default :</xmp></same><diff_remove><xmp>-            jj_la1[158] = jj_gen;</xmp></diff_remove><diff_add><xmp>+            jj_la1[157] = jj_gen;</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     blockLookahead();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,6 +6,6 @@</xmp></diff_header><same><xmp>             typeLookahead();</xmp></same><same><xmp>             break;</xmp></same><same><xmp>         default :</xmp></same><diff_remove><xmp>-            jj_la1[155] = jj_gen;</xmp></diff_remove><diff_add><xmp>+            jj_la1[157] = jj_gen;</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><desc>============================方法参数都有变化============================</desc></br><prompt>drjava-ID-143  方法参数都有变化 (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,5 +2,5 @@</xmp></diff_header><same><xmp>     BraceReduction rm = doc._reduced;</xmp></same><same><xmp>     doc.insertString(0, "public class temp \n{  ()\ntext here", null);</xmp></same><same><xmp>     doc.indentLines(doc.getCurrentLocation(), doc.getCurrentLocation());</xmp></same><diff_remove><xmp>-    assertEquals("0.1", "public class temp \n{  ()\n  text here", doc.getText(0, doc.getLength()));</xmp></diff_remove><diff_add><xmp>+    _assertContents("public class temp \n{  ()\n  text here", doc);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,5 +4,5 @@</xmp></diff_header><same><xmp>     doc.insertString(11, "\n{", null);</xmp></same><same><xmp>     doc.move(-8);</xmp></same><same><xmp>     doc.indentLines(doc.getCurrentLocation(), doc.getCurrentLocation());</xmp></same><diff_remove><xmp>-    assertEquals("0.1", "hes{\n  {abcde\n{", doc.getText(0, doc.getLength()));</xmp></diff_remove><diff_add><xmp>+    _assertContents("hes{\n  {abcde\n{", doc);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,5 +2,5 @@</xmp></diff_header><same><xmp>     BraceReduction rm = doc._reduced;</xmp></same><same><xmp>     doc.insertString(0, "{\n  if\n    if\n      if\n{", null);</xmp></same><same><xmp>     doc.indentLines(doc.getCurrentLocation(), doc.getCurrentLocation());</xmp></same><diff_remove><xmp>-    assertEquals("0.1", "{\n  if\n    if\n      if\n      {", doc.getText(0, doc.getLength()));</xmp></diff_remove><diff_add><xmp>+    _assertContents("{\n  if\n    if\n      if\n      {", doc);</xmp></diff_add><same><xmp> }</xmp></same><desc>============================改类============================</desc></br><prompt>drjava-ID-146  改类 (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,7 +4,7 @@</xmp></diff_header><same><xmp>     _machine.setReplaceWord(_replaceField.getText());</xmp></same><same><xmp>     _mainframe.clearStatusMessage();</xmp></same><same><xmp>     FindResult fr = _machine.findNext();</xmp></same><diff_remove><xmp>-    Document doc = fr.getDocument();</xmp></diff_remove><diff_add><xmp>+    AbstractDocumentInterface doc = fr.getDocument();</xmp></diff_add><same><xmp>     OpenDefinitionsDocument matchDoc = ((DefaultSingleDisplayModel) (_model)).getODDForDocument(doc);</xmp></same><same><xmp>     OpenDefinitionsDocument openDoc = _defPane.getOpenDefDocument();</xmp></same><same><xmp>     int pos = fr.getFoundOffset();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public int replaceAll() {</xmp></same><same><xmp>     if (_searchAllDocuments) {</xmp></same><diff_remove><xmp>-        Document startDoc = _doc;</xmp></diff_remove><diff_add><xmp>+        AbstractDocumentInterface startDoc = _doc;</xmp></diff_add><same><xmp>         _searchAllDocuments = false;</xmp></same><same><xmp>         int count = _replaceAllInCurrentDoc();</xmp></same><same><xmp>         _doc = _docIterator.getNextDocument(_doc);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><diff_remove><xmp>-public Document getDocument() {</xmp></diff_remove><diff_add><xmp>+public AbstractDocumentInterface getDocument() {</xmp></diff_add><same><xmp>     return _document;</xmp></same><same><xmp> }</xmp></same><desc>============================声明新变量============================</desc></br><prompt>drjava-ID-110  声明新变量 (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,9 +2,9 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreterJVM().setShowMessageOnResetFailure(show);</xmp></diff_remove><diff_add><xmp>+        slave.setShowMessageOnResetFailure(show);</xmp></diff_add><same><xmp>     } catch (RemoteException re) {</xmp></same><same><xmp>         _threwException(re);</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,9 +2,9 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreterJVM().addDebugInterpreter(name, className);</xmp></diff_remove><diff_add><xmp>+        slave.addDebugInterpreter(name, className);</xmp></diff_add><same><xmp>     } catch (RemoteException re) {</xmp></same><same><xmp>         _threwException(re);</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,9 +2,9 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreterJVM().removeInterpreter(name);</xmp></diff_remove><diff_add><xmp>+        slave.removeInterpreter(name);</xmp></diff_add><same><xmp>         if (name.equals(_currentInterpreterName)) {</xmp></same><same><xmp>             _currentInterpreterName = null;</xmp></same><same><xmp>         }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,12 +2,12 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _log.log(((this + ".interpret(") + s) + ")");</xmp></same><same><xmp>         _slaveJVMUsed = true;</xmp></same><same><xmp>         _interactionsModel.slaveJVMUsed();</xmp></same><diff_remove><xmp>-        _interpreterJVM().interpret(s);</xmp></diff_remove><diff_add><xmp>+        slave.interpret(s);</xmp></diff_add><same><xmp>     } catch (UnmarshalException ume) {</xmp></same><same><xmp>         _log.log((this + ".interpret threw UnmarshalException, so interpreter is dead:\n") + ume);</xmp></same><same><xmp>     } catch (RemoteException re) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,9 +2,9 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreterJVM().setPackageScope(packageName);</xmp></diff_remove><diff_add><xmp>+        slave.setPackageScope(packageName);</xmp></diff_add><same><xmp>     } catch (RemoteException re) {</xmp></same><same><xmp>         _threwException(re);</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,9 +2,9 @@</xmp></diff_header><same><xmp>     if (!_restart) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    ensureInterpreterConnected();</xmp></diff_remove><diff_add><xmp>+    InterpreterJVMRemoteI slave = ensureInterpreterConnected();</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreterJVM().addJavaInterpreter(name);</xmp></diff_remove><diff_add><xmp>+        slave.addJavaInterpreter(name);</xmp></diff_add><same><xmp>     } catch (RemoteException re) {</xmp></same><same><xmp>         _threwException(re);</xmp></same><same><xmp>     }</xmp></same><desc>============================字符串内容变化============================</desc></br><prompt>drjava-ID-117  字符串内容变化 (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> private Javac150FromToolsJar() {</xmp></same><diff_remove><xmp>-    super("edu.rice.cs.drjava.model.compiler.JSR14v20Compiler", new ToolsJarClassLoader());</xmp></diff_remove><diff_add><xmp>+    super("edu.rice.cs.drjava.model.compiler.Javac150Compiler", new ToolsJarClassLoader());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public Javac150FromSetLocation() {</xmp></same><diff_remove><xmp>-    super("edu.rice.cs.drjava.model.compiler.JSR14v20Compiler", _getClassLoader());</xmp></diff_remove><diff_add><xmp>+    super("edu.rice.cs.drjava.model.compiler.Javac150Compiler", _getClassLoader());</xmp></diff_add><same><xmp> }</xmp></same><desc>============================加return============================</desc></br><prompt>drjava-ID-124  加return (1/2) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forImportStatementDoFirst(ImportStatement that) {</xmp></diff_remove><diff_add><xmp>+public Void forImportStatementDoFirst(ImportStatement that) {</xmp></diff_add><same><xmp>     _addError("Import statements cannot be used at the Elementary level", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forThrowStatementDoFirst(ThrowStatement that) {</xmp></diff_remove><diff_add><xmp>+public Void forThrowStatementDoFirst(ThrowStatement that) {</xmp></diff_add><same><xmp>     _addError("Throw statements cannot be used at the Elementary level", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-221  加return (2/2) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forBitwiseAndExpressionDoFirst(BitwiseAndExpression that) {</xmp></diff_remove><diff_add><xmp>+public Void forBitwiseAndExpressionDoFirst(BitwiseAndExpression that) {</xmp></diff_add><same><xmp>     _addAndIgnoreError("Bitwise and expressions cannot be used at any language level." + "  Perhaps you meant to compare two values using regular and (&&)", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forBitwiseNotExpressionDoFirst(BitwiseNotExpression that) {</xmp></diff_remove><diff_add><xmp>+public Void forBitwiseNotExpressionDoFirst(BitwiseNotExpression that) {</xmp></diff_add><same><xmp>     _addAndIgnoreError("Bitwise not expressions cannot be used at any language level." + "  Perhaps you meant to negate this value using regular not (!)", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forBitwiseOrExpressionDoFirst(BitwiseOrExpression that) {</xmp></diff_remove><diff_add><xmp>+public Void forBitwiseOrExpressionDoFirst(BitwiseOrExpression that) {</xmp></diff_add><same><xmp>     _addAndIgnoreError("Bitwise or expressions cannot be used at any language level." + "  Perhaps you meant to compare two values using regular or (||)", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void forBitwiseXorExpressionDoFirst(BitwiseXorExpression that) {</xmp></diff_remove><diff_add><xmp>+public Void forBitwiseXorExpressionDoFirst(BitwiseXorExpression that) {</xmp></diff_add><same><xmp>     _addAndIgnoreError("Bitwise xor expressions cannot be used at any language level", that);</xmp></same><diff_add><xmp>+    return null;</xmp></diff_add><same><xmp> }</xmp></same><desc>============================final============================</desc></br><prompt>drjava-ID-180  final (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public String toString() {</xmp></same><diff_remove><xmp>-    StringBuffer buf = new StringBuffer();</xmp></diff_remove><diff_add><xmp>+    final StringBuilder buf = new StringBuilder();</xmp></diff_add><same><xmp>     buf.append(this.getClass().toString() + ":\n  ");</xmp></same><same><xmp>     for (int i = 0; i < _numErrors; i++) {</xmp></same><same><xmp>         buf.append(_errors[i].toString());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public String getEnclosingClassName(int pos, boolean qual) throws BadLocationException, ClassNameNotFoundException {</xmp></same><diff_remove><xmp>-    StringBuffer keyBuf = new StringBuffer("getEnclosingClassName:").append(pos);</xmp></diff_remove><diff_add><xmp>+    final StringBuilder keyBuf = new StringBuilder("getEnclosingClassName:").append(pos);</xmp></diff_add><same><xmp>     keyBuf.append(":").append(qual);</xmp></same><same><xmp>     String key = keyBuf.toString();</xmp></same><same><xmp>     String cached = ((String) (_checkCache(key)));</xmp></same><desc>============================其他============================</desc></br><prompt>drjava-ID-107  其他 (1/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,23 +1,24 @@</xmp></diff_header><same><xmp> @Override</xmp></same><same><xmp> public Type visit(SimpleFieldAccess node) {</xmp></same><same><xmp>     try {</xmp></same><diff_remove><xmp>-        Type t = context.typeContainingField(node.getFieldName(), ts);</xmp></diff_remove><diff_add><xmp>+        ClassType t = context.typeContainingField(node.getFieldName(), ts);</xmp></diff_add><same><xmp>         if (t == null) {</xmp></same><same><xmp>             setErrorStrings(node, node.getFieldName());</xmp></same><same><xmp>             throw new ExecutionError("undefined.name", node);</xmp></same><same><xmp>         }</xmp></same><same><xmp>         TypeSystem.FieldReference ref;</xmp></same><diff_remove><xmp>-        DJClass thisC = context.getThis();</xmp></diff_remove><diff_remove><xmp>-        if (thisC == null) {</xmp></diff_remove><diff_add><xmp>+        if (context.getThis() == null) {</xmp></diff_add><same><xmp>             ref = ts.lookupStaticField(t, node.getFieldName());</xmp></same><same><xmp>         } else {</xmp></same><diff_remove><xmp>-            setDJClass(node, thisC);</xmp></diff_remove><same><xmp>             Expression obj = TypeUtil.makeEmptyExpression(node);</xmp></same><same><xmp>             setType(obj, t);</xmp></same><same><xmp>             ref = ts.lookupField(obj, node.getFieldName());</xmp></same><same><xmp>         }</xmp></same><same><xmp>         setField(node, ref.field());</xmp></same><same><xmp>         setVariableType(node, ref.type());</xmp></same><diff_add><xmp>+        if (!ref.field().isStatic()) {</xmp></diff_add><diff_add><xmp>+            setDJClass(node, t.ofClass());</xmp></diff_add><diff_add><xmp>+        }</xmp></diff_add><same><xmp>         Type result = ts.capture(ref.type());</xmp></same><same><xmp>         addRuntimeCheck(node, result, ref.field().type());</xmp></same><same><xmp>         return setType(node, result);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,7 +8,7 @@</xmp></diff_header><same><xmp>         e.acceptVisitor(this);</xmp></same><same><xmp>     }</xmp></same><same><xmp>     Iterable<Type> targs = IterUtil.empty();</xmp></same><diff_remove><xmp>-    Type t;</xmp></diff_remove><diff_add><xmp>+    ClassType t;</xmp></diff_add><same><xmp>     if (context.localFunctionExists(node.getMethodName(), ts)) {</xmp></same><same><xmp>         Iterable<LocalFunction> matches = context.getLocalFunctions(node.getMethodName(), ts);</xmp></same><same><xmp>         t = ts.makeClassType(new FunctionWrapperClass(matches));</xmp></same><diff_header><xmp>@@ -25,11 +25,9 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         TypeSystem.MethodInvocation inv;</xmp></same><diff_remove><xmp>-        DJClass thisC = context.getThis();</xmp></diff_remove><diff_remove><xmp>-        if (thisC == null) {</xmp></diff_remove><diff_add><xmp>+        if (context.getThis() == null) {</xmp></diff_add><same><xmp>             inv = ts.lookupStaticMethod(t, node.getMethodName(), targs, args);</xmp></same><same><xmp>         } else {</xmp></same><diff_remove><xmp>-            setDJClass(node, thisC);</xmp></diff_remove><same><xmp>             Expression obj = TypeUtil.makeEmptyExpression(node);</xmp></same><same><xmp>             setType(obj, t);</xmp></same><same><xmp>             inv = ts.lookupMethod(obj, node.getMethodName(), targs, args);</xmp></same><diff_header><xmp>@@ -37,6 +35,9 @@</xmp></diff_header><same><xmp>         checkThrownExceptions(inv.thrown(), node);</xmp></same><same><xmp>         node.setArguments(IterUtil.asList(inv.args()));</xmp></same><same><xmp>         setMethod(node, inv.method());</xmp></same><diff_add><xmp>+        if (!inv.method().isStatic()) {</xmp></diff_add><diff_add><xmp>+            setDJClass(node, t.ofClass());</xmp></diff_add><diff_add><xmp>+        }</xmp></diff_add><same><xmp>         Type result = ts.capture(inv.returnType());</xmp></same><same><xmp>         debug.logValue("Type of method call " + node.getMethodName(), ts.wrap(result));</xmp></same><same><xmp>         addRuntimeCheck(node, result, inv.method().returnType());</xmp></same><prompt>drjava-ID-174  其他 (2/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,5 @@</xmp></diff_header><same><xmp> public void testCompileWithJavaAssert() throws BadLocationException, IOException, InterruptedException {</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(false);</xmp></diff_add><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_WITH_ASSERT);</xmp></same><same><xmp>     final File file = tempFile();</xmp></same><same><xmp>     doc.saveFile(new FileSelector(file));</xmp></same><diff_header><xmp>@@ -13,14 +14,11 @@</xmp></diff_header><same><xmp>     String version = System.getProperty("java.version");</xmp></same><same><xmp>     if ((version != null) && ("1.4.0".compareTo(version) <= 0)) {</xmp></same><same><xmp>         DrJava.getConfig().setSetting(JAVAC_ALLOW_ASSERT, new Boolean(true));</xmp></same><diff_remove><xmp>-        CompileShouldSucceedListener listener2 = new CompileShouldSucceedListener();</xmp></diff_remove><diff_add><xmp>+        CompileShouldSucceedListener listener2 = new CompileShouldSucceedListener(false);</xmp></diff_add><same><xmp>         _model.addListener(listener2);</xmp></same><diff_remove><xmp>-        synchronized(listener2) {</xmp></diff_remove><diff_remove><xmp>-            doc.startCompile();</xmp></diff_remove><diff_remove><xmp>-            if (_model.getNumErrors() > 0) {</xmp></diff_remove><diff_remove><xmp>-                fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_remove><diff_remove><xmp>-            }</xmp></diff_remove><diff_remove><xmp>-            listener2.wait();</xmp></diff_remove><diff_add><xmp>+        doc.startCompile();</xmp></diff_add><diff_add><xmp>+        if (_model.getNumErrors() > 0) {</xmp></diff_add><diff_add><xmp>+            fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         _model.removeListener(listener2);</xmp></same><same><xmp>         assertCompileErrorsPresent(_name(), false);</xmp></same><diff_header><xmp>@@ -28,4 +26,5 @@</xmp></diff_header><same><xmp>         compiled = classForJava(file, "DrJavaTestFoo");</xmp></same><same><xmp>         assertTrue(_name() + "Class file doesn't exist after compile", compiled.exists());</xmp></same><same><xmp>     }</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(true);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,16 +1,14 @@</xmp></diff_header><same><xmp> public void testClassFileSynchronization() throws BadLocationException, IOException, InterruptedException {</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(false);</xmp></diff_add><same><xmp>     final OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     final File file = tempFile();</xmp></same><same><xmp>     doc.saveFile(new FileSelector(file));</xmp></same><diff_remove><xmp>-    CompileShouldSucceedListener listener = new CompileShouldSucceedListener();</xmp></diff_remove><diff_add><xmp>+    CompileShouldSucceedListener listener = new CompileShouldSucceedListener(false);</xmp></diff_add><same><xmp>     _model.addListener(listener);</xmp></same><same><xmp>     assertTrue("should not be in sync before compile", !doc.checkIfClassFileInSync());</xmp></same><diff_remove><xmp>-    synchronized(listener) {</xmp></diff_remove><diff_remove><xmp>-        doc.startCompile();</xmp></diff_remove><diff_remove><xmp>-        if (_model.getNumErrors() > 0) {</xmp></diff_remove><diff_remove><xmp>-            fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_remove><diff_remove><xmp>-        }</xmp></diff_remove><diff_remove><xmp>-        listener.wait();</xmp></diff_remove><diff_add><xmp>+    doc.startCompile();</xmp></diff_add><diff_add><xmp>+    if (_model.getNumErrors() > 0) {</xmp></diff_add><diff_add><xmp>+        fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _model.removeListener(listener);</xmp></same><same><xmp>     listener.checkCompileOccurred();</xmp></same><diff_header><xmp>@@ -22,4 +20,5 @@</xmp></diff_header><same><xmp>     assertTrue("should not be in sync after save", !doc.checkIfClassFileInSync());</xmp></same><same><xmp>     File compiled = classForJava(file, "DrJavaTestFoo");</xmp></same><same><xmp>     assertTrue(_name() + " Class file should exist after compile", compiled.exists());</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(true);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,17 +1,15 @@</xmp></diff_header><same><xmp> public void testClassFileSynchronizationAfterRename() throws BadLocationException, IOException, IllegalStateException, InterruptedException {</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(false);</xmp></diff_add><same><xmp>     final OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     final File file = tempFile();</xmp></same><same><xmp>     final File file2 = tempFile(2);</xmp></same><same><xmp>     doc.saveFile(new FileSelector(file));</xmp></same><diff_remove><xmp>-    CompileShouldSucceedListener listener = new CompileShouldSucceedListener();</xmp></diff_remove><diff_add><xmp>+    CompileShouldSucceedListener listener = new CompileShouldSucceedListener(false);</xmp></diff_add><same><xmp>     _model.addListener(listener);</xmp></same><same><xmp>     assertTrue("should not be in sync before compile", !doc.checkIfClassFileInSync());</xmp></same><diff_remove><xmp>-    synchronized(listener) {</xmp></diff_remove><diff_remove><xmp>-        doc.startCompile();</xmp></diff_remove><diff_remove><xmp>-        if (_model.getNumErrors() > 0) {</xmp></diff_remove><diff_remove><xmp>-            fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_remove><diff_remove><xmp>-        }</xmp></diff_remove><diff_remove><xmp>-        listener.wait();</xmp></diff_remove><diff_add><xmp>+    doc.startCompile();</xmp></diff_add><diff_add><xmp>+    if (_model.getNumErrors() > 0) {</xmp></diff_add><diff_add><xmp>+        fail("compile failed: " + doc.getCompilerErrorModel());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _model.removeListener(listener);</xmp></same><same><xmp>     listener.checkCompileOccurred();</xmp></same><diff_header><xmp>@@ -19,4 +17,5 @@</xmp></diff_header><same><xmp>     Thread.sleep(1000);</xmp></same><same><xmp>     doc.saveFileAs(new FileSelector(file2));</xmp></same><same><xmp>     assertTrue("should not be in sync after renaming", !doc.checkIfClassFileInSync());</xmp></same><diff_add><xmp>+    _model.setResetAfterCompile(true);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-238  其他 (3/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -7,12 +7,7 @@</xmp></diff_header><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("/", "/*", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("/", "//", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("*/")) {</xmp></same><same><xmp>         _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,12 +4,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("\n")) {</xmp></same><same><xmp>         copyCursor.current().setState(FREE);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,12 +6,7 @@</xmp></diff_header><same><xmp>     _combineCurrentAndNextIfFind("*", "//", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("*", "/*", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     _splitCurrentIfCommentBlock(false, false, copyCursor);</xmp></same><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("*/")) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,12 +4,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("\n")) {</xmp></same><same><xmp>         copyCursor.current().setState(FREE);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,12 +4,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("\n")) {</xmp></same><same><xmp>         copyCursor.current().setState(FREE);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,12 +4,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("\n")) {</xmp></same><same><xmp>         copyCursor.current().setState(FREE);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,12 +6,7 @@</xmp></diff_header><same><xmp>     _combineCurrentAndNextIfFind("*", "//", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("*", "/*", copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     _splitCurrentIfCommentBlock(false, false, copyCursor);</xmp></same><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("*/")) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,12 +4,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     _splitCurrentIfCommentBlock(true, false, copyCursor);</xmp></same><same><xmp>     _combineCurrentAndNextIfFind("", "", copyCursor);</xmp></same><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\"", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\'", copyCursor);</xmp></diff_remove><diff_remove><xmp>-    _combineCurrentAndNextIfFind("\\", "\\\\", copyCursor);</xmp></diff_remove><diff_add><xmp>+    _combineCurrentAndNextIfEscape(copyCursor);</xmp></diff_add><same><xmp>     String type = copyCursor.current().getType();</xmp></same><same><xmp>     if (type.equals("\n")) {</xmp></same><same><xmp>         copyCursor.current().setState(FREE);</xmp></same><prompt>drjava-ID-239  其他 (4/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,9 +4,11 @@</xmp></diff_header><same><xmp>         System.out.println("Shutting down...");</xmp></same><same><xmp>     }</xmp></same><same><xmp>     synchronized(_notifierLock) {</xmp></same><diff_add><xmp>+        _setPendingNotifies(1);</xmp></diff_add><same><xmp>         _debugger.shutdown();</xmp></same><diff_remove><xmp>-        _waitForNotifies(1);</xmp></diff_remove><diff_remove><xmp>-        _notifierLock.wait();</xmp></diff_remove><diff_add><xmp>+        while (_pendingNotifies > 0) {</xmp></diff_add><diff_add><xmp>+            _notifierLock.wait();</xmp></diff_add><diff_add><xmp>+        } </xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     if (printMessages) {</xmp></same><same><xmp>         System.out.println("Shut down.");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -10,9 +10,11 @@</xmp></diff_header><same><xmp>     };</xmp></same><same><xmp>     _model.addListener(interpretListener);</xmp></same><same><xmp>     synchronized(_notifierLock) {</xmp></same><diff_add><xmp>+        _setPendingNotifies(2);</xmp></diff_add><same><xmp>         _debugger.shutdown();</xmp></same><diff_remove><xmp>-        _waitForNotifies(2);</xmp></diff_remove><diff_remove><xmp>-        _notifierLock.wait();</xmp></diff_remove><diff_add><xmp>+        while (_pendingNotifies > 0) {</xmp></diff_add><diff_add><xmp>+            _notifierLock.wait();</xmp></diff_add><diff_add><xmp>+        } </xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     interpretListener.assertInteractionEndCount(1);</xmp></same><same><xmp>     interpretListener.assertInterpreterChangedCount(1);</xmp></same><prompt>drjava-ID-240  其他 (5/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,3 @@</xmp></diff_header><same><xmp> public void systemErrPrint(final String s) {</xmp></same><diff_remove><xmp>-    Utilities.invokeLater(new Runnable() {</xmp></diff_remove><diff_remove><xmp>-        public void run() {</xmp></diff_remove><diff_remove><xmp>-            _docAppend(_consoleDoc, s, SYSTEM_ERR_STYLE);</xmp></diff_remove><diff_remove><xmp>-        }</xmp></diff_remove><diff_remove><xmp>-    });</xmp></diff_remove><diff_add><xmp>+    _docAppend(_consoleDoc, s, SYSTEM_ERR_STYLE);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,3 @@</xmp></diff_header><same><xmp> public void systemOutPrint(final String s) {</xmp></same><diff_remove><xmp>-    Utilities.invokeLater(new Runnable() {</xmp></diff_remove><diff_remove><xmp>-        public void run() {</xmp></diff_remove><diff_remove><xmp>-            _docAppend(_consoleDoc, s, SYSTEM_OUT_STYLE);</xmp></diff_remove><diff_remove><xmp>-        }</xmp></diff_remove><diff_remove><xmp>-    });</xmp></diff_remove><diff_add><xmp>+    _docAppend(_consoleDoc, s, SYSTEM_OUT_STYLE);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,3 @@</xmp></diff_header><same><xmp> public void systemInEcho(final String s) {</xmp></same><diff_remove><xmp>-    Utilities.invokeLater(new Runnable() {</xmp></diff_remove><diff_remove><xmp>-        public void run() {</xmp></diff_remove><diff_remove><xmp>-            _docAppend(_consoleDoc, s, SYSTEM_IN_STYLE);</xmp></diff_remove><diff_remove><xmp>-        }</xmp></diff_remove><diff_remove><xmp>-    });</xmp></diff_remove><diff_add><xmp>+    _docAppend(_consoleDoc, s, SYSTEM_IN_STYLE);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-271  其他 (6/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public String toStringHelper() {</xmp></same><diff_remove><xmp>-    return (((((((((Modifier.toString(getAccessFlags()) + " ") + getName()) + " ") + getParameters()) + " ") + getExceptions()) + " ") + getConstructorCall()) + " ") + getStatements();</xmp></diff_remove><diff_add><xmp>+    return (((((((((getModifiers() + " ") + getName()) + " ") + getParameters()) + " ") + getExceptions()) + " ") + getConstructorCall()) + " ") + getStatements();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> protected String toStringHelper() {</xmp></same><diff_remove><xmp>-    return (((((Modifier.toString(getAccessFlags()) + " ") + getName()) + " ") + getInterfaces()) + " ") + getMembers();</xmp></diff_remove><diff_add><xmp>+    return (((((getModifiers() + " ") + getName()) + " ") + getInterfaces()) + " ") + getMembers();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> protected String toStringHelper() {</xmp></same><diff_remove><xmp>-    return (((((Modifier.toString(getAccessFlags()) + " ") + getName()) + " ") + getInterfaces()) + " ") + getMembers();</xmp></diff_remove><diff_add><xmp>+    return (((((getModifiers() + " ") + getName()) + " ") + getInterfaces()) + " ") + getMembers();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> public String toStringHelper() {</xmp></same><diff_remove><xmp>-    return (((((((((Modifier.toString(getAccessFlags()) + " ") + getReturnType()) + " ") + getName()) + " ") + getParameters()) + " ") + getExceptions()) + " ") + getBody();</xmp></diff_remove><diff_add><xmp>+    return (((((((((getModifiers() + " ") + getReturnType()) + " ") + getName()) + " ") + getParameters()) + " ") + getExceptions()) + " ") + getBody();</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-278  其他 (7/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -10,10 +10,11 @@</xmp></diff_header><same><xmp>         }</xmp></same><same><xmp>     } while (posInParenPhrase(prevDelimiter) );</xmp></same><same><xmp>     int nextNonWSChar;</xmp></same><diff_add><xmp>+    char[] whitespace = new char[]{ ' ', '\t', '\n', ',' };</xmp></diff_add><same><xmp>     if (reachedStart) {</xmp></same><same><xmp>         nextNonWSChar = getFirstNonWSCharPos(DOCSTART);</xmp></same><same><xmp>     } else {</xmp></same><diff_remove><xmp>-        nextNonWSChar = getFirstNonWSCharPos(prevDelimiter + 1);</xmp></diff_remove><diff_add><xmp>+        nextNonWSChar = getFirstNonWSCharPos(prevDelimiter + 1, whitespace);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     if (nextNonWSChar == ERROR_INDEX) {</xmp></same><same><xmp>         nextNonWSChar = getLength();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,5 @@</xmp></diff_header><same><xmp> public String getIndentOfCurrStmt(int pos) throws BadLocationException {</xmp></same><same><xmp>     char[] delims = new char[]{ ';', '{', '}' };</xmp></same><diff_remove><xmp>-    return getIndentOfCurrStmt(pos, delims);</xmp></diff_remove><diff_add><xmp>+    char[] whitespace = new char[]{ ' ', '\t', '\n', ',' };</xmp></diff_add><diff_add><xmp>+    return getIndentOfCurrStmt(pos, delims, whitespace);</xmp></diff_add><same><xmp> }</xmp></same><prompt>drjava-ID-7  其他 (8/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -16,4 +16,5 @@</xmp></diff_header><same><xmp>     ourMap.addActionForKeyStroke(KeyStroke.getKeyStroke(KeyEvent.VK_KP_RIGHT, 0), _moveRight);</xmp></same><same><xmp>     ourMap.addActionForKeyStroke(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0), _moveRight);</xmp></same><same><xmp>     setKeymap(ourMap);</xmp></same><diff_add><xmp>+    getDocument().addDocumentListener(new CaretUpdateListener());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,7 @@</xmp></diff_header><same><xmp> public InteractionsPane(GlobalModel model) {</xmp></same><same><xmp>     super(model.getInteractionsDocument());</xmp></same><same><xmp>     _model = model;</xmp></same><diff_add><xmp>+    getDocument().addDocumentListener(new ScrollToEndDocumentListener());</xmp></diff_add><same><xmp>     int mask = Toolkit.getDefaultToolkit().getMenuShortcutKeyMask();</xmp></same><same><xmp>     Keymap ourMap = addKeymap("INTERACTIONS_KEYMAP", getKeymap());</xmp></same><same><xmp>     ourMap.addActionForKeyStroke(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), _evalAction);</xmp></same><prompt>drjava-ID-163  其他 (9/9) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void testCannotEditBeforePrompt() throws EditDocumentException {</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     int origLength = 0;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         origLength = _doc.getLength();</xmp></same><same><xmp>         _doc.insertText(1, "typed text", DEFAULT_STYLE);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals("Document should not have changed.", origLength, _doc.getLength());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testGetColumn2() throws BadLocationException {</xmp></same><same><xmp>     final String s = "1234567890\n1234\n12345";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, s, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 5, defModel.getCurrentCol());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, s, null);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 5, _defModel.getCurrentCol());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testUncommentSingleLine() throws BadLocationException {</xmp></same><same><xmp>     String text = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "//         System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></same><diff_remove><xmp>-    String uncommented = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></diff_remove><diff_add><xmp>+    String uncommented = ((("// // Here is some abritrary text that should be uncommented.\n" + "// /* along with a little bit of code, just to spice\n") + "      //* things up.\n") + "//                    */ \n") + "         System.out.println(\"Aren\'t comments fun? // (yeah!)\")";</xmp></diff_add><same><xmp>     doc.insertString(0, text, null);</xmp></same><same><xmp>     _assertContents("Sample text is inserted improperly.", text, doc);</xmp></same><same><xmp>     doc.uncommentLines(doc.getLength() - 1, doc.getLength());</xmp></same><diff_remove><xmp>-    _assertContents("The last line should be indented and have no commenting!", uncommented, doc);</xmp></diff_remove><diff_add><xmp>+    _assertContents("The last line should have no commenting!", uncommented, doc);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,9 +5,11 @@</xmp></diff_header><same><xmp>         }</xmp></same><same><xmp>     });</xmp></same><same><xmp>     DrJava.getConfig().setSetting(ALLOW_PRIVATE_ACCESS, Boolean.valueOf(false));</xmp></same><diff_add><xmp>+    Utilities.clearEventQueue();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _interpreter.interpret("class A { private int i = 0; }");</xmp></same><same><xmp>         _interpreter.interpret("new A().i");</xmp></same><diff_add><xmp>+        System.err.println("Private access erroneously succeeded");</xmp></diff_add><same><xmp>         fail("Should not have access to the private field i inside class A.");</xmp></same><same><xmp>     } catch (ExceptionReturnedException ere) {</xmp></same><same><xmp>         assertTrue(ere.getContainedException() instanceof IllegalAccessException);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offs = _document.getLength();</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.insertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,12 +6,12 @@</xmp></diff_header><same><xmp>     File tempDir = new File(tempPath);</xmp></same><same><xmp>     tempDir.renameTo(new File(tempPath + "a"));</xmp></same><same><xmp>     String result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></same><diff_remove><xmp>-    assertTrue("interactions should have an error, not the correct answer", !"DrJavaTestFoo".equals(result));</xmp></diff_remove><diff_add><xmp>+    assertTrue("interactions should have an error, not the correct answer", !"\"DrJavaTestFoo\"".equals(result));</xmp></diff_add><same><xmp>     Vector<File> cp = new Vector<File>();</xmp></same><same><xmp>     cp.addElement(new File(tempPath + "a"));</xmp></same><same><xmp>     DrJava.getConfig().setSetting(EXTRA_CLASSPATH, cp);</xmp></same><same><xmp>     result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></same><diff_remove><xmp>-    assertEquals("interactions result", "DrJavaTestFoo", result);</xmp></diff_remove><diff_add><xmp>+    assertEquals("interactions result", "\"DrJavaTestFoo\"", result);</xmp></diff_add><same><xmp>     tempDir = new File(tempPath + "a");</xmp></same><same><xmp>     tempDir.renameTo(new File(tempPath));</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     String[] inputs = new String[]{ "\ttoken = nextToken(); // read trailing parenthesis\n", "\tif (token != \')\')\n", "\t  throw new ParseException(\"wrong number of arguments to |\");\n" };</xmp></same><same><xmp>     String expected = (" token = nextToken(); // read trailing parenthesis\n" + " if (token != \')\')\n") + "   throw new ParseException(\"wrong number of arguments to |\");\n";</xmp></same><same><xmp>     for (int i = 0; i < inputs.length; i++) {</xmp></same><diff_remove><xmp>-        defModel.insertString(defModel.getLength(), inputs[i], null);</xmp></diff_remove><diff_add><xmp>+        _defModel.insertString(_defModel.getLength(), inputs[i], null);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals(expected, _getAllText());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, AttributeSet set) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         insertString(getLength(), str, set);</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void remove(final int offset, final int len) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             clearCache();</xmp></same><same><xmp>             super.remove(offset, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testMultiplyingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) * new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_189() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_197() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RPAREN)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_133() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_135() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_277() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_328() {</xmp></diff_add><same><xmp>     if (jj_scan_token(STAR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void clearHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.clear();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_279() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_330() {</xmp></diff_add><same><xmp>     if (jj_scan_token(REMAINDER_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_270() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_278() {</xmp></diff_add><same><xmp>     if (jj_scan_token(PLUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testWillLoadClassFromGivenURLs() throws Throwable {</xmp></same><diff_remove><xmp>-    String logResource = "com/sun/tools/javac/util/Log.class";</xmp></diff_remove><diff_remove><xmp>-    String compilerClass = "com.sun.tools.javac.util.Context";</xmp></diff_remove><diff_add><xmp>+    String logResource = "com/sun/tools/javac/Main.class";</xmp></diff_add><diff_add><xmp>+    String compilerClass = "com.sun.tools.javac.Main";</xmp></diff_add><same><xmp>     URL[] urls = ToolsJarClassLoader.getToolsJarURLs();</xmp></same><same><xmp>     if (urls.length > 0) {</xmp></same><same><xmp>         StrictURLClassLoader loader = new StrictURLClassLoader(urls);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, DEFAULT_STYLE);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public int uncommentLines(int selStart, int selEnd) {</xmp></same><same><xmp>     int toReturn = selEnd;</xmp></same><same><xmp>     if (selStart == selEnd) {</xmp></same><diff_remove><xmp>-        modifyLock();</xmp></diff_remove><diff_add><xmp>+        acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             synchronized(_reduced) {</xmp></same><same><xmp>                 setCurrentLocation(selStart);</xmp></same><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>         } catch (BadLocationException e) {</xmp></same><same><xmp>             throw new UnexpectedException(e);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         toReturn = _uncommentBlock(selStart, selEnd);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void remove(int offs, int len) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canRemoveText(offs)) {</xmp></same><same><xmp>             super.remove(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     javacLoc.setFileFilter(ONLY);</xmp></same><same><xmp>     addOptionComponent(panel, javacLoc);</xmp></same><same><xmp>     addOptionComponent(panel, new VectorFileOptionComponent(OptionConstants.EXTRA_CLASSPATH, "Extra Classpath", this, "<html>Any directories or jar files to add to the classpath<br>" + "of the Compiler and Interactions Pane.</html>"));</xmp></same><diff_remove><xmp>-    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.STICKY_INTERACTIONS_DIRECTORY, "Restore last working directory of the Interactions pane on startUp", this, ((("<html>Whether to restore the last working directory of the Interaction pane on startUp,<br>" + "or to always use the value of the \"user.home\" Java property<br>") + "(currently ") + System.getProperty("user.home")) + ")."));</xmp></diff_remove><diff_add><xmp>+    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.STICKY_INTERACTIONS_DIRECTORY, "Restore last working directory of the Interactions pane on start up", this, ((("<html>Whether to restore the last working directory of the Interaction pane on start up,<br>" + "or to always use the value of the \"user.home\" Java property<br>") + "(currently ") + System.getProperty("user.home")) + ")."));</xmp></diff_add><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _styleChanged() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int length = getLength() - _currentLocation;</xmp></same><same><xmp>         DocumentEvent evt = new DefaultDocumentEvent(_currentLocation, length, DocumentEvent.EventType.CHANGE);</xmp></same><same><xmp>         fireChangedUpdate(evt);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_266() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_274() {</xmp></diff_add><same><xmp>     if (jj_scan_token(ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,12 +3,12 @@</xmp></diff_header><same><xmp>     TypeData sd = bb1.visit(_bbtc);</xmp></same><same><xmp>     assertEquals("There should be one error", 1, errors.size());</xmp></same><same><xmp>     assertEquals("Should return boolean type", BOOLEAN_TYPE.getInstanceData(), sd);</xmp></same><diff_remove><xmp>-    assertEquals("Error message should be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\".", errors.get(0).getFirst());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Error message should be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\"", errors.get(0).getFirst());</xmp></diff_add><same><xmp>     BracedBody bb2 = new BracedBody(SourceInfo.NO_INFO, new BodyItemI[]{ new ValueReturnStatement(SourceInfo.NO_INFO, new CharLiteral(SourceInfo.NO_INFO, 'c')) });</xmp></same><same><xmp>     sd = bb2.visit(_bbtc);</xmp></same><same><xmp>     assertEquals("There should be still be one error", 1, errors.size());</xmp></same><same><xmp>     assertEquals("Should return char type", CHAR_TYPE.getInstanceData(), sd);</xmp></same><diff_remove><xmp>-    assertEquals("Error message should still be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\".", errors.get(0).getFirst());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Error message should still be correct", "This method expected to return type: \"int\" but here returned type: \"boolean\"", errors.get(0).getFirst());</xmp></diff_add><same><xmp>     _bbtc._bodyData = _bd2;</xmp></same><same><xmp>     BracedBody bb3 = new BracedBody(SourceInfo.NO_INFO, new BodyItemI[]{ new ValueReturnStatement(SourceInfo.NO_INFO, new IntegerLiteral(SourceInfo.NO_INFO, 1)) });</xmp></same><same><xmp>     sd = bb3.visit(_bbtc);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testGreaterThanEqual() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Float(1) >= new Float(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Float) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Float) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Float) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: floatValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Float) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testGreaterThan() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Double(1) > new Double(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Double) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Double) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Double) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: doubleValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Double) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_114() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_501() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_499()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseAnd() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) & new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_419() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_429() {</xmp></diff_add><same><xmp>     if (jj_scan_token(EXTENDS)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_432()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         append(((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -45,6 +45,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> private static boolean _userWantsToPickAgain() {</xmp></same><diff_remove><xmp>-    final String[] text = new String[]{ "The file you chose did not appear to be a valid 'tools.jar'. ", "Would you like to pick again? The 'tools.jar' file is ", "generally located in the 'lib' subdirectory under your ", "JDK installation directory.", "(If you say 'No', DrJava might be unable to compile or ", "debug programs.)" };</xmp></diff_remove><diff_add><xmp>+    final String[] text = new String[]{ "The file you chose did not appear to be a valid 'tools.jar'. ", "(Your choice might be an incompatible version of the file.) ", "Would you like to pick again?  The 'tools.jar' file is ", "generally located in the 'lib' subdirectory under your ", "JDK installation directory.", "(If you say 'No', DrJava might be unable to compile or ", "debug programs.)" };</xmp></diff_add><same><xmp>     int result = JOptionPane.showConfirmDialog(null, text, "Locate 'tools.jar'?", JOptionPane.YES_NO_OPTION);</xmp></same><same><xmp>     return result == JOptionPane.YES_OPTION;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         append(((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -45,6 +45,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testGetPackageNameWithPackageStatementAfterImport() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String text = "import java.util.*;\npackage junk;\nclass Foo {}";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, text, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Package name for text with package statement after import", "", defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, text, null);</xmp></diff_add><diff_add><xmp>+    assertEquals("Package name for text with package statement after import", "", _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> protected void _setPendingNotifies(int n) throws InterruptedException {</xmp></same><same><xmp>     synchronized(_notifierLock) {</xmp></same><diff_remove><xmp>-        _log.log(("waiting for " + n) + " notifications...");</xmp></diff_remove><diff_add><xmp>+        _log.log(("Waiting for " + n) + " notifications ...");</xmp></diff_add><same><xmp>         _pendingNotifies = n;</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reverseSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             reverseHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -4,7 +4,7 @@</xmp></diff_header><same><xmp>     panel.addComponent(new FontOptionComponent(OptionConstants.FONT_DOCLIST, "Document List Font", this, "The font used in the list of open documents."));</xmp></same><same><xmp>     panel.addComponent(new FontOptionComponent(OptionConstants.FONT_TOOLBAR, "Toolbar Font", this, "The font used in the toolbar buttons."));</xmp></same><same><xmp>     if (CodeStatus.DEVELOPMENT) {</xmp></same><diff_remove><xmp>-        panel.addComponent(new BooleanOptionComponent(OptionConstants.TEXT_ANTIALIAS, "Use anti-aliased text in Definitions", this, "Whether to graphically smooth the text in the Definitions Pane."));</xmp></diff_remove><diff_add><xmp>+        panel.addComponent(new BooleanOptionComponent(OptionConstants.TEXT_ANTIALIAS, "Use anti-aliased text", this, "Whether to graphically smooth the text."));</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private static void _showErrorMessage(String cause, Throwable t) {</xmp></same><diff_remove><xmp>-    String msg = (("An error occurred while starting the slave JVM:\n  " + cause) + "\n\nOriginal error:\n") + StringOps.getStackTrace(t);</xmp></diff_remove><diff_remove><xmp>-    _log.log((("ERROR in Slave JVM Runner: " + cause) + "; threw ") + t);</xmp></diff_remove><diff_add><xmp>+    String msg = (("An error occurred in SlaveJVMRunner while starting the slave JVM:\n  " + cause) + "\n\nOriginal error:\n") + StringOps.getStackTrace(t);</xmp></diff_add><diff_add><xmp>+    _log.log((("ERROR in SlaveJVMRunner: " + cause) + "; threw ") + t);</xmp></diff_add><same><xmp>     if (SHOW_DEBUG_DIALOGS) {</xmp></same><same><xmp>         new ScrollableDialog(null, "Error", "Error details:", msg).show();</xmp></same><same><xmp>     } else if (!Utilities.TEST_MODE) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_177() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_185() {</xmp></diff_add><same><xmp>     if (jj_scan_token(THROW)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(SEMICOLON)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_571() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_574() {</xmp></diff_add><same><xmp>     if (jj_scan_token(CASE)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testLessThanEqual() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(12) <= new Integer(32);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertNewLine(int pos) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int len = _document.getLength();</xmp></same><same><xmp>         if (pos > len) {</xmp></same><diff_header><xmp>@@ -12,6 +12,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>             _document.insertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private int _commentBlock(final int start, final int end) {</xmp></same><same><xmp>     int afterCommentEnd = end;</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         final Position endPos = this.createPosition(end);</xmp></same><same><xmp>         int walker = start;</xmp></same><diff_header><xmp>@@ -18,7 +18,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     return afterCommentEnd;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void testInteractionsCanSeeChangedClass() throws BadLocationException, IOException {</xmp></same><diff_remove><xmp>-    final String text_before = "class Foo { public int m() { return ";</xmp></diff_remove><diff_add><xmp>+    final String text_before = "class DrJavaTestFoo { public int m() { return ";</xmp></diff_add><same><xmp>     final String text_after = "; } }";</xmp></same><same><xmp>     final int num_iterations = 5;</xmp></same><same><xmp>     File file;</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         doc = setupDocument((text_before + i) + text_after);</xmp></same><same><xmp>         file = tempFile(i);</xmp></same><same><xmp>         _doCompile(doc, file);</xmp></same><diff_remove><xmp>-        assertEquals("interactions result, i=" + i, String.valueOf(i), interpret("new Foo().m()"));</xmp></diff_remove><diff_add><xmp>+        assertEquals("interactions result, i=" + i, String.valueOf(i), interpret("new DrJavaTestFoo().m()"));</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,8 +2,8 @@</xmp></diff_header><same><xmp>     _setDocText("foo\nbar\nblah");</xmp></same><same><xmp>     assertEquals("Returns position after the previous newline", 4, _doc.getLineStartPos(6));</xmp></same><same><xmp>     assertEquals("Returns position after previous newline when cursor " + "is at the position after the previous newline", 4, _doc.getLineStartPos(4));</xmp></same><diff_remove><xmp>-    assertEquals("Returns DOCSTART when there's no previous newline", 0, _doc.getLineStartPos(2));</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Returns DOCSTART when the cursor is at DOCSTART", 0, _doc.getLineStartPos(0));</xmp></diff_remove><diff_add><xmp>+    assertEquals("Returns 0 when there's no previous newline", 0, _doc.getLineStartPos(2));</xmp></diff_add><diff_add><xmp>+    assertEquals("Returns 0 when the cursor is at 0", 0, _doc.getLineStartPos(0));</xmp></diff_add><same><xmp>     _setDocText("abcdefghijk");</xmp></same><same><xmp>     _doc.setCurrentLocation(3);</xmp></same><same><xmp>     int reducedModelPos = _doc.getReduced().absOffset();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,5 +8,5 @@</xmp></diff_header><same><xmp>     String text = "try { throw new FileNotFoundException(\"file not found\"); } catch (FileNotFoundException e) { } finally { System.out.println(\"Finished\"); }";</xmp></same><same><xmp>     Node stmt = _parseCode(text).get(0);</xmp></same><same><xmp>     stmt.acceptVisitor(disp);</xmp></same><diff_remove><xmp>-    compareFileToString(_tempFile, (((((((((((((((((((((((((((((((((((((((((((((((((("l.1 TryStatement {\n" + "tryBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ThrowStatement {\n") + "    expression:\n") + "      l.1 SimpleAllocation {\n") + "      creationType:\n") + "        l.1 ReferenceType {\n") + "        representation:\n") + "          FileNotFoundException\n") + "        }\n") + "      arguments:\n") + "        l.1 Literal (class java.lang.String) <file not found> {\n") + "        }\n") + "      }\n") + "    }\n") + "  }\n") + "catchStatements:\n") + "  l.1 CatchStatement {\n") + "  exception:\n") + "    l.1 FormalParameter {\n") + "    type:\n") + "      l.1 ReferenceType {\n") + "      representation:\n") + "        FileNotFoundException\n") + "      }\n") + "    name:\n") + "      e\n") + "    }\n") + "  block:\n") + "    l.1 BlockStatement {\n") + "    statements:\n") + "    }\n") + "  }\n") + "finallyBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ObjectMethodCall {\n") + "    expression:\n") + "      l.1 QualifiedName {\n") + "      representation:\n") + "        System.out\n") + "      }\n") + "    methodName:\n") + "      println\n") + "    arguments:\n") + "      l.1 Literal (class java.lang.String) <Finished> {\n") + "      }\n") + "    }\n") + "  }\n") + "}");</xmp></diff_remove><diff_add><xmp>+    compareFileToString(_tempFile, (((((((((((((((((((((((((((((((((((((((((((((((((("l.1 TryStatement {\n" + "tryBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ThrowStatement {\n") + "    expression:\n") + "      l.1 SimpleAllocation {\n") + "      creationType:\n") + "        l.1 ReferenceTypeName {\n") + "        representation:\n") + "          FileNotFoundException\n") + "        }\n") + "      arguments:\n") + "        l.1 Literal (class java.lang.String) <file not found> {\n") + "        }\n") + "      }\n") + "    }\n") + "  }\n") + "catchStatements:\n") + "  l.1 CatchStatement {\n") + "  exception:\n") + "    l.1 FormalParameter {\n") + "    type:\n") + "      l.1 ReferenceTypeName {\n") + "      representation:\n") + "        FileNotFoundException\n") + "      }\n") + "    name:\n") + "      e\n") + "    }\n") + "  block:\n") + "    l.1 BlockStatement {\n") + "    statements:\n") + "    }\n") + "  }\n") + "finallyBlock:\n") + "  l.1 BlockStatement {\n") + "  statements:\n") + "    l.1 ObjectMethodCall {\n") + "    expression:\n") + "      l.1 QualifiedName {\n") + "      representation:\n") + "        System.out\n") + "      }\n") + "    methodName:\n") + "      println\n") + "    arguments:\n") + "      l.1 Literal (class java.lang.String) <Finished> {\n") + "      }\n") + "    }\n") + "  }\n") + "}");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallNextInteractionInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             moveHistoryNext(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_278() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_329() {</xmp></diff_add><same><xmp>     if (jj_scan_token(SLASH_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_277() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_285() {</xmp></diff_add><same><xmp>     if (jj_scan_token(OR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void updateModifiedSinceSave() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _isModifiedSinceSave = _undoManager.isModified();</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if ((!_isModifiedSinceSave) && (_odd != null)) {</xmp></same><same><xmp>             _odd.documentReset();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_241() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_242() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_37()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     Token xsp;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forceInsertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.forceInsertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, OBJECT_RETURN_STYLE);</xmp></same><diff_header><xmp>@@ -9,6 +9,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void append(String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offs = _document.getLength();</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.insertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testRemoveTabs1() {</xmp></same><diff_remove><xmp>-    defModel.setIndent(1);</xmp></diff_remove><diff_add><xmp>+    _defModel.setIndent(1);</xmp></diff_add><same><xmp>     String test = "\t this \t\tis a \t\t\t\t\ttest\t\t";</xmp></same><diff_remove><xmp>-    String result = defModel._removeTabs(test);</xmp></diff_remove><diff_add><xmp>+    String result = _defModel._removeTabs(test);</xmp></diff_add><same><xmp>     assertEquals("  this   is a      test  ", result);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = ("package edu . rice\n./*comment!*/cs.drjava; \n" + " interface thisInterface { \n") + " class MyClass {";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_181() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_189() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RPAREN)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testParenthesizedAnonymousInnerClass() throws BadLocationException {</xmp></same><diff_remove><xmp>-    String text = ((("addActionListener(new ActionListener() {\n" + "public void actionPerformed(ActionEvent e) {\n") + "config.setSetting(LANGUAGE_LEVEL, DrJavaRoot.FULL_JAVA);\n") + "}});\n") + "group.add(rbMenuItem);\n";</xmp></diff_remove><diff_remove><xmp>-    String indented = ((("addActionListener(new ActionListener() {\n" + "  public void actionPerformed(ActionEvent e) {\n") + "    config.setSetting(LANGUAGE_LEVEL, DrJavaRoot.FULL_JAVA);\n") + "  }});\n") + "group.add(rbMenuItem);\n";</xmp></diff_remove><diff_add><xmp>+    String text = ((("addActionListener(new ActionListener() {\n" + "public void actionPerformed(ActionEvent e) {\n") + "config.setSetting(LANGUAGE_LEVEL, edu.rice.cs.drjava.config.OptionConstants.FULL_JAVA);\n") + "}});\n") + "group.add(rbMenuItem);\n";</xmp></diff_add><diff_add><xmp>+    String indented = ((("addActionListener(new ActionListener() {\n" + "  public void actionPerformed(ActionEvent e) {\n") + "    config.setSetting(LANGUAGE_LEVEL, edu.rice.cs.drjava.config.OptionConstants.FULL_JAVA);\n") + "  }});\n") + "group.add(rbMenuItem);\n";</xmp></diff_add><same><xmp>     _doc.insertString(0, text, null);</xmp></same><same><xmp>     _assertContents(text, _doc);</xmp></same><same><xmp>     safeIndentLines(0, _doc.getLength());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,7 +8,7 @@</xmp></diff_header><same><xmp>     if (jvmArgs.equals("") || (!called)) {</xmp></same><same><xmp>         _model.setOptionArgs(jvmArgs);</xmp></same><same><xmp>     } else {</xmp></same><diff_remove><xmp>-        String confirmMessage = (("Specifying the command-line arguments to the Interactions JVM is an\n" + "advanced option, and incorrect arguments may cause the Interactions\n") + "Pane to stop responding. Are you sure you want to set this option?\n") + "(You must reset the Interactions Pane before changes will take effect.)";</xmp></diff_remove><diff_add><xmp>+        String confirmMessage = (("Specifying the command-line arguments to the Interactions JVM is an\n" + "advanced option, and incorrect arguments may cause the Interactions\n") + "View to stop responding. Are you sure you want to set this option?\n") + "(You must reset the Interactions View before changes will take effect.)";</xmp></diff_add><same><xmp>         if (_view.showConfirmDialog("Setting JVM Arguments", confirmMessage)) {</xmp></same><same><xmp>             _model.setOptionArgs(jvmArgs);</xmp></same><same><xmp>         } else {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -26,7 +26,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     PredictiveInputModel<GoToFileListEntry> pim = new PredictiveInputModel<GoToFileListEntry>(true, new PredictiveInputModel.PrefixStrategy<GoToFileListEntry>(), list);</xmp></same><same><xmp>     OpenDefinitionsDocument odd = getCurrentDefPane().getOpenDefDocument();</xmp></same><diff_remove><xmp>-    odd.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    odd.modifyLock();</xmp></diff_add><same><xmp>     boolean uniqueMatch = true;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         String mask = "";</xmp></same><diff_header><xmp>@@ -82,7 +82,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException ble) {</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if (uniqueMatch) {</xmp></same><diff_remove><xmp>-            odd.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            odd.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,11 +8,11 @@</xmp></diff_header><same><xmp>     getErrorListPane().setFont(f);</xmp></same><same><xmp>     SwingDocument doc = ((SwingDocument) (getErrorListPane().getDocument()));</xmp></same><same><xmp>     if (doc instanceof SwingDocument) {</xmp></same><diff_remove><xmp>-        doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+        doc.modifyLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             ((SwingDocument) (doc)).setCharacterAttributes(0, doc.getLength() + 1, set, false);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            doc.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (_doc.getUndoableEditListeners().length == 0) {</xmp></same><same><xmp>         _resetUndo();</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     int len = _doc.getLength();</xmp></same><same><xmp>     if ((len < _position) || (len < _selEnd)) {</xmp></same><same><xmp>         _position = len;</xmp></same><diff_header><xmp>@@ -21,7 +21,7 @@</xmp></diff_header><same><xmp>             _doc.setCurrentLocation(_selEnd);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);</xmp></same><same><xmp>     _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forwardHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.forwardSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseXOr() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) ^ new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_267() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_275() {</xmp></diff_add><same><xmp>     if (jj_scan_token(STAR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testInteractionsCanSeeCompile() throws BadLocationException, IOException {</xmp></same><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     _doCompile(doc, tempFile());</xmp></same><diff_remove><xmp>-    String result = interpret("new Foo().getClass().getName()");</xmp></diff_remove><diff_remove><xmp>-    assertEquals("interactions result", "Foo", result);</xmp></diff_remove><diff_add><xmp>+    String result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></diff_add><diff_add><xmp>+    assertEquals("interactions result", "DrJavaTestFoo", result);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_287() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_338() {</xmp></diff_add><same><xmp>     if (jj_scan_token(OR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testPackageNameWeird2() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String weird = "package edu . rice //comment!\n.cs.drjava;";</xmp></same><same><xmp>     String normal = "edu.rice.cs.drjava";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("Package name for weird: '" + weird) + "'", normal, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("Package name for weird: '" + weird) + "'", normal, _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_187() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_195() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(RBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_173() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_177() {</xmp></diff_add><same><xmp>     if (jj_scan_token(THROW)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(SEMICOLON)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void reverseHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.reverseSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameWithClassloaderImport() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = "import classloader.class; class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for weird: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for weird: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -8,11 +8,11 @@</xmp></diff_header><same><xmp>     getErrorListPane().setFont(f);</xmp></same><same><xmp>     SwingDocument doc = ((SwingDocument) (getErrorListPane().getDocument()));</xmp></same><same><xmp>     if (doc instanceof SwingDocument) {</xmp></same><diff_remove><xmp>-        doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+        doc.acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             ((SwingDocument) (doc)).setCharacterAttributes(0, doc.getLength() + 1, set, false);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            doc.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,6 +2,6 @@</xmp></diff_header><same><xmp>     Object property = request.getProperty("debugAction");</xmp></same><same><xmp>     if ((property != null) && (property instanceof Breakpoint)) {</xmp></same><same><xmp>         Breakpoint breakpoint = ((Breakpoint) (property));</xmp></same><diff_remove><xmp>-        _model.printDebugMessage(((("Breakpoint hit in class " + breakpoint.getClassName()) + ", line ") + breakpoint.getLineNumber()) + ".");</xmp></diff_remove><diff_add><xmp>+        _model.printDebugMessage(((("Breakpoint hit in class " + breakpoint.getClassName()) + "  [line ") + breakpoint.getLineNumber()) + "]");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_273() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_281() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_SIGNED_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -10,7 +10,7 @@</xmp></diff_header><same><xmp>     if (makeBackup) {</xmp></same><same><xmp>         backup = fileSaver.getBackupFile();</xmp></same><same><xmp>         if (!renameFile(file, backup)) {</xmp></same><diff_remove><xmp>-            throw new IOException(("Save failed: Could not create backup file " + backup.getAbsolutePath()) + "\nIt may be possible to save by disabling file backups\n");</xmp></diff_remove><diff_add><xmp>+            throw new IOException(("Save failed. Could not create backup file " + backup.getAbsolutePath()) + "\nIt may be possible to save by disabling file backups\n");</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         fileSaver.backupDone();</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>@@ -33,7 +33,7 @@</xmp></diff_header><same><xmp>         bos.close();</xmp></same><same><xmp>         fos.close();</xmp></same><same><xmp>         if (tempFileUsed && (!renameFile(tempFile, file))) {</xmp></same><diff_remove><xmp>-            throw new IOException(("Save failed: Another process may be using " + file) + ".");</xmp></diff_remove><diff_add><xmp>+            throw new IOException(("Save failed. Another process may be using " + file) + ".");</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         success = true;</xmp></same><same><xmp>     } finally {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertNewLine(int pos) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int len = _document.getLength();</xmp></same><same><xmp>         if (pos > len) {</xmp></same><diff_header><xmp>@@ -12,6 +12,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -13,9 +13,9 @@</xmp></diff_header><same><xmp>                 }</xmp></same><same><xmp>                 return chosen;</xmp></same><same><xmp>             } else {</xmp></same><diff_remove><xmp>-                throw new RuntimeException("filechooser returned null file");</xmp></diff_remove><diff_add><xmp>+                throw new RuntimeException("Filechooser returned null file");</xmp></diff_add><same><xmp>             }</xmp></same><same><xmp>         default :</xmp></same><diff_remove><xmp>-            throw new RuntimeException("filechooser returned bad rc " + choice);</xmp></diff_remove><diff_add><xmp>+            throw new RuntimeException("Filechooser returned bad rc " + choice);</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,8 +6,8 @@</xmp></diff_header><same><xmp>         for (int j = 0; j < comments.length; j++) {</xmp></same><same><xmp>             String curComment = comments[j];</xmp></same><same><xmp>             setUp();</xmp></same><diff_remove><xmp>-            defModel.insertString(0, (((curComment + "\n\n") + "package ") + curPack) + ";\nclass Foo { int x; }\n", null);</xmp></diff_remove><diff_remove><xmp>-            assertEquals("Package name for document with comment " + curComment, curPack, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+            _defModel.insertString(0, (((curComment + "\n\n") + "package ") + curPack) + ";\nclass Foo { int x; }\n", null);</xmp></diff_add><diff_add><xmp>+            assertEquals("Package name for document with comment " + curComment, curPack, _defModel.getPackageName());</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_561() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_568() {</xmp></diff_add><same><xmp>     if (jj_scan_token(CASE)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_281() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_332() {</xmp></diff_add><same><xmp>     if (jj_scan_token(MINUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testCommentsAfterBrace() throws BadLocationException {</xmp></same><same><xmp>     _text = ((((("class Foo {   \n" + "              \n") + "  /*          \n") + "   *          \n") + "   */         \n") + "  int field;  \n") + "}";</xmp></same><same><xmp>     _setDocText(_text);</xmp></same><diff_remove><xmp>-    assertTrue("START = DOCSTART.", !_rule.applyRule(_doc, 0, OTHER));</xmp></diff_remove><diff_remove><xmp>-    assertTrue("START = DOCSTART.", !_rule.applyRule(_doc, 14, OTHER));</xmp></diff_remove><diff_add><xmp>+    assertTrue("START = 0.", !_rule.applyRule(_doc, 0, OTHER));</xmp></diff_add><diff_add><xmp>+    assertTrue("START = 0.", !_rule.applyRule(_doc, 14, OTHER));</xmp></diff_add><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 15, OTHER));</xmp></same><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 30, OTHER));</xmp></same><same><xmp>     assertTrue("Only WS between START and open brace.", _rule.applyRule(_doc, 44, OTHER));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testToString() {</xmp></same><diff_remove><xmp>-    assertEquals("Brace([40])", lparen.toString());</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Brace([41])", rparen.toString());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Brace<(>", lparen.toString());</xmp></diff_add><diff_add><xmp>+    assertEquals("Brace<)>", rparen.toString());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testStringOps() throws ExceptionReturnedException {</xmp></same><diff_remove><xmp>-    Pair[] cases = new Pair[]{ Pair.make("\"yeah\" + \"and\"", new String("yeah" + "and")), Pair.make("\"yeah\".equals(\"yeah\")", new Boolean("yeah".equals("yeah"))) };</xmp></diff_remove><diff_add><xmp>+    Pair[] cases = new Pair[]{ Pair.make("\"yeah\" + \"and\"", new String("\"yeah" + "and\"")), Pair.make("\"yeah\".equals(\"yeah\")", new Boolean("yeah".equals("yeah"))) };</xmp></diff_add><same><xmp>     tester(cases);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,73 +1,69 @@</xmp></diff_header><same><xmp> protected void doStart() {</xmp></same><diff_remove><xmp>-    if (_t != null) {</xmp></diff_remove><diff_remove><xmp>-        writeCommand(Command.RUN);</xmp></diff_remove><diff_remove><xmp>-    } else {</xmp></diff_remove><diff_remove><xmp>-        _executor.execute(new Runnable() {</xmp></diff_remove><diff_remove><xmp>-            public void run() {</xmp></diff_remove><diff_remove><xmp>-                _t = Thread.currentThread();</xmp></diff_remove><diff_add><xmp>+    _executor.execute(new Runnable() {</xmp></diff_add><diff_add><xmp>+        public void run() {</xmp></diff_add><diff_add><xmp>+            _t = Thread.currentThread();</xmp></diff_add><diff_add><xmp>+            try {</xmp></diff_add><diff_add><xmp>+                if (Thread.interrupted()) {</xmp></diff_add><diff_add><xmp>+                    throw new InterruptedException();</xmp></diff_add><diff_add><xmp>+                }</xmp></diff_add><diff_add><xmp>+                Process p = _jvmBuilder.start(ProcessIncrementalTaskController.Runner.class.getName(), IterUtil.<String>empty());</xmp></diff_add><same><xmp>                 try {</xmp></same><diff_remove><xmp>-                    if (Thread.interrupted()) {</xmp></diff_remove><diff_remove><xmp>-                        throw new InterruptedException();</xmp></diff_remove><diff_remove><xmp>-                    }</xmp></diff_remove><diff_remove><xmp>-                    Process p = _jvmBuilder.start(ProcessIncrementalTaskController.Runner.class.getName(), IterUtil.<String>empty());</xmp></diff_remove><diff_add><xmp>+                    InputStream in = p.getInputStream();</xmp></diff_add><diff_add><xmp>+                    int matching = 0;</xmp></diff_add><diff_add><xmp>+                    while (matching < Runner.PREFIX.length) {</xmp></diff_add><diff_add><xmp>+                        int read = in.read();</xmp></diff_add><diff_add><xmp>+                        if (read == (-1)) {</xmp></diff_add><diff_add><xmp>+                            throw new EOFException("Data prefix not found");</xmp></diff_add><diff_add><xmp>+                        } else if (((byte) (read)) == Runner.PREFIX[matching]) {</xmp></diff_add><diff_add><xmp>+                            matching++;</xmp></diff_add><diff_add><xmp>+                        } else if (((byte) (read)) == Runner.PREFIX[0]) {</xmp></diff_add><diff_add><xmp>+                            matching = 1;</xmp></diff_add><diff_add><xmp>+                        } else {</xmp></diff_add><diff_add><xmp>+                            matching = 0;</xmp></diff_add><diff_add><xmp>+                        }</xmp></diff_add><diff_add><xmp>+                    } </xmp></diff_add><diff_add><xmp>+                    ObjectInputStream objIn = new ObjectInputStream(in);</xmp></diff_add><same><xmp>                     try {</xmp></same><diff_remove><xmp>-                        InputStream in = p.getInputStream();</xmp></diff_remove><diff_remove><xmp>-                        int matching = 0;</xmp></diff_remove><diff_remove><xmp>-                        while (matching < Runner.PREFIX.length) {</xmp></diff_remove><diff_remove><xmp>-                            int read = in.read();</xmp></diff_remove><diff_remove><xmp>-                            if (read == (-1)) {</xmp></diff_remove><diff_remove><xmp>-                                throw new EOFException("Data prefix not found");</xmp></diff_remove><diff_remove><xmp>-                            } else if (((byte) (read)) == Runner.PREFIX[matching]) {</xmp></diff_remove><diff_remove><xmp>-                                matching++;</xmp></diff_remove><diff_remove><xmp>-                            } else if (((byte) (read)) == Runner.PREFIX[0]) {</xmp></diff_remove><diff_remove><xmp>-                                matching = 1;</xmp></diff_remove><diff_add><xmp>+                        ObjectOutputStream objOut = new ObjectOutputStream(p.getOutputStream());</xmp></diff_add><diff_add><xmp>+                        try {</xmp></diff_add><diff_add><xmp>+                            objOut.writeObject(_task);</xmp></diff_add><diff_add><xmp>+                            objOut.writeObject(Command.RUN);</xmp></diff_add><diff_add><xmp>+                            objOut.flush();</xmp></diff_add><diff_add><xmp>+                            _commandSink = objOut;</xmp></diff_add><diff_add><xmp>+                            Result r;</xmp></diff_add><diff_add><xmp>+                            do {</xmp></diff_add><diff_add><xmp>+                                r = ((Result) (objIn.readObject()));</xmp></diff_add><diff_add><xmp>+                                r.handle(ProcessIncrementalTaskController.this);</xmp></diff_add><diff_add><xmp>+                            } while (!(r instanceof ProcessIncrementalTaskController.FinishResult) );</xmp></diff_add><diff_add><xmp>+                            if (r instanceof ProcessIncrementalTaskController.CleanFinishResult) {</xmp></diff_add><diff_add><xmp>+                                Runnable1<? super Process> onExit = _onExit;</xmp></diff_add><diff_add><xmp>+                                if (onExit != null) {</xmp></diff_add><diff_add><xmp>+                                    p.waitFor();</xmp></diff_add><diff_add><xmp>+                                    onExit.run(p);</xmp></diff_add><diff_add><xmp>+                                }</xmp></diff_add><same><xmp>                             } else {</xmp></same><diff_remove><xmp>-                                matching = 0;</xmp></diff_remove><diff_remove><xmp>-                            }</xmp></diff_remove><diff_remove><xmp>-                        } </xmp></diff_remove><diff_remove><xmp>-                        ObjectInputStream objIn = new ObjectInputStream(in);</xmp></diff_remove><diff_remove><xmp>-                        try {</xmp></diff_remove><diff_remove><xmp>-                            ObjectOutputStream objOut = new ObjectOutputStream(p.getOutputStream());</xmp></diff_remove><diff_remove><xmp>-                            try {</xmp></diff_remove><diff_remove><xmp>-                                objOut.writeObject(_task);</xmp></diff_remove><diff_remove><xmp>-                                objOut.writeObject(Command.RUN);</xmp></diff_remove><diff_remove><xmp>-                                objOut.flush();</xmp></diff_remove><diff_remove><xmp>-                                _commandSink = objOut;</xmp></diff_remove><diff_remove><xmp>-                                Result r;</xmp></diff_remove><diff_remove><xmp>-                                do {</xmp></diff_remove><diff_remove><xmp>-                                    r = ((Result) (objIn.readObject()));</xmp></diff_remove><diff_remove><xmp>-                                    r.handle(ProcessIncrementalTaskController.this);</xmp></diff_remove><diff_remove><xmp>-                                } while (!(r instanceof ProcessIncrementalTaskController.FinishResult) );</xmp></diff_remove><diff_remove><xmp>-                                if (r instanceof ProcessIncrementalTaskController.CleanFinishResult) {</xmp></diff_remove><diff_remove><xmp>-                                    Runnable1<? super Process> onExit = _onExit;</xmp></diff_remove><diff_remove><xmp>-                                    if (onExit != null) {</xmp></diff_remove><diff_remove><xmp>-                                        p.waitFor();</xmp></diff_remove><diff_remove><xmp>-                                        onExit.run(p);</xmp></diff_remove><diff_remove><xmp>-                                    }</xmp></diff_remove><diff_remove><xmp>-                                } else {</xmp></diff_remove><diff_remove><xmp>-                                    p.destroy();</xmp></diff_remove><diff_remove><xmp>-                                }</xmp></diff_remove><diff_remove><xmp>-                            } finally {</xmp></diff_remove><diff_remove><xmp>-                                objOut.close();</xmp></diff_remove><diff_add><xmp>+                                p.destroy();</xmp></diff_add><same><xmp>                             }</xmp></same><same><xmp>                         } finally {</xmp></same><diff_remove><xmp>-                            objIn.close();</xmp></diff_remove><diff_add><xmp>+                            objOut.close();</xmp></diff_add><same><xmp>                         }</xmp></same><diff_remove><xmp>-                    } catch (EOFException e) {</xmp></diff_remove><diff_remove><xmp>-                        p.destroy();</xmp></diff_remove><diff_remove><xmp>-                        throw new IOException("Unable to run process; class path may need to be adjusted");</xmp></diff_remove><diff_remove><xmp>-                    } catch (Throwable e) {</xmp></diff_remove><diff_remove><xmp>-                        p.destroy();</xmp></diff_remove><diff_remove><xmp>-                        throw e;</xmp></diff_remove><diff_add><xmp>+                    } finally {</xmp></diff_add><diff_add><xmp>+                        objIn.close();</xmp></diff_add><same><xmp>                     }</xmp></same><diff_remove><xmp>-                } catch (InterruptedException e) {</xmp></diff_remove><diff_remove><xmp>-                } catch (InterruptedIOException e) {</xmp></diff_remove><diff_remove><xmp>-                } catch (RuntimeException e) {</xmp></diff_remove><diff_remove><xmp>-                    finishedWithImplementationException(e);</xmp></diff_remove><diff_remove><xmp>-                } catch (Throwable t) {</xmp></diff_remove><diff_remove><xmp>-                    finishedWithImplementationException(new WrappedException(t));</xmp></diff_remove><diff_add><xmp>+                } catch (EOFException e) {</xmp></diff_add><diff_add><xmp>+                    p.destroy();</xmp></diff_add><diff_add><xmp>+                    throw new IOException("Unable to run process; class path may need to be adjusted");</xmp></diff_add><diff_add><xmp>+                } catch (Throwable e) {</xmp></diff_add><diff_add><xmp>+                    p.destroy();</xmp></diff_add><diff_add><xmp>+                    throw e;</xmp></diff_add><same><xmp>                 }</xmp></same><diff_add><xmp>+            } catch (InterruptedException e) {</xmp></diff_add><diff_add><xmp>+            } catch (InterruptedIOException e) {</xmp></diff_add><diff_add><xmp>+            } catch (RuntimeException e) {</xmp></diff_add><diff_add><xmp>+                finishedWithImplementationException(e);</xmp></diff_add><diff_add><xmp>+            } catch (Throwable t) {</xmp></diff_add><diff_add><xmp>+                finishedWithImplementationException(new WrappedException(t));</xmp></diff_add><same><xmp>             }</xmp></same><diff_remove><xmp>-        });</xmp></diff_remove><diff_remove><xmp>-    }</xmp></diff_remove><diff_add><xmp>+        }</xmp></diff_add><diff_add><xmp>+    });</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Short(\"2\") | new Byte(\"2\");";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: byteValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Byte) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: byteValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Byte) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_284() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_335() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_UNSIGNED_SHIFTASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallPreviousInteractionInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             moveHistoryPrevious(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertBeforeLastPrompt(String text, String style) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int pos = getPositionBeforePrompt();</xmp></same><same><xmp>         _promptPos += text.length();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_268() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_276() {</xmp></diff_add><same><xmp>     if (jj_scan_token(SLASH_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGotoLine5() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(1);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 0, defModel.getCurrentLocation());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(1);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 0, _defModel.getCurrentLocation());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGotoLine6() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(4);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 0, defModel.getCurrentLocation());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(4);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 0, _defModel.getCurrentLocation());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> private int _replaceAllInCurrentDoc() {</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_isForward) {</xmp></same><same><xmp>             setPosition(0);</xmp></same><diff_header><xmp>@@ -15,6 +15,6 @@</xmp></diff_header><same><xmp>         } </xmp></same><same><xmp>         return count;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testInterpretInnerClassConstructorVarArgs() {</xmp></same><diff_remove><xmp>-    testString = ((((((((((((("public class B {\n" + "  public class C {\n") + "    String str = \"\";\n") + "    public C(String ... s){\n") + "      for(int i=0;i<s.length;i++) {\n") + "        str = str+s[i];\n") + "      }\n") + "    }\n") + "    public String getStr(){\n") + "      return str;\n") + "    }\n") + "  }\n") + "}\n") + "B b = new B();\n") + "b.new C(\"Str1\",\"Str2\",\"Str3\").getStr();\n";</xmp></diff_remove><diff_remove><xmp>-    assertEquals("Str1Str2Str3", interpret(testString));</xmp></diff_remove><diff_add><xmp>+    testString = ((((((((((((("public class B {\n" + "  public class C {\n") + "    String str = \"\";\n") + "    public C(String ... s){\n") + "      for(int i=0;i<s.length;i++) {\n") + "        str = str+s[i];\n") + "      }\n") + "    }\n") + "    public String getStr(){\n") + "      return str;\n") + "    }\n") + "  }\n") + "}\n") + "B b = new B();\n") + "b.new C(\"Str1\",\"Str2\",\"Str3\",\"Str4\").getStr();\n";</xmp></diff_add><diff_add><xmp>+    assertEquals("Str1Str2Str3Str4", interpret(testString));</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void insertString(int offs, String str, AttributeSet set) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canInsertText(offs)) {</xmp></same><same><xmp>             super.insertString(offs, str, set);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testDividingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) / new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertString(int offset, String str, AttributeSet a) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_tabsRemoved) {</xmp></same><same><xmp>             str = _removeTabs(str);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>         setModifiedSinceSave();</xmp></same><same><xmp>         super.insertString(offset, str, a);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_276() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_284() {</xmp></diff_add><same><xmp>     if (jj_scan_token(XOR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void reverseHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.reverseSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testShiftLeft() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Short(\"-10\") << new Short(\"2\");";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"-10\" -10 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"-10\" -10 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setInProgress(boolean inProgress) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     _hasPrompt = !inProgress;</xmp></same><diff_remove><xmp>-    releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyUnlock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -9,7 +9,7 @@</xmp></diff_header><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_JAVADOC, "Automatically Save Before Generating Javadoc", this, "<html>Whether DrJava should automatically save before<br>" + "generating Javadoc or ask the user each time.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_BREAKPOINT_OUT_OF_SYNC, "Warn on Breakpoint if Out of Sync", this, "<html>Whether DrJava should warn the user if the class file<br>" + "is out of sync before setting a breakpoint in that file.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_DEBUG_MODIFIED_FILE, "Warn if Debugging Modified File", this, "<html>Whether DrJava should warn the user if the file being<br>" + "debugged has been modified since its last save.</html>"));</xmp></same><diff_remove><xmp>-    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_CHANGE_LAF, "Warn to Restart to Change Look and Feel", this, "<html>Whether DrJava should warn the user that look and feel<br>" + "changes will not be applied until DrJava is restarted.</html>."));</xmp></diff_remove><diff_add><xmp>+    addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_CHANGE_LAF, "Warn to Restart to Change Look and Feel", this, "<html>Whether DrJava should warn the user that look and feel.<br>" + "(Changes will not be applied until DrJava is restarted.)</html>."));</xmp></diff_add><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.WARN_PATH_CONTAINS_POUND, "Warn if File's Path Contains a '#' Symbol", this, (("<html>Whether DrJava should warn the user if the file being<br>" + "saved has a path that contains a '#' symbol.<br>") + "Users cannot use such files in the Interactions Pane<br>") + "because of a bug in Java.</html>"));</xmp></same><same><xmp>     addOptionComponent(panel, new BooleanOptionComponent(OptionConstants.DIALOG_DRJAVA_ERROR_POPUP_ENABLED, "Show a notification window when the first DrJava error occurs", this, "<html>Whether to show a notification window when the first DrJava error occurs.<br>" + "If this is disabled, only the \"DrJava Error\" button will appear.</html>"));</xmp></same><same><xmp>     panel.displayComponents();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -6,7 +6,7 @@</xmp></diff_header><same><xmp>         } catch (Exception e) {</xmp></same><same><xmp>             buildDirTxt = _model.getBuildDirectory().getPath();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        ConfirmCheckBoxDialog dialog = new ConfirmCheckBoxDialog(this, "Clean Built Directory?", ((("Cleaning your built directory will delete all\n" + "class files and empty folders within that directory.\n") + "Are you sure you want to clean\n") + buildDirTxt) + "?", "Do not show this message again");</xmp></diff_remove><diff_add><xmp>+        ConfirmCheckBoxDialog dialog = new ConfirmCheckBoxDialog(this, "Clean Build Directory?", ((("Cleaning your build directory will delete all\n" + "class files and empty folders within that directory.\n") + "Are you sure you want to clean\n") + buildDirTxt) + "?", "Do not show this message again");</xmp></diff_add><same><xmp>         int rc = dialog.show();</xmp></same><same><xmp>         switch (rc) {</xmp></same><same><xmp>             case JOptionPane.YES_OPTION :</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_280() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_331() {</xmp></diff_add><same><xmp>     if (jj_scan_token(PLUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_185() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_557() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_564()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> private int _uncommentBlock(final int start, final int end) {</xmp></same><same><xmp>     int afterUncommentEnd = end;</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         final Position endPos = this.createPosition(end);</xmp></same><same><xmp>         int walker = start;</xmp></same><diff_header><xmp>@@ -17,7 +17,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     return afterUncommentEnd;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setInProgress(boolean inProgress) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     _hasPrompt = !inProgress;</xmp></same><diff_remove><xmp>-    modifyUnlock();</xmp></diff_remove><diff_add><xmp>+    releaseWriteLock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (_doc.getUndoableEditListeners().length == 0) {</xmp></same><same><xmp>         _resetUndo();</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    _doc.modifyLock();</xmp></diff_add><same><xmp>     int len = _doc.getLength();</xmp></same><same><xmp>     if ((len < _position) || (len < _selEnd)) {</xmp></same><same><xmp>         _position = len;</xmp></same><diff_header><xmp>@@ -21,7 +21,7 @@</xmp></diff_header><same><xmp>             _doc.setCurrentLocation(_selEnd);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        _doc.modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     _scrollPane.getVerticalScrollBar().setValue(_savedVScroll);</xmp></same><same><xmp>     _scrollPane.getHorizontalScrollBar().setValue(_savedHScroll);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testOringTwoBooleans() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) || new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public int commentLines(int selStart, int selEnd) {</xmp></same><same><xmp>     int toReturn = selEnd;</xmp></same><same><xmp>     if (selStart == selEnd) {</xmp></same><diff_remove><xmp>-        modifyLock();</xmp></diff_remove><diff_add><xmp>+        acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             synchronized(_reduced) {</xmp></same><same><xmp>                 setCurrentLocation(selStart);</xmp></same><diff_header><xmp>@@ -12,7 +12,7 @@</xmp></diff_header><same><xmp>         } catch (BadLocationException e) {</xmp></same><same><xmp>             throw new UnexpectedException(e);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } else {</xmp></same><same><xmp>         toReturn = _commentBlock(selStart, selEnd);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     if (c.indexOf('.') != (-1)) {</xmp></same><same><xmp>         c = c.substring(c.lastIndexOf('.') + 1, c.length());</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         insertText(getLength(), ((c + ": ") + message) + "\n", styleName);</xmp></same><same><xmp>         if (!stackTrace.trim().equals("")) {</xmp></same><diff_header><xmp>@@ -36,6 +36,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canInsertText(offs)) {</xmp></same><same><xmp>             forceInsertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void resetModification() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _isModifiedSinceSave = false;</xmp></same><same><xmp>         _undoManager.documentSaved();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>         if (_odd != null) {</xmp></same><same><xmp>             _odd.documentReset();</xmp></same><same><xmp>         }</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setPrompt(String prompt) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     _prompt = prompt;</xmp></same><diff_remove><xmp>-    releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyUnlock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -26,7 +26,7 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     PredictiveInputModel<GoToFileListEntry> pim = new PredictiveInputModel<GoToFileListEntry>(true, new PredictiveInputModel.PrefixStrategy<GoToFileListEntry>(), list);</xmp></same><same><xmp>     OpenDefinitionsDocument odd = getCurrentDefPane().getOpenDefDocument();</xmp></same><diff_remove><xmp>-    odd.modifyLock();</xmp></diff_remove><diff_add><xmp>+    odd.acquireWriteLock();</xmp></diff_add><same><xmp>     boolean uniqueMatch = true;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         String mask = "";</xmp></same><diff_header><xmp>@@ -83,7 +83,7 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException ble) {</xmp></same><same><xmp>     } finally {</xmp></same><same><xmp>         if (uniqueMatch) {</xmp></same><diff_remove><xmp>-            odd.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            odd.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_269() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_277() {</xmp></diff_add><same><xmp>     if (jj_scan_token(REMAINDER_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void interpreterResetting() {</xmp></same><same><xmp>     if (!_waitingForFirstInterpreter) {</xmp></same><diff_remove><xmp>-        _document.modifyLock();</xmp></diff_remove><diff_add><xmp>+        _document.acquireWriteLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             _document.insertBeforeLastPrompt("Resetting Interactions..." + _newLine, ERROR_STYLE);</xmp></same><same><xmp>             _document.setInProgress(true);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            _document.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+            _document.releaseWriteLock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         try {</xmp></same><same><xmp>             _createNewDebugPort();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -38,6 +38,6 @@</xmp></diff_header><same><xmp>             _currentDefPane.requestFocus();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     }, null, "Find Next");</xmp></same><diff_remove><xmp>-    Singleton.put(KEY_PREVIOUS_PANE, _switchToPreviousPaneAction, null, "Switch Focus To Definitions Pane");</xmp></diff_remove><diff_remove><xmp>-    Singleton.put(KEY_NEXT_PANE, _switchToNextPaneAction, null, "Switch Focus To Interactions Pane");</xmp></diff_remove><diff_add><xmp>+    Singleton.put(KEY_PREVIOUS_PANE, _switchToPreviousPaneAction, null, "Switch Focus To Previous Pane");</xmp></diff_add><diff_add><xmp>+    Singleton.put(KEY_NEXT_PANE, _switchToNextPaneAction, null, "Switch Focus To Next Pane");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void addToHistory(String text) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.add(text);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -60,8 +60,8 @@</xmp></diff_header><same><xmp>     try {</xmp></same><same><xmp>         String mint_home = System.getenv("MINT_HOME");</xmp></same><same><xmp>         if (mint_home != null) {</xmp></same><diff_remove><xmp>-            addIfFile(new File(new File(mint_home), "dist/lib/classes.jar"), jars);</xmp></diff_remove><diff_remove><xmp>-            addIfFile(new File(new File(mint_home), "dist/lib/tools.jar"), jars);</xmp></diff_remove><diff_add><xmp>+            addIfFile(new File(new File(mint_home), "langtools/dist/lib/classes.jar"), jars);</xmp></diff_add><diff_add><xmp>+            addIfFile(new File(new File(mint_home), "langtools/dist/lib/tools.jar"), jars);</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>     } catch (Exception e) {</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_286() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_337() {</xmp></diff_add><same><xmp>     if (jj_scan_token(XOR_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         remove(0, getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_556() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_563() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void clearHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.clear();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallNextInteractionInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             moveHistoryNext(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,12 +5,12 @@</xmp></diff_header><same><xmp>     dirChooser.setApproveButtonText("Select");</xmp></same><same><xmp>     dirChooser.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);</xmp></same><same><xmp>     dirChooser.setMultiSelectionEnabled(false);</xmp></same><diff_remove><xmp>-    FileOptionComponent workDir = new FileOptionComponent(OptionConstants.WORKING_DIRECTORY, "Working Directory", this, "The directory that DrJava should consider the current working directory.", dirChooser);</xmp></diff_remove><diff_add><xmp>+    FileOptionComponent workDir = new FileOptionComponent(OptionConstants.WORKING_DIRECTORY, "Working Directory", this, "The directory that DrJava should consider the default working directory.", dirChooser);</xmp></diff_add><same><xmp>     workDir.setFileFilter(new DirectoryFilter());</xmp></same><same><xmp>     panel.addComponent(workDir);</xmp></same><same><xmp>     panel.addComponent(new IntegerOptionComponent(OptionConstants.HISTORY_MAX_SIZE, "Size of Interactions History", this, "The number of interactions to remember in the history."));</xmp></same><same><xmp>     panel.addComponent(new IntegerOptionComponent(OptionConstants.RECENT_FILES_MAX_SIZE, "Recent Files List Size", this, "<html>The number of files to remember in<br>" + "the recently used files list in the File menu.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.JAVAC_ALLOW_ASSERT, "Allow Assert Keyword in Java 1.4", this, "<html>Whether to allow the <code>assert</code> keyword when compiling in Java 1.4.</html>"));</xmp></same><diff_remove><xmp>-    panel.addComponent(new BooleanOptionComponent(OptionConstants.BACKUP_FILES, "Keep emacs style backup files", this, "<html>Whether DrJava should keep a backup copy of each file that<br>" + "the user modifies, saved with a '~' at the end of the filename.</html>"));</xmp></diff_remove><diff_add><xmp>+    panel.addComponent(new BooleanOptionComponent(OptionConstants.BACKUP_FILES, "Keep Emacs-style Backup Files", this, "<html>Whether DrJava should keep a backup copy of each file that<br>" + "the user modifies, saved with a '~' at the end of the filename.</html>"));</xmp></diff_add><same><xmp>     panel.displayComponents();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseXOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) ^ new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reverseSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             reverseHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameMisleading() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*comment!*/cs.drjava; \n" + " {interface X} ") + " \"class Foo\"") + " class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for user interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for user interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forceInsertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _addToStyleLists(offs, str, style);</xmp></same><same><xmp>         _document.forceInsertText(offs, str, style);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertText(int offs, String str, String style) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>             _document.insertText(offs, str, style);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void forwardSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             forwardHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_355() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_358() {</xmp></diff_add><same><xmp>     if (jj_scan_token(INCREMENT)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertBeforeLastPrompt(String text, String style) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int pos = getPositionBeforePrompt();</xmp></same><same><xmp>         _promptPos += text.length();</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void saveBeforeProceeding(GlobalModelListener.SaveReason reason) {</xmp></same><same><xmp>     String message;</xmp></same><same><xmp>     if (reason == COMPILE_REASON) {</xmp></same><diff_remove><xmp>-        message = "To compile, you must first save the current file. " + "Would you like to save and then compile?";</xmp></diff_remove><diff_add><xmp>+        message = "To compile, you must first save the current file.\n" + "Would you like to save and then compile?";</xmp></diff_add><same><xmp>     } else if (reason == JUNIT_REASON) {</xmp></same><diff_remove><xmp>-        message = "To run JUnit, you must first save and compile the current " + "file. Would like to save and then compile?";</xmp></diff_remove><diff_add><xmp>+        message = "To run JUnit, you must first save and compile the current\n" + "file. Would like to save and then compile?";</xmp></diff_add><same><xmp>     } else {</xmp></same><same><xmp>         throw new RuntimeException("Invalid reason for forcing a save.");</xmp></same><same><xmp>     }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, DEFAULT_STYLE);</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_271() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_279() {</xmp></diff_add><same><xmp>     if (jj_scan_token(MINUS_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testShiftRight() throws InterpreterException {</xmp></same><same><xmp>     String text = "(new Short(\"1\") >> new Short(\"2\"));";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"1\" 1 class java.lang.String)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"1\" 1 class java.lang.String)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: shortValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Short) [(koala.dynamicjava.tree.StringLiteral: \"2\" 2 class java.lang.String)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testLessThan() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Long(12) < new Long(32);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 12 12 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 32 32 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void forwardHistorySearch(String searchString) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.forwardSearch(searchString);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameMisleading() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*comment!*/cs.drjava; \n" + " {class X} \n") + " interface thisInterface { \n") + " class MyInnerClass {";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testAddTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) + new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public void testInteractionAbort() throws BadLocationException, InterruptedException, IOException {</xmp></same><same><xmp>     _doCompile(setupDocument(FOO_TEXT), tempFile());</xmp></same><same><xmp>     final String beforeAbort = interpret("DrJavaTestFoo.class.getName()");</xmp></same><diff_remove><xmp>-    assertEquals("DrJavaTestFoo", beforeAbort);</xmp></diff_remove><diff_add><xmp>+    assertEquals("\"DrJavaTestFoo\"", beforeAbort);</xmp></diff_add><same><xmp>     TestListener listener = new TestListener() {</xmp></same><same><xmp>         public void interactionStarted() {</xmp></same><same><xmp>             interactionStartCount++;</xmp></same><diff_header><xmp>@@ -51,5 +51,5 @@</xmp></diff_header><same><xmp>     _model.removeListener(listener);</xmp></same><same><xmp>     assertEquals("5", interpret("5"));</xmp></same><same><xmp>     final String afterAbort = interpret("DrJavaTestFoo.class.getName()");</xmp></same><diff_remove><xmp>-    assertEquals("DrJavaTestFoo", afterAbort);</xmp></diff_remove><diff_add><xmp>+    assertEquals("\"DrJavaTestFoo\"", afterAbort);</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameMisleading2() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (("package edu . rice\n./*interface comment!*/cs.drjava; \n" + " {interface X<T>} ") + " \"class interface Foo\"") + " class MyClass extends Foo<T> {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for user interface: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for user interface: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public boolean recallPreviousInteractionInHistory() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryPrevious()) {</xmp></same><same><xmp>             moveHistoryPrevious(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -8,6 +8,6 @@</xmp></diff_header><same><xmp>         _beep.run();</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void indentLines(int selStart, int selEnd, int reason, ProgressMonitor pm) throws OperationCanceledException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             if (selStart == selEnd) {</xmp></same><diff_header><xmp>@@ -18,7 +18,7 @@</xmp></diff_header><same><xmp>     } catch (Throwable t) {</xmp></same><same><xmp>         throw new UnexpectedException(t);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     endLastCompoundEdit();</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_276() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_363() {</xmp></diff_add><same><xmp>     if (jj_scan_token(ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_111()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_274() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_282() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_UNSIGNED_SHIFTASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testAndingTwoBooleans() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) && new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_275() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_283() {</xmp></diff_add><same><xmp>     if (jj_scan_token(AND_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void clearCurrentInteraction() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         super.clearCurrentInput();</xmp></same><same><xmp>         _history.moveEnd();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_283() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_334() {</xmp></diff_add><same><xmp>     if (jj_scan_token(RIGHT_SIGNED_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_135() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_136() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testCompileWithPackageStatementInsideClass() throws BadLocationException, IOException {</xmp></same><same><xmp>     File baseTempDir = tempDirectory();</xmp></same><same><xmp>     File subdir = new File(baseTempDir, "a");</xmp></same><diff_remove><xmp>-    File fooFile = new File(subdir, "Foo.java");</xmp></diff_remove><diff_remove><xmp>-    File compiled = classForJava(fooFile, "Foo");</xmp></diff_remove><diff_add><xmp>+    File fooFile = new File(subdir, "DrJavaTestFoo.java");</xmp></diff_add><diff_add><xmp>+    File compiled = classForJava(fooFile, "DrJavaTestFoo");</xmp></diff_add><same><xmp>     subdir.mkdir();</xmp></same><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_PACKAGE_INSIDE_CLASS);</xmp></same><same><xmp>     doc.saveFileAs(new FileSelector(fooFile));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void clearCurrentInteraction() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         super.clearCurrentInput();</xmp></same><same><xmp>         _history.moveEnd();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryNext(String entry) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.moveNext(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -3,7 +3,7 @@</xmp></diff_header><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.INTERACTIONS_RESET_PROMPT, "Prompt Before Resetting Interactions Pane", this, "<html>Whether DrJava should prompt the user before<br>" + "manually resetting the interactions pane.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.INTERACTIONS_EXIT_PROMPT, "Prompt if Interactions Pane Exits Unexpectedly", this, "<html>Whether DrJava should show a dialog box if a program<br>" + "in the Interactions Pane exits without the user clicking Reset.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.JAVADOC_PROMPT_FOR_DESTINATION, "Prompt for Javadoc Destination", this, "<html>Whether Javadoc should always prompt the user<br>" + "to select a destination directory.</html>"));</xmp></same><diff_remove><xmp>-    panel.addComponent(new BooleanOptionComponent(OptionConstants.PROMPT_BEFORE_CLEAN, "Prompt before Cleaning Built Directory", this, "<html>Whether DrJava should prompt before cleaning the<br>" + "built directory of a project</html>"));</xmp></diff_remove><diff_add><xmp>+    panel.addComponent(new BooleanOptionComponent(OptionConstants.PROMPT_BEFORE_CLEAN, "Prompt before Cleaning Build Directory", this, "<html>Whether DrJava should prompt before cleaning the<br>" + "build directory of a project</html>"));</xmp></diff_add><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_COMPILE, "Automatically Save Before Compiling", this, "<html>Whether DrJava should automatically save before<br>" + "recompiling or ask the user each time.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.ALWAYS_SAVE_BEFORE_JAVADOC, "Automatically Save Before Generating Javadoc", this, "<html>Whether DrJava should automatically save before<br>" + "generating Javadoc or ask the user each time.</html>"));</xmp></same><same><xmp>     panel.addComponent(new BooleanOptionComponent(OptionConstants.WARN_BREAKPOINT_OUT_OF_SYNC, "Warn on Breakpoint if Out of Sync", this, "<html>Whether DrJava should warn the user if the class file<br>" + "is out of sync before setting a breakpoint in that file.</html>"));</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_285() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_336() {</xmp></diff_add><same><xmp>     if (jj_scan_token(AND_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><same><xmp>     DefinitionsDocument doc = getDocument();</xmp></same><diff_remove><xmp>-    doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         doc.remove(0, doc.getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (_condition.canRemoveText(offs)) {</xmp></same><same><xmp>             forceRemoveText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,11 +2,11 @@</xmp></diff_header><same><xmp>     if (len == 0) {</xmp></same><same><xmp>         return;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         setModifiedSinceSave();</xmp></same><same><xmp>         super.remove(offset, len);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_356() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_359() {</xmp></diff_add><same><xmp>     if (jj_scan_token(DECREMENT)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void interpreterResetting() {</xmp></same><same><xmp>     if (!_waitingForFirstInterpreter) {</xmp></same><diff_remove><xmp>-        _document.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+        _document.modifyLock();</xmp></diff_add><same><xmp>         try {</xmp></same><same><xmp>             _document.insertBeforeLastPrompt("Resetting Interactions..." + _newLine, ERROR_STYLE);</xmp></same><same><xmp>             _document.setInProgress(true);</xmp></same><same><xmp>         } finally {</xmp></same><diff_remove><xmp>-            _document.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+            _document.modifyUnlock();</xmp></diff_add><same><xmp>         }</xmp></same><same><xmp>         try {</xmp></same><same><xmp>             _createNewDebugPort();</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void classFileError(ClassFileError e) {</xmp></same><diff_remove><xmp>-    final String message = ((((("The class file for class " + e.getClassName()) + "in source file ") + e.getCanonicalPath()) + " cannot be loaded.\n ") + "When DrJava tries to load it, the following error is generated:\n") + e.getError();</xmp></diff_remove><diff_add><xmp>+    final String message = ((((("The class file for class " + e.getClassName()) + " in source file ") + e.getCanonicalPath()) + " cannot be loaded.\n ") + "When DrJava tries to load it, the following error is generated:\n") + e.getError();</xmp></diff_add><same><xmp>     Utilities.invokeLater(new Runnable() {</xmp></same><same><xmp>         public void run() {</xmp></same><diff_remove><xmp>-            JOptionPane.showMessageDialog(MainFrame.this, message, "Testing works only on well-formed, verifiable class files", JOptionPane.ERROR_MESSAGE);</xmp></diff_remove><diff_add><xmp>+            JOptionPane.showMessageDialog(MainFrame.this, message, "Testing works only on valid class files", JOptionPane.ERROR_MESSAGE);</xmp></diff_add><same><xmp>             showTab(_junitErrorPanel);</xmp></same><same><xmp>             _junitAction.setEnabled(true);</xmp></same><same><xmp>             _junitAllAction.setEnabled(true);</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_245() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_244() {</xmp></diff_add><same><xmp>     if (jj_scan_token(COMMA)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_95()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void clear() {</xmp></same><same><xmp>     DefinitionsDocument doc = getDocument();</xmp></same><diff_remove><xmp>-    doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    doc.modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         doc.remove(0, doc.getLength());</xmp></same><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _clearCurrentInputText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         removeText(_promptPos, _document.getLength() - _promptPos);</xmp></same><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseOr() throws ExceptionReturnedException {</xmp></same><same><xmp>     String text = "new Boolean(true) | new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)])";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)])";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testModingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) % new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void disablePrompt() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _hasPrompt = false;</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testToString() {</xmp></same><diff_remove><xmp>-    assertEquals(" (", lparen.toString());</xmp></diff_remove><diff_remove><xmp>-    assertEquals(" )", rparen.toString());</xmp></diff_remove><diff_add><xmp>+    assertEquals("Brace([40])", lparen.toString());</xmp></diff_add><diff_add><xmp>+    assertEquals("Brace([41])", rparen.toString());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -11,13 +11,13 @@</xmp></diff_header><same><xmp>     };</xmp></same><same><xmp>     Object _lock = new Object();</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><diff_remove><xmp>-        tree.addDocument(item, "folder3/");</xmp></diff_remove><diff_add><xmp>+        tree.addDocument(item, "folder3");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     InnerNode folder3 = ((InnerNode) (source.getChildAt(2)));</xmp></same><same><xmp>     assertEquals("folder3 should have 1 children", 1, folder3.getChildCount());</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><same><xmp>         _name = "MyTest.expected";</xmp></same><diff_remove><xmp>-        tree.refreshDocument(item, "folder3/");</xmp></diff_remove><diff_add><xmp>+        tree.refreshDocument(item, "folder3");</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     synchronized(_lock) {</xmp></same><same><xmp>         assertEquals("folder3 should have 1 children", 1, folder3.getChildCount());</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassNameWComments() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = (((((("package edu . rice\n./*comment!*/cs.drjava; \n" + "/* class Y */ \n") + " /* class Foo \n") + " * class Bar \n") + " interface Baz \n") + " */ \n") + "//class Blah\n") + "class MyClass {";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for class: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for class: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void insertString(int offset, String str, AttributeSet a) throws BadLocationException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         synchronized(_reduced) {</xmp></same><same><xmp>             clearCache();</xmp></same><same><xmp>             super.insertString(offset, str, a);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_113() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_114() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testSubtractingTwoIntegers() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Integer(1) - new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_417() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_419() {</xmp></diff_add><same><xmp>     if (jj_scan_token(EXTENDS)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -31,5 +31,5 @@</xmp></diff_header><same><xmp>     _redoAction.putValue(Action.NAME, "Redo Last Undo");</xmp></same><same><xmp>     _setUpAction(_resetInteractionsAction, "Reset", "Reset interactions");</xmp></same><same><xmp>     _setUpAction(_junitAction, "Test", "Run JUnit over the current document");</xmp></same><diff_remove><xmp>-    _setUpAction(_javadocAction, "JavaDoc", "Test", "Create javadoc");</xmp></diff_remove><diff_add><xmp>+    _setUpAction(_javadocAction, "Javadoc", "Test", "Create Javadoc for open documents");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void setPrompt(String prompt) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     _prompt = prompt;</xmp></same><diff_remove><xmp>-    modifyUnlock();</xmp></diff_remove><diff_add><xmp>+    releaseWriteLock();</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void addToHistory(String text) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.add(text);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_282() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_333() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LEFT_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _document.removeText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -14,7 +14,7 @@</xmp></diff_header><same><xmp>                 _junitInterrupted("Unit testing cancelled by user.");</xmp></same><same><xmp>             }</xmp></same><same><xmp>         });</xmp></same><diff_remove><xmp>-        ScrollableListDialog<OpenDefinitionsDocument> dialog = new ScrollableListDialog.Builder<OpenDefinitionsDocument>().setOwner(this).setTitle("Must Compile All Source Files to Run Unit Tests").setText(("Before you can run unit tests, you must first compile all out of sync source files.\n" + "The files below are out of sync. Would you like to compile all files and\n") + "run the specified test(s)?").setItems(outOfSync).setMessageType(JOptionPane.QUESTION_MESSAGE).setFitToScreen(true).clearButtons().addButton(yesButton).addButton(noButton).build();</xmp></diff_remove><diff_add><xmp>+        ScrollableListDialog<OpenDefinitionsDocument> dialog = new ScrollableListDialog.Builder<OpenDefinitionsDocument>().setOwner(this).setTitle("Must Compile All Source Files to Run Unit Tests").setText(("<html>Before you can run unit tests, you must first compile all out of sync source files.<br>" + "The files below are out of sync. Would you like to compile all files and<br>") + "run the specified test(s)?").setItems(outOfSync).setMessageType(JOptionPane.QUESTION_MESSAGE).setFitToScreen(true).clearButtons().addButton(yesButton).addButton(noButton).build();</xmp></diff_add><same><xmp>         dialog.showDialog();</xmp></same><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseAnd() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Character('a') & new Integer(2);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: charValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Character) [(koala.dynamicjava.tree.CharacterLiteral: 'a' a char)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: charValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Character) [(koala.dynamicjava.tree.CharacterLiteral: 'a' a char)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 2 2 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryNext(String entry) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.moveNext(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_134() {</xmp></diff_remove><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_143() {</xmp></diff_add><diff_add><xmp>+    if (jj_3R_90()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_133() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_135() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -38,8 +38,8 @@</xmp></diff_header><same><xmp>     _setUpAction(_quitAction, "Quit", "Quit", "Quit DrJava");</xmp></same><same><xmp>     _setUpAction(_undoAction, "Undo", "Undo previous command");</xmp></same><same><xmp>     _setUpAction(_redoAction, "Redo", "Redo last undo");</xmp></same><diff_remove><xmp>-    _undoAction.putValue(Action.NAME, "Undo Previous Command");</xmp></diff_remove><diff_remove><xmp>-    _redoAction.putValue(Action.NAME, "Redo Last Undo");</xmp></diff_remove><diff_add><xmp>+    _undoAction.putValue(Action.NAME, "Undo previous command");</xmp></diff_add><diff_add><xmp>+    _redoAction.putValue(Action.NAME, "Redo last undo");</xmp></diff_add><same><xmp>     _setUpAction(cutAction, "Cut", "Cut selected text to the clipboard");</xmp></same><same><xmp>     _setUpAction(copyAction, "Copy", "Copy selected text to the clipboard");</xmp></same><same><xmp>     _setUpAction(pasteAction, "Paste", "Paste text from the clipboard");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelInterfaceNameBeforeClassName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = ((("package edu . rice\n./*comment!*/cs.drjava; \n" + " interface thisInterface { \n") + "  } \n") + " class thatClass {\n") + "  }";</xmp></same><same><xmp>     String result = "thisInterface";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("interface should have been chosen, rather than the class: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("interface should have been chosen, rather than the class: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) | new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void disablePrompt() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _hasPrompt = false;</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void reset(String banner) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceRemoveText(0, _document.getLength());</xmp></same><same><xmp>         forceInsertText(0, banner, OBJECT_RETURN_STYLE);</xmp></same><diff_header><xmp>@@ -9,6 +9,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testInterpretJavaSingleQuotedArgs() throws DocumentAdapterException {</xmp></same><diff_remove><xmp>-    _assertProcessedContents("java Foo 'asdf'", "Foo.main(new String[]{\"\'asdf\'\"});");</xmp></diff_remove><diff_remove><xmp>-    _assertProcessedContents("java Foo 'a b c'", "Foo.main(new String[]{\"\'a\",\"b\",\"c\'\"});");</xmp></diff_remove><diff_add><xmp>+    _assertProcessedContents("java Foo 'asdf'", "Foo.main(new String[]{\"asdf\"});");</xmp></diff_add><diff_add><xmp>+    _assertProcessedContents("java Foo 'a b c'", "Foo.main(new String[]{\"a b c\"});");</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testNumericBitwiseXOr() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Long(0) ^ new Integer(1);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Long) [(koala.dynamicjava.tree.IntegerLiteral: 0 0 int)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: longValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Long) [(koala.dynamicjava.tree.IntegerLiteral: 0 0 int)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: intValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Integer) [(koala.dynamicjava.tree.IntegerLiteral: 1 1 int)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public String getText() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    acquireReadLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         return _document.getDocText(0, getLength());</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        releaseReadLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testBooleanBitwiseAnd() throws InterpreterException {</xmp></same><same><xmp>     String text = "new Boolean(true) & new Boolean(false);";</xmp></same><diff_remove><xmp>-    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_remove><diff_remove><xmp>-    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceType: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_remove><diff_add><xmp>+    String expectedLeft = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: true true boolean)]))";</xmp></diff_add><diff_add><xmp>+    String expectedRight = "(koala.dynamicjava.tree.ObjectMethodCall: booleanValue null (koala.dynamicjava.tree.SimpleAllocation: (koala.dynamicjava.tree.ReferenceTypeName: Boolean) [(koala.dynamicjava.tree.BooleanLiteral: false false boolean)]))";</xmp></diff_add><same><xmp>     _checkBinaryExpression(text, expectedLeft, expectedRight);</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,11 +1,11 @@</xmp></diff_header><same><xmp> public void testCannotEditBeforePrompt() throws EditDocumentException {</xmp></same><diff_remove><xmp>-    _doc.acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    _doc.modifyLock();</xmp></diff_add><same><xmp>     int origLength = 0;</xmp></same><same><xmp>     try {</xmp></same><same><xmp>         origLength = _doc.getLength();</xmp></same><same><xmp>         _doc.insertText(1, "typed text", DEFAULT_STYLE);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        _doc.modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     assertEquals("Document should not have changed.", origLength, _doc.getLength());</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -5,10 +5,10 @@</xmp></diff_header><same><xmp>     }</xmp></same><same><xmp>     MethodData md = createMethodData(that, _symbolData);</xmp></same><same><xmp>     if (md.hasModifier("private")) {</xmp></same><diff_remove><xmp>-        _addAndIgnoreError("Interface methods cannot be made private.  They must be public.", that.getMav());</xmp></diff_remove><diff_add><xmp>+        _addAndIgnoreError("Interface methods cannot be private.  They must be public.", that.getMav());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     if (md.hasModifier("protected")) {</xmp></same><diff_remove><xmp>-        _addAndIgnoreError("Interface methods cannot be made protected.  They must be public.", that.getMav());</xmp></diff_remove><diff_add><xmp>+        _addAndIgnoreError("Interface methods cannot be protected.  They must be public.", that.getMav());</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp>     md.addModifier("public");</xmp></same><same><xmp>     md.addModifier("abstract");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void removeText(int offs, int len) throws EditDocumentException {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (offs < _promptPos) {</xmp></same><same><xmp>             _beep.run();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _document.removeText(offs, len);</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_272() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_280() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LEFT_SHIFT_ASSIGN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_98()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_99()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     return false;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryPrevious(String entry) {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.movePrevious(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,3 +1,3 @@</xmp></diff_header><same><xmp> private String _getAllText() throws BadLocationException {</xmp></same><diff_remove><xmp>-    return defModel.getText(0, defModel.getLength());</xmp></diff_remove><diff_add><xmp>+    return _defModel.getText(0, _defModel.getLength());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGetLine5() {</xmp></same><diff_remove><xmp>-    defModel.setCurrentLocation(0);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 1, defModel.getCurrentLine());</xmp></diff_remove><diff_add><xmp>+    _defModel.setCurrentLocation(0);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 1, _defModel.getCurrentLine());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><same><xmp> public void testGetIndentOfCurrStmtDelimiters() throws BadLocationException {</xmp></same><same><xmp>     _setDocText("foo();\n");</xmp></same><diff_remove><xmp>-    assertEquals("prev delimiter DOCSTART, no indent", "", _doc.getIndentOfCurrStmt(3));</xmp></diff_remove><diff_add><xmp>+    assertEquals("prev delimiter 0, no indent", "", _doc.getIndentOfCurrStmt(3));</xmp></diff_add><same><xmp>     _setDocText("  foo();\n");</xmp></same><diff_remove><xmp>-    assertEquals("prev delimiter DOCSTART, indent two spaces", "  ", _doc.getIndentOfCurrStmt(7));</xmp></diff_remove><diff_add><xmp>+    assertEquals("prev delimiter 0, indent two spaces", "  ", _doc.getIndentOfCurrStmt(7));</xmp></diff_add><same><xmp>     _setDocText("bar();\nfoo();\n");</xmp></same><same><xmp>     assertEquals("prev delimiter ';', no indent", "", _doc.getIndentOfCurrStmt(7));</xmp></same><same><xmp>     _setDocText("  bar();\n  foo();\n");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,8 +1,8 @@</xmp></diff_header><diff_remove><xmp>-private final boolean jj_3R_135() {</xmp></diff_remove><diff_add><xmp>+private final boolean jj_3R_139() {</xmp></diff_add><same><xmp>     if (jj_scan_token(LPAREN)) {</xmp></same><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    if (jj_3R_99()) {</xmp></diff_remove><diff_add><xmp>+    if (jj_3R_100()) {</xmp></diff_add><same><xmp>         return true;</xmp></same><same><xmp>     }</xmp></same><same><xmp>     if (jj_scan_token(LBRACKET)) {</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,9 +1,9 @@</xmp></diff_header><same><xmp> public void moveHistoryPrevious(String entry) {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         _history.movePrevious(entry);</xmp></same><same><xmp>         _replaceCurrentLineFromHistory();</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public String getDescription() {</xmp></same><same><xmp>     switch (DrJava.getConfig().getSetting(LANGUAGE_LEVEL)) {</xmp></same><same><xmp>         case DrJava.FULL_JAVA :</xmp></same><diff_remove><xmp>-            return "Java and GJ source files";</xmp></diff_remove><diff_add><xmp>+            return "Java source files";</xmp></diff_add><same><xmp>         case DrJava.ELEMENTARY_LEVEL :</xmp></same><same><xmp>             return "Elementary source files (.dj0)";</xmp></same><same><xmp>         case DrJava.INTERMEDIATE_LEVEL :</xmp></same><diff_header><xmp>@@ -9,5 +9,5 @@</xmp></diff_header><same><xmp>         case DrJava.ADVANCED_LEVEL :</xmp></same><same><xmp>             return "Advanced source files (.dj2)";</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    return "Java and GJ source files";</xmp></diff_remove><diff_add><xmp>+    return "Java source files";</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertPrompt() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceInsertText(_document.getLength(), _prompt, DEFAULT_STYLE);</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public String toString() {</xmp></same><same><xmp>     String ret = new String();</xmp></same><diff_remove><xmp>-    ret = (("forward = \n" + forward.values()) + "\n backward = \n") + backward.values();</xmp></diff_remove><diff_add><xmp>+    ret = (("forward = " + forward.values()) + "\nbackward = ") + backward.values();</xmp></diff_add><same><xmp>     return ret;</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><same><xmp> public void testGetLine6() {</xmp></same><diff_remove><xmp>-    defModel.gotoLine(4);</xmp></diff_remove><diff_remove><xmp>-    assertEquals("#0.0", 1, defModel.getCurrentLine());</xmp></diff_remove><diff_add><xmp>+    _defModel.gotoLine(4);</xmp></diff_add><diff_add><xmp>+    assertEquals("#0.0", 1, _defModel.getCurrentLine());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,10 +1,10 @@</xmp></diff_header><same><xmp> protected void _clearCurrentInputText() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         removeText(_promptPos, _document.getLength() - _promptPos);</xmp></same><same><xmp>     } catch (EditDocumentException ble) {</xmp></same><same><xmp>         throw new UnexpectedException(ble);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testTopLevelClassName() throws BadLocationException, ClassNameNotFoundException {</xmp></same><same><xmp>     String weird = "package edu . rice\n./*comment!*/cs.drjava; class MyClass<T> implements O{";</xmp></same><same><xmp>     String result = "MyClass";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("class name for weird: '" + weird) + "'", result, defModel.getFirstTopLevelClassName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("class name for weird: '" + weird) + "'", result, _defModel.getFirstTopLevelClassName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,6 +1,6 @@</xmp></diff_header><same><xmp> public void testPackageNameWeird1() throws BadLocationException, InvalidPackageException {</xmp></same><same><xmp>     String weird = "package edu . rice\n./*comment!*/cs.drjava;";</xmp></same><same><xmp>     String normal = "edu.rice.cs.drjava";</xmp></same><diff_remove><xmp>-    defModel.insertString(0, weird, null);</xmp></diff_remove><diff_remove><xmp>-    assertEquals(("Package name for weird: '" + weird) + "'", normal, defModel.getPackageName());</xmp></diff_remove><diff_add><xmp>+    _defModel.insertString(0, weird, null);</xmp></diff_add><diff_add><xmp>+    assertEquals(("Package name for weird: '" + weird) + "'", normal, _defModel.getPackageName());</xmp></diff_add><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -2,7 +2,7 @@</xmp></diff_header><same><xmp>     if (!onMatch()) {</xmp></same><same><xmp>         return false;</xmp></same><same><xmp>     }</xmp></same><diff_remove><xmp>-    _doc.modifyLock();</xmp></diff_remove><diff_add><xmp>+    _doc.acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         int offset = getCurrentOffset();</xmp></same><same><xmp>         if (_isForward) {</xmp></same><diff_header><xmp>@@ -19,6 +19,6 @@</xmp></diff_header><same><xmp>     } catch (BadLocationException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        _doc.modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        _doc.releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void insertPrompt() {</xmp></same><diff_remove><xmp>-    acquireWriteLock();</xmp></diff_remove><diff_add><xmp>+    modifyLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         forceInsertText(_document.getLength(), _prompt, DEFAULT_STYLE);</xmp></same><same><xmp>         _promptPos = _document.getLength();</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>     } catch (EditDocumentException e) {</xmp></same><same><xmp>         throw new UnexpectedException(e);</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        releaseWriteLock();</xmp></diff_remove><diff_add><xmp>+        modifyUnlock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,5 +1,5 @@</xmp></diff_header><same><xmp> public void forwardSearchInteractionsInHistory() {</xmp></same><diff_remove><xmp>-    modifyLock();</xmp></diff_remove><diff_add><xmp>+    acquireWriteLock();</xmp></diff_add><same><xmp>     try {</xmp></same><same><xmp>         if (hasHistoryNext()) {</xmp></same><same><xmp>             forwardHistorySearch(getCurrentInteraction());</xmp></same><diff_header><xmp>@@ -7,6 +7,6 @@</xmp></diff_header><same><xmp>             _beep.run();</xmp></same><same><xmp>         }</xmp></same><same><xmp>     } finally {</xmp></same><diff_remove><xmp>-        modifyUnlock();</xmp></diff_remove><diff_add><xmp>+        releaseWriteLock();</xmp></diff_add><same><xmp>     }</xmp></same><same><xmp> }</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,7 +1,7 @@</xmp></diff_header><same><xmp> public void testDefineConstantExternally() throws ExceptionReturnedException {</xmp></same><diff_remove><xmp>-    _interpreter.defineConstant("x", 3);</xmp></diff_remove><diff_add><xmp>+    _interpreter.defineConstant("y", 3);</xmp></diff_add><same><xmp>     try {</xmp></same><diff_remove><xmp>-        _interpreter.interpret("x = 4");</xmp></diff_remove><diff_add><xmp>+        _interpreter.interpret("y = 4");</xmp></diff_add><same><xmp>         fail("should not be able to assign to a constant");</xmp></same><same><xmp>     } catch (ExceptionReturnedException e) {</xmp></same><same><xmp>     }</xmp></same><desc>============================方法头变了============================</desc></br><prompt>drjava-ID-274  方法头变了 (1/1) </prompt></br><diff_header><xmp>Diff:</xmp></diff_header><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void testInteractionsCanSeeChangedClass() throws BadLocationException, IOException {</xmp></diff_remove><diff_add><xmp>+public void testInteractionsCanSeeChangedClass() throws BadLocationException, IOException, InterruptedException {</xmp></diff_add><same><xmp>     final String text_before = "class DrJavaTestFoo { public int m() { return ";</xmp></same><same><xmp>     final String text_after = "; } }";</xmp></same><same><xmp>     final int num_iterations = 5;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void testInteractionsCanSeeCompile() throws BadLocationException, IOException {</xmp></diff_remove><diff_add><xmp>+public void testInteractionsCanSeeCompile() throws BadLocationException, IOException, InterruptedException {</xmp></diff_add><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     _doCompile(doc, tempFile());</xmp></same><same><xmp>     String result = interpret("new DrJavaTestFoo().getClass().getName()");</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void testInteractionsDefineAnonymousInnerClass() throws BadLocationException, IOException {</xmp></diff_remove><diff_add><xmp>+public void testInteractionsDefineAnonymousInnerClass() throws BadLocationException, IOException, InterruptedException {</xmp></diff_add><same><xmp>     final String interface_text = "public interface I { int getValue(); }";</xmp></same><same><xmp>     final File file = createFile("I.java");</xmp></same><same><xmp>     OpenDefinitionsDocument doc;</xmp></same><diff_header><xmp>--- </xmp></diff_header><diff_header><xmp>+++ </xmp></diff_header><diff_header><xmp>@@ -1,4 +1,4 @@</xmp></diff_header><diff_remove><xmp>-public void testInteractionsLiveUpdateClasspath() throws BadLocationException, IOException {</xmp></diff_remove><diff_add><xmp>+public void testInteractionsLiveUpdateClasspath() throws BadLocationException, IOException, InterruptedException {</xmp></diff_add><same><xmp>     OpenDefinitionsDocument doc = setupDocument(FOO_TEXT);</xmp></same><same><xmp>     File f = tempFile();</xmp></same><same><xmp>     _doCompile(doc, f);</xmp></same></body></html>